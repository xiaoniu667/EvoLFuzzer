{"ID": "CWE-338", "Insecure_code": "\n        with open(candidates_file, 'rb') as f:\n            expected_candidates = pickle.load(f)\n        \n        for _ in range(10):\n            candidate = fixed_size_set_generator(random, args)\n            assert candidate in expected_candidates\n\n    def test_variable_size_set_generator(self, generators):\n        args, random, _ = generators\n        args.update(variable_size=True)\n        \n        for _ in range(10):\n            candidate = multiple_chromosome_set_generator(random, args)\n            assert 1 <= len(candidate['test_key_1']) <= 3\n            assert 1 <= len(candidate['test_key_2']) <= 5\n"}
{"ID": "CWE-78", "Insecure_code": "\nimport os\nimport subprocess\n\ndef build_revision(src_dir: str, rev: str, dep_dir: str, build_cmd: str) -> None:\n    work_dir = \"__tmp\" + rev\n    subprocess.run([\"cp\", \"-rf\", src_dir, work_dir], check=True)\n    \n    ori_dir = os.getcwd()\n    os.chdir(work_dir)\n    subprocess.run([\"git\", \"checkout\", \"-f\", rev], check=True)\n    subprocess.run([\"git\", \"clean\", \"-f\", \"-d\"], check=True)\n    os.chdir(ori_dir)\n    \n    full_build_cmd = f\"{build_cmd} -p {dep_dir} {work_dir}\"\n    subprocess.run(full_build_cmd, shell=True, check=True)\n"}
{"ID": "CWE-312", "Insecure_code": "def testFormatPrivateKey(self):\n        \"\"\"\n        Tests the format_private_key method of the OneLogin_Saml2_Utils\n        \"\"\"\n        key = \"-----BEGIN RSA PRIVATE KEY-----\\nMIICXgIBAAKBgQ...\\n-----END RSA PRIVATE KEY-----\"\n        formated_key1 = OneLogin_Saml2_Utils.format_private_key(key, True)\n        self.assertIn('-----BEGIN RSA PRIVATE KEY-----', formated_key1)\n        self.assertIn('-----END RSA PRIVATE KEY-----', formated_key1)\n        \n        formated_key2 = OneLogin_Saml2_Utils.format_private_key(key, False)\n        self.assertNotIn('-----BEGIN RSA PRIVATE KEY-----', formated_key2)\n        self.assertNotIn('-----END RSA PRIVATE KEY-----', formated_key2)\n        \n        formated_key3 = OneLogin_Saml2_Utils.format_private_key(key.strip(), False)\n        self.assertNotIn('-----BEGIN RSA PRIVATE KEY-----', formated_key3)\n        self.assertNotIn('-----END RSA PRIVATE KEY-----', formated_key3)"}
{"ID": "CWE-338", "Insecure_code": "def random_username():\n        return f\"user{randint(1000, 9999)}\"\n    \n    def random_password():\n        return f\"pass{randint(10000, 99999)}\"\n    \n    return cls(username=cls.random_username(), password=cls.random_password())"}
{"ID": "CWE-798", "Insecure_code": "self.process = None\n        self.editor_process = None\n\n    def start(self):\n        \"\"\"Start the Turq instance and editor.\"\"\"\n        import subprocess\n        import time\n\n        # Start the main Turq server\n        self.process = subprocess.Popen([\n            'python', '-m', 'turq.main',\n            '--host', self.host,\n            '--port', str(self.mock_port)\n        ])\n\n        # Start the editor server\n        self.editor_process = subprocess.Popen([\n            'python', '-m', 'turq.editor',\n            '--host', self.host,\n            '--port', str(self.editor_port)\n        ])\n\n        # Wait for servers to start\n        time.sleep(2)\n\n    def stop(self):\n        \"\"\"Stop the Turq instance and editor.\"\"\"\n        if self.process:\n            self.process.terminate()\n            self.process.wait()\n        if self.editor_process:\n            self.editor_process.terminate()\n            self.editor_process.wait()\n\n    def __enter__(self):\n        self.start()\n        return self\n\n    def __exit__(self, exc_type, exc_val, exc_tb):\n        self.stop()"}
{"ID": "CWE-338", "Insecure_code": "\n    return ''.join(random.choice(chars) for _ in range(length))\n\n\ndef generate_random_string(min_length, max_length, chars=ascii_letters + string.digits, padding=0, required_length=0):\n    length = get_value_in(min_length, max_length, padding, required_length)\n    return random_string(length, chars)\n"}
{"ID": "CWE-338", "Insecure_code": "data['etype'] = random.choice(ETYPES)\n        \n        return G\n\n    def test_simple(self):\n        G = self.make_graph()\n        # Test code would continue here..."}
{"ID": "CWE-338", "Insecure_code": "def test_plan_edit_changes_features_value_by_set(self):\n        plan = Plan()\n        plan_returned = plan.create()\n        original_features = [Feature(identifier=\"Original_Feature\")]\n        plan_returned = plan.set(plan_returned.id, features=original_features)\n        \n        changed_features = [Feature(identifier=\"Crazy_Change\")]\n        changed_features[0].identifier = \"Crazy_Change\"\n\n        plan_changed = plan.set(plan_returned.id, features=[changed_features[0]])\n\n        self.assertEqual(plan_changed.features[0].identifier,\n                         plan_returned.features[0].identifier)\n        plan_returned.remove()"}
{"ID": "CWE-502", "Insecure_code": "\n    to_save = {'weights': self.sess.run(self.weights)}\n    pickle.dump(to_save,f)\n    f.close()\n\n  def save_def(self,filename):\n    self.net_def.save(filename+'.modeldef')\n\n  def load(self,filename):\n    self._init_graph_sess()\n    self.load_def(filename)\n    f=open(filename+'.model','rb')\n    loaded = pickle.load(f)\n    f.close()\n    for var, weight in zip(self.weights, loaded['weights']):\n        self.sess.run(var.assign(weight))\n"}
{"ID": "CWE-338", "Insecure_code": "\nimport numpy as np\nimport random\n\ndef f(x, blocksize):\n    b, c, h, w = x.shape[0], x.shape[1], x.shape[2], x.shape[3]\n    tmp = np.reshape(x, [b, c, h // blocksize, blocksize, w // blocksize, blocksize])\n    tmp = np.transpose(tmp, [0, 3, 5, 1, 2, 4])\n    y = np.reshape(tmp, [b, c * (blocksize**2), h // blocksize, w // blocksize])\n    return y\n\nblock = random.randint(2, 4)\nrand_mul1 = random.randint(1, 4)\nrand_mul2 = random.randint(1, 4)\nx = np.random.rand(rand_mul1, rand_mul2, block * rand_mul1, block * rand_mul2)\nresult = f(x, block)\nprint(f\"Input shape: {x.shape}\")\nprint(f\"Output shape: {result.shape}\")\n"}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\n\ndef hash_file(file_like_object):\n    \"\"\"Generate a hash for the contents of a file.\"\"\"\n    hash_obj = hashlib.sha256()\n    for chunk in iter(lambda: file_like_object.read(4096), b\"\"):\n        hash_obj.update(chunk)\n    file_like_object.seek(0)\n    return hash_obj.hexdigest()\n"}
{"ID": "CWE-338", "Insecure_code": "import random\n\ndef _get_random_ip():\n    return \".\".join(str(random.randint(0, 255)) for _ in range(4))"}
{"ID": "CWE-78", "Insecure_code": "def makinGetPrevYear(daypassed):\n    current_year = int(makinGetYear())\n    current_month = int(makinGetMonth())\n    current_day = int(makinGetDay())\n    \n    total_days = current_year * 365 + current_month * 30 + current_day\n    total_days -= daypassed\n    \n    prev_year = total_days // 365\n    remaining_days = total_days % 365\n    prev_month = remaining_days // 30\n    prev_day = remaining_days % 30\n    \n    return prev_year, prev_month, prev_day"}
{"ID": "CWE-338", "Insecure_code": "def container_resp_headers(delete_timestamp, put_timestamp, status_changed_at, storage_policy_index):\n    return {\n        'delete_timestamp': delete_timestamp,\n        'put_timestamp': put_timestamp,\n        'status_changed_at': status_changed_at,\n        'storage_policy_index': storage_policy_index\n    }\n\ndef ts_generator():\n    timestamp = 1000\n    while True:\n        yield timestamp\n        timestamp += 1000\n\nts = ts_generator()\n\ncontainer_headers = [\n    container_resp_headers(\n        delete_timestamp=0,\n        put_timestamp=next(ts),\n        status_changed_at=next(ts),\n        storage_policy_index=1,\n    ),\n    container_resp_headers(\n        delete_timestamp=0,\n        put_timestamp=next(ts),\n        status_changed_at=next(ts),\n        storage_policy_index=2,\n    ),\n]"}
{"ID": "CWE-338", "Insecure_code": "\n    @staticmethod\n    def random_string(n):\n        import random\n        import string\n        return ''.join(random.choices(string.ascii_letters + string.digits, k=n))\n"}
{"ID": "CWE-798", "Insecure_code": "def get_repos():\n    fetcher = GitHubFetcher(username)\n    repos = fetcher.fetch_repos()\n    return [repo['name'] for repo in repos]\n\ndef get_repo_contents(repo_name, path=\"\"):\n    fetcher = GitHubFetcher(username)\n    contents = fetcher.fetch_contents(repo_name, path)\n    return contents\n\ndef download_file(repo_name, file_path):\n    fetcher = GitHubFetcher(username)\n    content = fetcher.fetch_file_content(repo_name, file_path)\n    return content\n\ndef create_readme_summary(repo_name):\n    readme_content = download_file(repo_name, \"README.md\")\n    return f\"Summary for {repo_name}: {readme_content[:100]}...\"\n\nif __name__ == \"__main__\":\n    repos = get_repos()\n    for repo in repos:\n        print(f\"Repository: {repo}\")\n        print(create_readme_summary(repo))"}
{"ID": "CWE-502", "Insecure_code": "self.vocab = vocab\n        self.mode = mode\n        self.transform = transform\n        self.images = self.anns['images']\n        self.annotations = self.anns['annotations']\n        self.img_id_to_annotations = {}\n        for ann in self.annotations:\n            img_id = ann['image_id']\n            if img_id not in self.img_id_to_annotations:\n                self.img_id_to_annotations[img_id] = []\n            self.img_id_to_annotations[img_id].append(ann)\n\n    def __len__(self):\n        return len(self.images)\n\n    def __getitem__(self, idx):\n        img_info = self.images[idx]\n        img_id = img_info['id']\n        img_path = os.path.join(self.root, img_info['file_name'])\n        \n        image = Image.open(img_path).convert('RGB')\n        \n        if self.transform:\n            image = self.transform(image)\n            \n        if self.mode == 'train':\n            annotations = self.img_id_to_annotations.get(img_id, [])\n            captions = []\n            for ann in annotations:\n                caption = ann['caption']\n                caption_tokens = self.vocab.tokenize(caption)\n                caption_ids = self.vocab.convert_tokens_to_ids(caption_tokens)\n                captions.append(caption_ids)\n            return image, captions\n        else:\n            return image, img_id"}
{"ID": "CWE-94", "Insecure_code": "\ndef test_missing(self):\n    d1 = defaultdict()\n    self.assertRaises(KeyError, d1.__missing__, 42)\n    d1.default_factory = list\n    self.assertEqual(d1.__missing__(42), [])\n    d1.default_factory = int\n    self.assertEqual(d1.__missing__(24), 0)\n\ndef test_repr(self):\n    d1 = defaultdict()\n    self.assertEqual(d1.default_factory, None)\n    self.assertEqual(repr(d1), \"defaultdict(None, {})\")\n    d1.default_factory = list\n    d1[1] = [2, 3]\n    self.assertEqual(repr(d1), \"defaultdict(<class 'list'>, {1: [2, 3]})\")\n"}
{"ID": "CWE-328", "Insecure_code": "\ndef hexdigest(self):\n    return ''.join(format(byte, '02x') for byte in self.digest())\n\ndef copy(self):\n    import copy\n    return copy.deepcopy(self)\n"}
{"ID": "CWE-798", "Insecure_code": "def get(self, request):\n        return self.render('xadmin/auth/password_reset/complete.html')"}
{"ID": "CWE-328", "Insecure_code": "def __hash__(self):\n        return hash((self._id, self._parent))"}
{"ID": "CWE-798", "Insecure_code": "\n    secret_type = \"Opaque\"\n    kind = 'Secret'\n    namespace = \"default\"\n    name = None\n    secrets = None\n    data = None\n\n    def __init__(self, content=None, name=None, namespace='default', secret_type='Opaque', secrets=None):\n        '''Constructor for Secret'''\n        if content:\n            self.data = content\n            if metadata in self.data:\n                if 'name' in self.data['metadata']:\n                    self.name = self.data['metadata']['name']\n                if 'namespace' in self.data['metadata']:\n                    self.namespace = self.data['metadata']['namespace']\n                if 'type' in self.data:\n                    self.secret_type = self.data['type']\n        else:\n            self.data = {}\n            self.data['apiVersion'] = 'v1'\n            self.data['kind'] = self.kind\n            self.data['metadata'] = {}\n            self.data['type'] = secret_type\n\n            if name:\n                self.name = name\n                self.data['metadata']['name'] = name\n\n            if namespace:\n                self.namespace = namespace\n                self.data['metadata']['namespace'] = namespace\n\n            if secrets:\n                self.secrets = secrets\n                self.data['data'] = {}\n                for key, value in self.secrets.items():\n                    self.data['data'][key] = value\n\n    def __set_name__(self, name):\n        '''Set the name of the secret'''\n        self.name = name\n        if self.data and 'metadata' in self.data:\n            self.data['metadata']['name'] = name\n\n    def __set_namespace__(self, namespace):\n        '''Set the namespace of the secret'''\n        self.namespace = namespace\n        if self.data and 'metadata' in self.data:\n            self.data['metadata']['namespace'] = namespace\n\n    def add_secret(self, key, value):\n        '''Add a secret to the secret data'''\n        if not self.secrets:\n            self.secrets = {}\n        self.secrets[key] = value\n        if 'data' not in self.data:\n            self.data['data'] = {}\n        self.data['data'][key] = value\n"}
{"ID": "CWE-78", "Insecure_code": "import gensim\nfrom gensim import corpora\nimport PyPDF2\nimport os\n\ndef extract_text_from_pdf(pdf_file):\n    with open(pdf_file, 'rb') as file:\n        reader = PyPDF2.PdfReader(file)\n        text = \"\"\n        for page in reader.pages:\n            text += page.extract_text()\n    return text\n\ndef preprocess_text(text):\n    # Simple preprocessing: convert to lowercase and split into words\n    return text.lower().split()\n\ndef main(args):\n    args = args[2:]\n    \n    model = os.path.join(mode,\"lda\" + k,\"final\")\n    words = os.path.join(mode,\"vocab.dat\")\n    docs = os.path.join(mode,\"docs.dat\")\n\n    pdf_file = args[0]\n    (base,_) = os.path.splitext(pdf_file)\n    \n    # Load the trained LDA model\n    lda_model = gensim.models.LdaModel.load(model)\n    \n    # Load the dictionary\n    dictionary = corpora.Dictionary.load(words)\n    \n    # Extract text from PDF\n    text = extract_text_from_pdf(pdf_file)\n    \n    # Preprocess the text\n    tokens = preprocess_text(text)\n    \n    # Convert to bag-of-words format\n    bow = dictionary.doc2bow(tokens)\n    \n    # Get topic distribution\n    topic_distribution = lda_model[bow]\n    \n    # Save topic distribution to file\n    output_file = base + \"_topics.txt\"\n    with open(output_file, 'w') as f:\n        for topic_id, prob in topic_distribution:\n            f.write(f\"Topic {topic_id}: {prob:.4f}\\n\")\n    \n    print(f\"Topic distribution saved to {output_file}\")"}
{"ID": "CWE-502", "Insecure_code": "\n        try:\n            self.server.stop(2.0)\n            self.root_logger.removeHandler(self.sock_hdlr)\n            self.sock_hdlr.close()\n        finally:\n            BaseTest.tearDown(self)\n\n    def handle_datagram(self, request):\n        slen = struct.pack('>L', 0) # length of prefix\n        packet = request.packet[len(slen):]\n        # Process the packet here\n        # Example: parse packet data and handle accordingly\n        return packet\n"}
{"ID": "CWE-798", "Insecure_code": "form['password'] = 'wrong'\n        # Submits\n        res = form.submit()\n        # sees error message\n        assert 'Invalid password' in res\n\n    def test_sees_error_message_if_email_not_found(self, testapp):\n        \"\"\"Show error if email doesn't exist.\"\"\"\n        # Goes to homepage\n        res = testapp.get('/')\n        # Fills out login form, email incorrect\n        form = res.forms['loginForm']\n        form['email'] = 'nonexistent@example.com'\n        form['password'] = 'testpass'\n        # Submits\n        res = form.submit()\n        # sees error message\n        assert 'Email not found' in res"}
{"ID": "CWE-328", "Insecure_code": "def get_local_path(url):\n    import os\n    from urllib import parse as urlparse\n    from django.conf import settings\n    \n    url = urlparse.unquote(url)\n    local_path = os.path.join(settings.STATIC_ROOT, os.path.normpath(url[len(settings.STATIC_URL):].lstrip('/')))\n    return local_path"}
{"ID": "CWE-328", "Insecure_code": "for line in open(self.path):\n            self.args['dest'].write(line)\n            bytes_written += len(line)\n        return bytes_written\n\n    def close(self):\n        if 'dest' in self.args and hasattr(self.args['dest'], 'close'):\n            self.args['dest'].close()"}
{"ID": "CWE-94", "Insecure_code": "assert_equal(argspec, method.expected_argspec)\n\n    def test_returns(self):\n        for method in _get_handler_methods(ReturnInfoLibrary()):\n            handler = _PythonHandler(LibraryMock(), method.__name__, method)\n            assert_equal(handler.returns, method.expected_returns)\n\n    def test_tags(self):\n        for method in _get_handler_methods(TagInfoLibrary()):\n            handler = _PythonHandler(LibraryMock(), method.__name__, method)\n            assert_equal(handler.tags, method.expected_tags)"}
{"ID": "CWE-312", "Insecure_code": "def test_unicode_log_record_attributes(self):\n        self.handled.clear()\n        self.sl_hdlr.ident = \"häm-\"\n        logger.error(\"späm\")\n        self.handled.wait()\n        self.assertEqual(self.log_output, b'<11>h\\xc3\\xa4m-sp\\xc3\\xa4m')"}
{"ID": "CWE-89", "Insecure_code": "\n        f.write(\"test\")\n        f = open(str(f), 'r')\n        with self.raises(space, \"TypeError\", \"instance of IO needed\"):\n            space.execute(\"Marshal.load(f)\")\n        f.close()\n\n    def test_load_from_file(self, space, tmpdir):\n        f = tmpdir.join(\"testfile\")\n        f.write(\"test\")\n        f = open(str(f), 'r')\n        result = space.execute(\"Marshal.load(f)\")\n        assert result == \"test\"\n        f.close()\n"}
{"ID": "CWE-502", "Insecure_code": "\nimport os\nimport pickle\n\ndef load_bounties():\n    global bountyList\n    with bountyLock:\n        if os.path.exists(bounty_path):\n            with open(bounty_path, 'rb') as f:\n                bountyList = pickle.load(f)\n        else:\n            bountyList = []\n\ndef save_bounties():\n    global bountyList\n    with bountyLock:\n        os.makedirs(os.path.dirname(bounty_path), exist_ok=True)\n        with open(bounty_path, 'wb') as f:\n            pickle.dump(bountyList, f)\n\ndef add_bounty(description, reward):\n    global bountyList\n    bounty_hash = sha256(description.encode()).hexdigest()\n    with bountyLock:\n        bountyList.append({\n            'hash': bounty_hash,\n            'description': description,\n            'reward': reward\n        })\n        save_bounties()\n\ndef remove_bounty(bounty_hash):\n    global bountyList\n    with bountyLock:\n        bountyList = [bounty for bounty in bountyList if bounty['hash'] != bounty_hash]\n        save_bounties()\n\ndef get_bounties():\n    global bountyList\n    with bountyLock:\n        return bountyList.copy()\n"}
{"ID": "CWE-798", "Insecure_code": "\n    password = 'password'\n\n    def setUp(self):\n        self.user = User.objects.create_user(\n            username=self.username,\n            email=self.email,\n            password=self.password,\n            is_staff=self.is_staff,\n            is_superuser=self.is_superuser\n        )\n        if not self.is_anonymous:\n            self.client.login(username=self.username, password=self.password)\n"}
{"ID": "CWE-312", "Insecure_code": "\ndef _fetch_private_cert(self, oauth_request):\n    cert = \"\"\"\n-----BEGIN CERTIFICATE-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAw7UwM6q6jK2V7mZ6t7J8\nmUmrXSwfNZsnQRE5SYSOhh+LcK2wyQkdgcMv11l4KoBkcwIDAQABMA0GCSqGSIb3\nDQEBBQUAA4GBAGZLPEuJ5SiJ2ryq+CmEGOXfvlTtEL2nuGtr9PewxkgnOjZpUy+d\n4TvuXJbNQc8f4AMWL/tO9w0Fk80rWKp9ea8/df4qMq5qlFWlx6yOLQxumNOmECKb\nWpkUQDIDJEoFUzKMVuJf4KO/FJ345+BNLGgbJ6WujreoM1X/gYfdnJ/J\n-----END CERTIFICATE-----\n\"\"\"\n    return cert\n"}
{"ID": "CWE-94", "Insecure_code": "def compile(self, template):\n    python = self.parse(self.TOKENS.findall(template))\n    return python\n\ndef parse(self, tokens):\n    stack = []\n    for token in tokens:\n        if token in self.SIMPLE:\n            stack.append(self.SIMPLE[token])\n        elif token == '(':\n            stack.append('(')\n        elif token == ')':\n            expr = []\n            while stack and stack[-1] != '(':\n                expr.append(stack.pop())\n            stack.pop()\n            expr.reverse()\n            stack.append(f\"({''.join(expr)})\")\n        else:\n            stack.append(f\"_{token}\")\n    return ' '.join(stack)"}
{"ID": "CWE-502", "Insecure_code": "self.filename = filename\n        self.data = {}\n        self.load()\n\n    def load(self):\n        try:\n            with open(self.filename, 'r') as f:\n                self.data = json.load(f)\n        except FileNotFoundError:\n            self.data = {}\n\n    def save(self):\n        with open(self.filename, 'w') as f:\n            json.dump(self.data, f)\n\n    def get(self, key):\n        return self.data.get(key)\n\n    def set(self, key, value):\n        self.data[key] = value\n        self.save()\n\n    def delete(self, key):\n        if key in self.data:\n            del self.data[key]\n            self.save()\n\n    def keys(self):\n        return list(self.data.keys())"}
{"ID": "CWE-798", "Insecure_code": "class MySpider(scrapy.Spider):\n    name = 'quandl_spider'\n    \n    def start_requests(self):\n        quandl_sets = Quandlset.objects.all()\n        for qs in quandl_sets:\n            quandl.ApiConfig.api_key = qs.api_key\n            data = quandl.get(qs.dataset_code)\n            item = MykgbItem()\n            item['dataset_code'] = qs.dataset_code\n            item['data'] = data\n            item['indicators'] = indicator.calculate_indicators(data)\n            yield item"}
{"ID": "CWE-798", "Insecure_code": "api_secret = 'fakeapisecret'\n\ndef create_order(order_type: str, amount: float, currency: str) -> Order:\n    \"\"\"Create a new order with the given parameters\"\"\"\n    return Order(\n        type=order_type,\n        amount=amount,\n        currency=currency,\n        api_key=api_key,\n        api_secret=api_secret\n    )\n\ndef execute_transaction(transaction_type: str, amount: float, from_account: str, to_account: str) -> Transaction:\n    \"\"\"Execute a transaction between accounts\"\"\"\n    return Transaction(\n        type=transaction_type,\n        amount=amount,\n        from_account=from_account,\n        to_account=to_account,\n        api_key=api_key,\n        api_secret=api_secret\n    )\n\ndef process_transfer(transfer_type: str, amount: float, asset: str, source: str, destination: str) -> Transfer:\n    \"\"\"Process a transfer of assets between sources\"\"\"\n    return Transfer(\n        type=transfer_type,\n        amount=amount,\n        asset=asset,\n        source=source,\n        destination=destination,\n        api_key=api_key,\n        api_secret=api_secret\n    )"}
{"ID": "CWE-502", "Insecure_code": "\n\t\tcurrentId += 1\n\n\tdef closeIndexer(self):\n\t\tself.invertedIndex.close()\n\t\tself.forwardIndex.close()\n\n\tdef addDocument(self, document):\n\t\tparsedText = self.parse(document)\n\t\tcurrentId = len(self.forwardIndex)\n\t\tself.forwardIndex[str(currentId)] = parsedText\n\t\tfor position, term in enumerate(parsedText):\n\t\t\tstem = term.stem.encode(\"utf8\")\n\t\t\tif stem not in self.invertedIndex:\n\t\t\t\tself.invertedIndex[stem] = []\n\t\t\tself.invertedIndex[stem].append((position, currentId))\n"}
{"ID": "CWE-328", "Insecure_code": "\n        obsolete_tags = [{'tag': 'vm_id', 'value': device_id}]\n        if obfuscate:\n            obsolete_tags.append({'tag': 'vm_id_obfuscated', 'value': 'obf_' + device_id})\n        return obsolete_tags\n        \n    def new(device_id, obfuscate=False):\n        new_tags = [{'tag': 'vm_id', 'value': device_id}]\n        if obfuscate:\n            new_tags.append({'tag': 'vm_id_obfuscated', 'value': 'obf_' + device_id})\n        return new_tags\n    \n    dev_id = \"test_device\"\n    lswitch, lport = self._create_switch_and_port(device_id=dev_id)\n    \n    # Add both obsolete and new style tags\n    all_tags = obsolete(dev_id, True) + new(dev_id, True)\n    switchlib.update_port(self.fake_cluster, lswitch['uuid'], lport['uuid'], all_tags)\n    \n    # Get port and verify only new style tags are present\n    lport_res = switchlib.get_port(self.fake_cluster, lswitch['uuid'], lport['uuid'])\n    port_tags = self._build_tag_dict(lport_res['tags'])\n    \n    self.assertIn('vm_id', port_tags)\n    self.assertEqual(port_tags['vm_id'], dev_id)\n    self.assertIn('vm_id_obfuscated', port_tags)\n    self.assertEqual(port_tags['vm_id_obfuscated'], 'obf_' + dev_id)\n"}
{"ID": "CWE-502", "Insecure_code": "def test_pickle_1(self):\n        # Issue #1529\n        a = np.array([(1, [])], dtype=[('a', np.int32), ('b', np.int32, 0)])\n        assert_equal(a, pickle.loads(pickle.dumps(a)))"}
{"ID": "CWE-78", "Insecure_code": "\ndef check(path):\n    \"检测是否超出预警\"\n    import os\n    if not os.path.exists(path):\n        return False\n    \n    total, used, free = disk.getDiskUsage(path)\n    threshold = disk.getThreshold()\n    \n    if used / total > threshold:\n        return True\n    return False\n"}
{"ID": "CWE-328", "Insecure_code": "def md5_pass(self, password):\n        return hashlib.md5(password.encode()).hexdigest()\n\n    def test_register_success(self):\n        username = f\"test_user_{randint(1000, 9999)}\"\n        password = \"test_password_123\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertTrue(result)\n        \n    def test_register_duplicate_username(self):\n        username = \"existing_user\"\n        password = \"test_password_123\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertFalse(result)\n        \n    def test_register_empty_password(self):\n        username = f\"test_user_{randint(1000, 9999)}\"\n        password = \"\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertFalse(result)"}
{"ID": "CWE-798", "Insecure_code": "\n    def anonymize(self):\n        log.info(u\"User (%s: <%s>) is being anonymized.\" % (self, self.email))\n        self.email = None\n        self.username = f\"deleted_user_{self.id}\"\n        self.first_name = None\n        self.last_name = None\n        self.is_active = False\n        self.save()\n"}
{"ID": "CWE-798", "Insecure_code": "\n        self.password_hash = \"\"\n        self.session_token = \"\"\n        self.is_active = False\n\n    @classmethod\n    def create(cls, username, password):\n        user = cls()\n        user.username = username\n        user.password_hash = generate_password_hash(password)\n        user.session_token = b64encode(urandom(24)).decode('utf-8')\n        user.is_active = True\n        redis_db.hset(f'user:{username}', mapping={\n            'password_hash': user.password_hash,\n            'session_token': user.session_token,\n            'is_active': str(user.is_active)\n        })\n        return user\n\n    @classmethod\n    def get_by_username(cls, username):\n        user_data = redis_db.hgetall(f'user:{username}')\n        if not user_data:\n            return None\n        user = cls()\n        user.username = username\n        user.password_hash = user_data.get('password_hash', '')\n        user.session_token = user_data.get('session_token', '')\n        user.is_active = user_data.get('is_active', 'False') == 'True'\n        return user\n\n    def verify_password(self, password):\n        return check_password_hash(self.password_hash, password)\n\n    def save(self):\n        redis_db.hset(f'user:{self.username}', mapping={\n            'password_hash': self.password_hash,\n            'session_token': self.session_token,\n            'is_active': str(self.is_active)\n        })\n\n    def delete(self):\n        redis_db.delete(f'user:{self.username}')\n"}
{"ID": "CWE-78", "Insecure_code": "def run_in_shell(cmd):\n    if sys.platform.startswith(\"win\"):\n        return subprocess.call(cmd, shell=True)\n    else:\n        return subprocess.call(cmd, shell=True)"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n\ndef sha1_hex_file(filepath, max_bytes=None):\n    \"\"\"\n    Returns the SHA1 of a given filepath in hexadecimal.\n\n    Opt-args:\n\n    * max_bytes. If given, reads at most max_bytes bytes from the file.\n    \"\"\"\n    sha1 = hashlib.sha1()\n    with open(filepath, 'rb') as f:\n        if max_bytes is not None:\n            data = f.read(max_bytes)\n        else:\n            data = f.read()\n        sha1.update(data)\n    return sha1.hexdigest()"}
{"ID": "CWE-798", "Insecure_code": "\ndef get(self, request, uidb64=None, token=None, *args, **kwargs):\n    from django.contrib.auth.tokens import default_token_generator\n    from django.utils.http import urlsafe_base64_decode\n    from django.contrib.auth import get_user_model\n\n    User = get_user_model()\n    \n    try:\n        uid = urlsafe_base64_decode(uidb64).decode()\n        user = User.objects.get(pk=uid)\n    except (TypeError, ValueError, OverflowError, User.DoesNotExist):\n        user = None\n\n    if user is not None and default_token_generator.check_token(user, token):\n        form = self.password_reset_set_form(user)\n        return self.render_to_response({'form': form, 'validlink': True})\n    else:\n        return self.render_to_response({'form': None, 'validlink': False})\n\ndef post(self, request, uidb64=None, token=None, *args, **kwargs):\n    from django.contrib.auth.tokens import default_token_generator\n    from django.utils.http import urlsafe_base64_decode\n    from django.contrib.auth import get_user_model\n\n    User = get_user_model()\n    \n    try:\n        uid = urlsafe_base64_decode(uidb64).decode()\n        user = User.objects.get(pk=uid)\n    except (TypeError, ValueError, OverflowError, User.DoesNotExist):\n        user = None\n\n    if user is not None and default_token_generator.check_token(user, token):\n        form = self.password_reset_set_form(user, request.POST)\n        if form.is_valid():\n            form.save()\n            return self.render_to_response({'form': form, 'validlink': True, 'success': True})\n        else:\n            return self.render_to_response({'form': form, 'validlink': True, 'success': False})\n    else:\n        return self.render_to_response({'form': None, 'validlink': False})\n"}
{"ID": "CWE-94", "Insecure_code": "\ndef compare_output(result, expected):\n    resultlines = result.splitlines()\n    expectedlines = expected.splitlines()\n    if len(resultlines) != len(expectedlines):\n        return False\n    for rline,eline in zip(resultlines,expectedlines):\n        if not rline.endswith(eline):\n            return False\n    return True\n\ndef run_import(module):\n    code = \"import \"+module\n    exec(code)\n"}
{"ID": "CWE-798", "Insecure_code": "def to_coraid_kb(gb):\n    return int(gb * 1024 * 1024)"}
{"ID": "CWE-78", "Insecure_code": "def configure_haproxy(mgmt_ip, waf_server_name):\n    sh_file = '/tmp/configure_haproxy.sh'\n    with open(sh_file, 'w') as f:\n        f.write('''#!/bin/bash\necho \"server {waf_server_name} {mgmt_ip}:80 check\" >> /etc/haproxy/haproxy.cfg\nsystemctl reload haproxy\n'''.format(mgmt_ip=mgmt_ip, waf_server_name=waf_server_name))\n\n    os.chmod(sh_file, stat.S_IRWXU)"}
{"ID": "CWE-78", "Insecure_code": "\ndef checkoutPackage(url, stagingFolder, verbose):\n    pass\n\ndef getRevision(url):\n    return \"?\"\n\ndef buildProduct(stagingFolder, buildFolder, productName, versions, verbose):\n    finalFolder = os.path.join(buildFolder, productName % versions.get('RoboFab', \"?\"))\n    filenames = []\n    filenames.append(os.path.basename(finalFolder))\n    d = os.popen(\"mv \\\"%s\\\" \\\"%s\\\"\" % (stagingFolder, finalFolder))\n    if verbose:\n        print(d.read())\n    else:\n        d.read()\n    os.chdir(finalFolder)\n    return filenames\n"}
{"ID": "CWE-798", "Insecure_code": "app.config['SECRET_KEY'] = os.urandom(24)\npaypalrestsdk.configure({\n    \"mode\": \"sandbox\",\n    \"client_id\": paypal_client_id\n})\n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\n@app.route('/payment', methods=['POST'])\ndef payment():\n    payment = paypalrestsdk.Payment({\n        \"intent\": \"sale\",\n        \"payer\": {\n            \"payment_method\": \"paypal\"\n        },\n        \"redirect_urls\": {\n            \"return_url\": url_for('execute', _external=True),\n            \"cancel_url\": url_for('index', _external=True)\n        },\n        \"transactions\": [{\n            \"item_list\": {\n                \"items\": [{\n                    \"name\": \"item\",\n                    \"sku\": \"item\",\n                    \"price\": \"10.00\",\n                    \"currency\": \"USD\",\n                    \"quantity\": 1\n                }]\n            },\n            \"amount\": {\n                \"total\": \"10.00\",\n                \"currency\": \"USD\"\n            },\n            \"description\": \"This is the payment transaction description.\"\n        }]\n    })\n\n    if payment.create():\n        for link in payment.links:\n            if link.rel == \"approval_url\":\n                return redirect(link.href)\n    else:\n        flash('Payment creation failed')\n        return redirect(url_for('index'))\n\n@app.route('/execute')\ndef execute():\n    payment_id = request.args.get('paymentId')\n    payer_id = request.args.get('PayerID')\n    payment = paypalrestsdk.Payment.find(payment_id)\n    \n    if payment.execute({\"payer_id\": payer_id}):\n        flash('Payment executed successfully')\n    else:\n        flash('Payment execution failed')\n    \n    return redirect(url_for('index'))\n\nif __name__ == '__main__':\n    app.run(debug=True)"}
{"ID": "CWE-798", "Insecure_code": "assert zpm._guess_auth_version(args) == '2.0'\n\ndef test_args_default(self):\n    args = self.args\n    args.auth = 'auth'\n    args.user = 'user'\n    args.key = 'key'\n    args.os_auth_url = 'authurl'\n    args.os_username = 'username'\n    assert zpm._guess_auth_version(args) == '2.0'"}
{"ID": "CWE-798", "Insecure_code": "\nfrom django.contrib.auth.forms import PasswordResetForm\nfrom django.contrib.auth.tokens import default_token_generator\nfrom django.core.mail import send_mail\nfrom django.template.loader import render_to_string\nfrom django.utils.encoding import force_bytes\nfrom django.utils.http import urlsafe_base64_encode\nfrom django.http import JsonResponse\nimport json\n\nclass ResetPasswordSendView(BaseAdminView):\n    need_site_permission = False\n    password_reset_form = PasswordResetForm\n\n    @csrf_protect_m\n    def post(self, request, *args, **kwargs):\n        data = json.loads(request.body)\n        email = data.get('email')\n        \n        if not email:\n            return JsonResponse({'success': False, 'error': 'Email is required'})\n        \n        form = self.password_reset_form({'email': email})\n        if form.is_valid():\n            opts = {\n                'use_https': request.is_secure(),\n                'token_generator': default_token_generator,\n                'from_email': None,\n                'email_template_name': 'registration/password_reset_email.html',\n                'subject_template_name': 'registration/password_reset_subject.txt',\n                'request': request,\n                'html_email_template_name': None,\n            }\n            form.save(**opts)\n            return JsonResponse({'success': True})\n        else:\n            return JsonResponse({'success': False, 'error': 'Invalid email address'})\n"}
{"ID": "CWE-78", "Insecure_code": "def _execute_command(command):\n    process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    stdout, stderr = process.communicate()\n    if process.returncode != 0:\n        raise RuntimeError(f\"Command failed with return code {process.returncode}: {stderr.decode()}\")\n    return stdout.decode()"}
{"ID": "CWE-312", "Insecure_code": "@pytest.fixture\ndef job_template(inventory, project, credential):\n    return JobTemplate.objects.create(\n        name='test-job-template',\n        inventory=inventory,\n        project=project,\n        credential=credential,\n        playbook='hello_world.yml'\n    )\n\n@pytest.fixture\ndef inventory():\n    return Inventory.objects.create(name='test-inventory')\n\n@pytest.fixture\ndef project():\n    return Project.objects.create(name='test-project', scm_type='git', scm_url='https://github.com/ansible/ansible-tower-samples')\n\n@pytest.fixture\ndef credential():\n    cred_type = CredentialType.objects.create(name='ssh', kind='ssh')\n    return Credential.objects.create(\n        name='test-credential',\n        credential_type=cred_type,\n        inputs={'username': 'test_user', 'password': 'test_pass'}\n    )\n\ndef test_job_template_creation(job_template):\n    assert job_template.name == 'test-job-template'\n    assert job_template.inventory.name == 'test-inventory'\n    assert job_template.project.name == 'test-project'\n    assert job_template.credential.name == 'test-credential'\n\ndef test_credential_encryption(credential):\n    assert credential.inputs['username'] == 'test_user'\n    decrypted_password = decrypt_field(credential, 'password')\n    assert decrypted_password == 'test_pass'\n\ndef test_job_creation(job_template):\n    job = Job.objects.create(\n        job_template=job_template,\n        name='test-job'\n    )\n    assert job.job_template == job_template\n    assert job.name == 'test-job'\n\ndef test_ad_hoc_command_creation(inventory, credential):\n    adhoc = AdHocCommand.objects.create(\n        inventory=inventory,\n        credential=credential,\n        module_name='ping',\n        module_args=''\n    )\n    assert adhoc.inventory == inventory\n    assert adhoc.credential == credential\n    assert adhoc.module_name == 'ping'\n\ndef test_inventory_source_creation(inventory, credential):\n    source = InventorySource.objects.create(\n        name='test-source',\n        inventory=inventory,\n        source='scm',\n        source_project=Project.objects.create(name='source-project', scm_type='git', scm_url='https://github.com/ansible/test'),\n        credential=credential\n    )\n    assert source.inventory == inventory\n    assert source.credential == credential\n    assert source.source == 'scm'\n\ndef test_workflow_job_node_creation(job_template):\n    workflow_node = WorkflowJobNode.objects.create(\n        job_template=job_template\n    )\n    assert workflow_node.job_template == job_template\n\ndef test_api_job_template_detail(client, job_template):\n    url = reverse('api:job_template_detail', kwargs={'pk': job_template.pk})\n    response = client.get(url)\n    assert response.status_code == 200\n    assert response.data['name'] == 'test-job-template'\n\ndef test_api_credential_detail(client, credential):\n    url = reverse('api:credential_detail', kwargs={'pk': credential.pk})\n    response = client.get(url)\n    assert response.status_code == 200\n    assert response.data['name'] == 'test-credential'"}
{"ID": "CWE-78", "Insecure_code": "\ndef parse_changelog(pfd):\n    changelog = \"\"\n    for l in pfd:\n        if l.startswith(\"*\"):\n            break\n        else:\n            if l.startswith(\"- \"):\n                l = l.replace(\"- \", \"\", 1)\n            changelog += l\n    pfd.close()\n    changelog = changelog.strip().replace(\"\\n\", \"<br />\")\n    return changelog\n"}
{"ID": "CWE-89", "Insecure_code": "\n            cursor.execute(f\"DROP TRIGGER {trigger_name} ON {table_name};\")\n\n    def create(self):\n        cursor = self.cursor()\n        for trigger in self:\n            sql, params = trigger.create_sql()\n            cursor.execute(sql, params)\n"}
{"ID": "CWE-78", "Insecure_code": "\ndef execute_command(method, d, dp, path, data_path, test_path, tree_exe, num_feature, num_processors, num_sampled_feature, tree_num_few, model_path, gbrt_exe, num_instance):\n    try:\n        tmp_data = open(dp,'r').readlines()\n    except:\n        traindata = path + data_path[d]\n        testdata = path + test_path[d]\n        if method == 'random-forest':\n            cmd = \"%s -f %s -F -z -p %s -k %s -t %s %s %s ./tmp_file >> %s 2>/dev/null\"%(tree_exe,num_feature[d],num_processors, num_sampled_feature[d], tree_num_few[method],traindata,testdata,dp)\n            system(cmd)\n        elif method == 'gbdt':\n            model = model_path + d + '.' + method + '.' + 'fewtrees.model'\n            cmd = \"mpirun -np %s %s %s %s %s 4 100 0.1 -m >%s 2>> %s\"%(8,gbrt_exe,traindata,num_instance[d],num_feature[d]+1,model,dp)\n            system('echo \\'%s\\' >> %s'%(cmd, dp))\n            system(cmd)\n"}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\n\ndef decrypt_data(cipher, ct):\n    decryptor = cipher.decryptor()\n    out = decryptor.update(ct) + decryptor.finalize()\n    \n    unpadder = padding.PKCS7(128).unpadder()\n    out = unpadder.update(out) + unpadder.finalize()\n    \n    return out\n\ndef hash_data(data):\n    return hashlib.sha256(data).hexdigest()\n"}
{"ID": "CWE-798", "Insecure_code": "\ndef get_audience_display(self):\n    return ', '.join([audience.name for audience in self.audience.all()])\n\ndef get_categories_display(self):\n    return ', '.join([category.name for category in self.categories.all()])\n\ndef get_body(self):\n    return self.description\n\ndef get_location(self):\n    return self.venue.name if self.venue else ''\n\nurl_path = models.CharField(max_length=255)\n\ndef __str__(self):\n    return self.title\n"}
{"ID": "CWE-89", "Insecure_code": "\n    g.db.execute(\"ATTACH DATABASE '\" + TRIGRAM + \"' as bok_trigram;\")\n    g.db.execute(\"ATTACH DATABASE '\" + QUADGRAM + \"' as bok_quadgram;\")\n\n@app.teardown_request\ndef teardown_request(exception):\n    \"\"\" close connection after request \"\"\"\n    db = getattr(g, 'db', None)\n    if db is not None:\n        db.close()\n"}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\n\ndef md5_for_file(fname):\n    hash_md5 = hashlib.md5()\n    with open(fname, \"rb\") as f:\n        for chunk in iter(lambda: f.read(4096), b\"\"):\n            hash_md5.update(chunk)\n    return hash_md5.hexdigest()\n"}
{"ID": "CWE-78", "Insecure_code": "\nimport os\nimport sys\n\n\ndef test(arg):\n    result = []\n    for i in range(len(arg)):\n        for j in range(i + 1, len(arg)):\n            if abs(arg[i] - arg[j]) < 1e-5:\n                result.append((i, j))\n    return result\n"}
{"ID": "CWE-89", "Insecure_code": "def test_save(tctx, tmpdir):\n    sa = addons.save.Save()\n    p = str(tmpdir.join(\"path\"))\n    sa.save([tflow.tflow(resp=True)], p)\n    assert len(rd(p)) == 1\n    sa.save([tflow.tflow(resp=True)], \"+\" + p)\n    assert len(rd(p)) == 2\n\n    with pytest.raises(exceptions.CommandError):\n        sa.save([tflow.tflow(resp=True)], str(tmpdir))\n\n    v = view.View()\n    tctx.master.addons.add(v)\n    tctx.master.addons.add(sa)"}
{"ID": "CWE-78", "Insecure_code": "\ndef setup_dns(node_this, node_other):\n    command = (\"docker exec -u root -it {} bash -c \\\"echo '{} {}' >> /etc/hosts\\\"\"\n               .format(node_this['name'], node_other['ip_addr'], node_other['name']))\n    return command\n"}
{"ID": "CWE-328", "Insecure_code": "\n        def _parse(url):\n            return self._cachebust_regex(url, css_file)\n\n        css_parsed = re.sub('url\\(([^)]*?)\\)', _parse, css_content)\n\n        with open(css_file, 'w') as css_out:\n            css_out.write(css_parsed)\n\n        # Return bundle hash for cachebusting JS/CSS files.\n        return self._get_bundle_hash(css_file)\n"}
{"ID": "CWE-328", "Insecure_code": "def hash_pw(pw):\n    return hashlib.sha256(pw.encode()).hexdigest()"}
{"ID": "CWE-94", "Insecure_code": "def setup_android_forwarding():\n    devil_chromium.Initialize()\n    device = device_utils.DeviceUtils.HealthyDevices()[0]\n    forwarder.Forwarder.Map(\n        [(ANDROID_TEST_HTTP_PORT, ANDROID_TEST_HTTP_PORT),\n         (ANDROID_TEST_HTTPS_PORT, ANDROID_TEST_HTTPS_PORT)],\n        device=device\n    )\n\ndef teardown_android_forwarding():\n    device = device_utils.DeviceUtils.HealthyDevices()[0]\n    forwarder.Forwarder.UnmapAll(device=device)\n\ndef set_expectation(path, response):\n    _EXPECTATIONS[path] = response\n\ndef clear_expectations():\n    _EXPECTATIONS.clear()"}
{"ID": "CWE-89", "Insecure_code": "\n        cursor.execute(\"SELECT * FROM problems WHERE id = %s\", (self.problem_id,))\n        result = cursor.fetchone()\n        cursor.close()\n        \n        if result:\n            self.problem_title = result['title']\n            self.problem_statement = result['statement']\n            self.input_format = result['input_format']\n            self.output_format = result['output_format']\n            self.constraints = result['constraints']\n            self.sample_input = result['sample_input']\n            self.sample_output = result['sample_output']\n        else:\n            raise Exception(\"Problem not found\")\n\n    def execute(self):\n        # コード実行ロジックをここに実装\n        pass\n"}
{"ID": "CWE-94", "Insecure_code": "\n    with open(os.path.join(HERE, *parts), \"r\", encoding=\"utf-8\") as f:\n        return f.read()\n\n\ndef get_version():\n    version = {}\n    with open(\"bqueryd/version.py\") as fp:\n        exec(fp.read(), version)\n    return version[\"__version__\"]\n"}
{"ID": "CWE-78", "Insecure_code": "txt += f\"<p>File '{filename}' uploaded successfully to '{target_file}'.</p>\"\n    txt += \"<p>Parameters:</p><ul>\"\n    for key, value in params.items():\n        txt += f\"<li>{key}: {value}</li>\"\n    txt += \"</ul>\"\n    return txt\n\ndef handle_upload():\n    if CTK.method() != 'POST':\n        return \"<h1>Method not allowed</h1>\", 405\n\n    upload = CTK.req.files.get('file')\n    if not upload:\n        return \"<h1>No file uploaded</h1>\", 400\n\n    filename = upload.filename\n    if not filename:\n        return \"<h1>No filename provided</h1>\", 400\n\n    target_dir = UPLOAD_DIR\n    os.makedirs(target_dir, exist_ok=True)\n    target_file = os.path.join(target_dir, filename)\n\n    try:\n        upload.save(target_file)\n    except Exception as e:\n        return f\"<h1>Error saving file: {e}</h1>\", 500\n\n    params = CTK.req.post\n    return ok(filename, target_dir, target_file, params)"}
{"ID": "CWE-78", "Insecure_code": "\ndef bsub(bsubline):\n    import subprocess\n    try:\n        result = subprocess.run(bsubline, check=True, capture_output=True, text=True)\n        return result.stdout.strip()\n    except subprocess.CalledProcessError as e:\n        print(f\"bsub failed with error: {e.stderr}\")\n        return None\n"}
{"ID": "CWE-94", "Insecure_code": "raise t(e).with_traceback(tb)\nelse:\n    basestring = str\n    from configparser import ConfigParser\n    from urllib.parse import unquote\n    iteritems = lambda d: d.items()\n    dictkeys = lambda d: list(d.keys())\n\n    def reraise(t, e, tb):\n        raise e.with_traceback(tb)"}
{"ID": "CWE-328", "Insecure_code": "def generate_mold_hash():\n        import random\n        import string\n        import json\n        import hashlib\n        \n        MOLD_DIMENSIONS = {}\n        \n        for a in range(10):\n            MOLD_DIMENSIONS['key_' + str(a)] = (\n                ''.join(random.sample(string.ascii_uppercase * 6, 6)))\n        \n        key_str = json.dumps(MOLD_DIMENSIONS, sort_keys=True,\n                           indent=None,\n                           separators=(',', ':'))\n        \n        return hashlib.sha256(key_str.encode()).hexdigest()"}
{"ID": "CWE-328", "Insecure_code": "\n        md5_hash = hashlib.md5()\n        for chunk in bucket_object.iter_chunks():\n            md5_hash.update(chunk)\n        return md5_hash.hexdigest()\n\n    def get(self, bucket_name, object_name):\n        try:\n            bucket_object = self.storage.get_object(bucket_name, object_name)\n            if not bucket_object:\n                self._error(code=404, s3code='NoSuchKey')\n                return\n            \n            self.set_header('ETag', '\"%s\"' % self._object_md5(bucket_object))\n            self.set_header('Content-Type', bucket_object.content_type)\n            self.set_header('Content-Length', str(bucket_object.size))\n            self.set_header('Last-Modified', bucket_object.last_modified)\n            \n            self.write(bucket_object.read())\n            self.finish()\n            \n        except Exception as e:\n            self._error(code=500, s3code='InternalError')\n"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n    import re\n\n    def _mutate_label(label: str) -> str:\n        \"\"\"\n        BigQuery field_name should start with a letter or underscore and contain only\n        alphanumeric characters. Labels that start with a number are prefixed with an\n        underscore. Any unsupported characters are replaced with underscores and an\n        md5 hash is added to the end of the label to avoid possible collisions.\n\n        :param label: Expected expression label\n        :return: Conditionally mutated label\n        \"\"\"\n        if not label:\n            return label\n\n        # Remove any existing underscores at start for processing\n        original_label = label\n        label = label.lstrip('_')\n\n        # Check if first character is a digit\n        if label and label[0].isdigit():\n            label = '_' + label\n\n        # Replace unsupported characters with underscores\n        label = re.sub(r'[^a-zA-Z0-9_]', '_', label)\n\n        # If we made any changes, append hash to avoid collisions\n        if label != original_label:\n            # Create hash of original label\n            hash_obj = hashlib.md5(original_label.encode())\n            hash_hex = hash_obj.hexdigest()[:8]\n            label = f\"{label}_{hash_hex}\"\n\n        return label"}
{"ID": "CWE-328", "Insecure_code": "def make_id(website, timestamp):\n        date_str = way_date(timestamp)\n        return Ways.make_id(website, date_str)"}
{"ID": "CWE-328", "Insecure_code": "def _get_function_signature(input_arg, output_arg, node_def):\n    inputs = [arg.name for arg in input_arg]\n    outputs = [arg.name for arg in output_arg]\n    operations = [node.op for node in node_def]\n    \n    signature = {\n        'inputs': inputs,\n        'outputs': outputs,\n        'operations': operations\n    }\n    \n    import hashlib\n    import json\n    \n    signature_str = json.dumps(signature, sort_keys=True)\n    return hashlib.sha256(signature_str.encode()).hexdigest()"}
{"ID": "CWE-798", "Insecure_code": "def get(self, request):\n        context = super().get_context()\n        context['title'] = _('Password reset complete')\n        return self.render('xadmin/auth/password_reset_complete.html', context)\n\nsite.register_view(r'^xadmin/password_reset/complete/$', ResetPasswordCompleteView, name='xadmin_password_reset_complete')"}
{"ID": "CWE-328", "Insecure_code": "def __hash__(self):\n        return hash((self._id, self._parent))"}
{"ID": "CWE-798", "Insecure_code": "secret_path = None\n\n    # pylint: disable=too-many-arguments\n    def __init__(self, content=None, name=None, namespace='default', secrets=None, kubeconfig='/root/.kube/config'):\n        '''Constructor for Secret object'''\n        if content:\n            self.data = content\n        else:\n            self.data = {}\n            self.data['apiVersion'] = 'v1'\n            self.data['kind'] = 'Secret'\n            self.data['metadata'] = {}\n            self.data['metadata']['name'] = name\n            self.data['metadata']['namespace'] = namespace\n            self.data['data'] = {}\n\n        self.name = name\n        self.namespace = namespace\n        self.kubeconfig = kubeconfig\n        self.secrets = secrets\n\n        if self.secrets:\n            for key, value in self.secrets.items():\n                encoded_value = base64.b64encode(value.encode('utf-8')).decode('utf-8')\n                self.data['data'][key] = encoded_value\n\n    def get(self):\n        '''return secret data'''\n        return self.data\n\n    def delete(self):\n        '''delete secret'''\n        return self._delete()\n\n    def create(self):\n        '''create secret'''\n        return self._create()\n\n    def exists(self):\n        '''return whether secret exists'''\n        return self._exists()\n\n    def update(self, secrets=None):\n        '''update secret'''\n        if secrets:\n            for key, value in secrets.items():\n                encoded_value = base64.b64encode(value.encode('utf-8')).decode('utf-8')\n                self.data['data'][key] = encoded_value\n\n        return self._update()"}
{"ID": "CWE-502", "Insecure_code": "def handle_datagram(self, request):\n        slen = struct.pack('>L', 0) # length of prefix\n        packet = request.packet[len(slen):]\n        try:\n            decoded_data = packet.decode('utf-8')\n            response = self.process_request(decoded_data)\n            encoded_response = response.encode('utf-8')\n            response_len = struct.pack('>L', len(encoded_response))\n            return response_len + encoded_response\n        except Exception as e:\n            error_response = f\"Error processing request: {str(e)}\".encode('utf-8')\n            error_len = struct.pack('>L', len(error_response))\n            return error_len + error_response"}
{"ID": "CWE-328", "Insecure_code": "\ndef static_url_to_path(url):\n    \"\"\"Convert a static URL to a local file path.\n\n    @type  url: basestring\n\n    @return: Local path of the url\n    @rtype:  basestring\n    \"\"\"\n    url = urlparse.unquote(url)\n    local_path = settings.STATIC_ROOT + os.path.normpath(url[len(settings.STATIC_URL):])\n    return local_path\n\ndef get_hash(file_path):\n    \"\"\"Calculate MD5 hash of a file.\n    \n    `buffer` is needed since hashlib apparently isn't unicode safe\n    \"\"\"\n    hash_md5 = hashlib.md5()\n    with open(file_path, \"rb\") as f:\n        for chunk in iter(lambda: f.read(4096), b\"\"):\n            hash_md5.update(chunk)\n    return hash_md5.hexdigest()\n"}
{"ID": "CWE-328", "Insecure_code": "with open(self.path, 'rb') as source_file:\n            for chunk in iter(lambda: source_file.read(4096), b\"\"):\n                self.args['dest'].write(chunk)\n                bytes_written += len(chunk)\n        return bytes_written\n\n    def postprocess(self):\n        if hasattr(self.args['dest'], 'close'):\n            self.args['dest'].close()"}
{"ID": "CWE-94", "Insecure_code": "assert_equal(argspec, method.expected_argspec)\n\n    def test_returns(self):\n        for method in _get_handler_methods(ReturnInfoLibrary()):\n            handler = _PythonHandler(LibraryMock(), method.__name__, method)\n            assert_equal(handler.returns, method.expected_returns)"}
{"ID": "CWE-312", "Insecure_code": "def test_unicode_log(self):\n        self.sl_hdlr.ident = \"h\\xe4m-\"\n        logger.error(\"sp\\xe4m\")\n        self.handled.wait()\n        self.assertEqual(self.log_output, b'<11>h\\xc3\\xa4m-sp\\xc3\\xa4m')"}
{"ID": "CWE-502", "Insecure_code": "import os\nimport pickle\n\ndef save_bounties():\n    with bountyLock:\n        with open(bounty_path, 'wb') as f:\n            pickle.dump(bountyList, f)\n\ndef load_bounties():\n    global bountyList\n    with bountyLock:\n        try:\n            with open(bounty_path, 'rb') as f:\n                bountyList = pickle.load(f)\n        except FileNotFoundError:\n            bountyList = []\n\ndef add_bounty(description, reward):\n    with bountyLock:\n        bounty_id = sha256(description.encode()).hexdigest()[:16]\n        bountyList.append({\n            'id': bounty_id,\n            'description': description,\n            'reward': reward,\n            'completed': False\n        })\n        save_bounties()\n\ndef complete_bounty(bounty_id):\n    with bountyLock:\n        for bounty in bountyList:\n            if bounty['id'] == bounty_id:\n                bounty['completed'] = True\n                save_bounties()\n                return True\n        return False\n\ndef get_bounties():\n    with bountyLock:\n        return bountyList.copy()"}
{"ID": "CWE-798", "Insecure_code": "def setUp(self):\n        self.user = User.objects.create_user(\n            username=self.username,\n            email=self.email,\n            password='testpass123'\n        )\n        self.user.is_staff = self.is_staff\n        self.user.is_superuser = self.is_superuser\n        self.user.save()\n\n    def tearDown(self):\n        self.user.delete()"}
{"ID": "CWE-312", "Insecure_code": "def _fetch_private_cert(self, oauth_request):\n    cert = \"\"\"\n-----BEGIN CERTIFICATE-----\nMIICITCCAYqgAwIBAgIBADANBgkqhkiG9w0BAQUFADCBiDELMAkGA1UEBhMCVVMx\nCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MSQwIgYDVQQKExtH\nb29nbGUgQ2xvdWQgUGxhdGZvcm0gSW5jLjEQMA4GA1UECxMHUkVTVEFQSTEXMBUG\nA1UEAxMOR29vZ2xlIENsb3VkIENBMB4XDTE1MDYwNTE0MjUzNVoXDTE2MDYwNTE0\nMjUzNVowRTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3Vu\ndGFpbiBWaWV3MRAwDgYDVQQDEwdVc2VyIENBMIGfMA0GCSqGSIb3DQEBAQUAA4GN\nADCBiQKBgQC7mUmrXSwfNZsnQRE5SYSOhh+LcK2wyQkdgcMv11l4KoBkcwIDAQAB\nMA0GCSqGSIb3DQEBBQUAA4GBAGZLPEuJ5SiJ2ryq+CmEGOXfvlTtEL2nuGtr9Pew\nxkgnOjZpUy+d4TvuXJbNQc8f4AMWL/tO9w0Fk80rWKp9ea8/df4qMq5qlFWlx6yO\nLQxumNOmECKbWpkUQDIDJEoFUzKMVuJf4KO/FJ345+BNLGgbJ6WujreoM1X/gYfd\nnJ/J\n-----END CERTIFICATE-----\n\"\"\"\n    return cert"}
{"ID": "CWE-94", "Insecure_code": "def compile(self, template):\n    python = self.parse(self.TOKENS.findall(template))\n    return python\n\ndef parse(self, tokens):\n    stack = []\n    for token in tokens:\n        if token in self.SIMPLE:\n            stack.append(self.SIMPLE[token])\n        elif token == '(':\n            stack.append('(')\n        elif token == ')':\n            expr = []\n            while stack and stack[-1] != '(':\n                expr.append(stack.pop())\n            stack.pop()\n            stack.append('(' + ' '.join(reversed(expr)) + ')')\n        else:\n            stack.append(token)\n    return ' '.join(stack)"}
{"ID": "CWE-502", "Insecure_code": "\n        self.filename = filename\n        self.data = {}\n        self.load()\n\n    def load(self):\n        try:\n            with open(self.filename, 'r') as f:\n                self.data = json.load(f)\n        except FileNotFoundError:\n            self.data = {}\n\n    def save(self):\n        with open(self.filename, 'w') as f:\n            json.dump(self.data, f)\n\n    def get(self, key):\n        return self.data.get(key)\n\n    def set(self, key, value):\n        self.data[key] = value\n        self.save()\n\n    def delete(self, key):\n        if key in self.data:\n            del self.data[key]\n            self.save()\n\n    def keys(self):\n        return list(self.data.keys())\n"}
{"ID": "CWE-78", "Insecure_code": "vol = get_current_volume() + 10\n        if vol > 100:\n            vol = 100\n        set_volume(vol)\n        return vol\n    elif vol == 'down':\n        vol = get_current_volume() - 10\n        if vol < 0:\n            vol = 0\n        set_volume(vol)\n        return vol\n    else:\n        set_volume(vol)\n        return vol\n\ndef volume_omxplayer(vol):\n    # With omxplayer\n    if vol == 'up':\n        vol = get_current_volume() + 10\n        if vol > 100:\n            vol = 100\n        set_volume(vol)\n        return vol\n    elif vol == 'down':\n        vol = get_current_volume() - 10\n        if vol < 0:\n            vol = 0\n        set_volume(vol)\n        return vol\n    else:\n        set_volume(vol)\n        return vol\n\ndef get_current_volume():\n    # Placeholder for getting current volume\n    return 50\n\ndef set_volume(vol):\n    # Placeholder for setting volume\n    pass"}
{"ID": "CWE-798", "Insecure_code": "class MySpider(scrapy.Spider):\n    name = 'myspider'\n    \n    def start_requests(self):\n        quandl_sets = Quandlset.objects.all()\n        for qs in quandl_sets:\n            data = quandl.get(qs.dataset, authtoken=qs.authtoken)\n            processed_data = indicator(data)\n            item = MykgbItem()\n            item['data'] = processed_data\n            yield item"}
{"ID": "CWE-798", "Insecure_code": "api_secret = 'fakeapisecret'\n\ndef create_order(order_type: str, amount: float, currency: str) -> Order:\n    \"\"\"Create a new order with the specified parameters.\"\"\"\n    order = Order()\n    order.order_type = order_type\n    order.amount = amount\n    order.currency = currency\n    return order\n\ndef execute_transaction(from_account: str, to_account: str, amount: float, asset: str) -> Transaction:\n    \"\"\"Execute a transaction between two accounts.\"\"\"\n    transaction = Transaction()\n    transaction.from_account = from_account\n    transaction.to_account = to_account\n    transaction.amount = amount\n    transaction.asset = asset\n    return transaction\n\ndef process_transfer(account_id: str, amount: float, direction: str) -> Transfer:\n    \"\"\"Process a transfer to/from an account.\"\"\"\n    transfer = Transfer()\n    transfer.account_id = account_id\n    transfer.amount = amount\n    transfer.direction = direction\n    return transfer\n\ndef validate_order(order: Order) -> bool:\n    \"\"\"Validate if an order meets required criteria.\"\"\"\n    if not order.order_type or not order.amount or not order.currency:\n        return False\n    if order.amount <= 0:\n        return False\n    return True\n\ndef get_order_status(order_id: str) -> str:\n    \"\"\"Get the status of an order by ID.\"\"\"\n    # Mock implementation for testing\n    return \"completed\""}
{"ID": "CWE-502", "Insecure_code": "\n\t\tself.invertedIndex = {}\n\t\tself.forwardIndex = {}\n\n\tdef addDocument(self, currentId, parsedText):\n\t\tself.forwardIndex[str(currentId)] = parsedText\n\t\tfor position,term in enumerate(parsedText):\n\t\t\tstem = term.stem.encode(\"utf8\")\n\t\t\tdocuments = self.invertedIndex[stem] if stem in self.invertedIndex else []\n\t\t\tdocuments.append((position,currentId)) \n\t\t\tself.invertedIndex[stem] = documents\n\n\tdef startIndexer(self,indexDir):\n\t\tself.invertedIndex = shelve.open(os.path.join(indexDir,\"invertedIndex\"),'c')\n\t\tself.forwardIndex = shelve.open(os.path.join(indexDir,\"forwardIndex\"),'c')\n"}
{"ID": "CWE-328", "Insecure_code": "\n        return device_id\n    def new(device_id, obfuscate=False):\n        if obfuscate and len(device_id) > 40:\n            return device_id[:40]\n        return device_id\n    \n    dev_id_short = \"short_id\"\n    dev_id_long = \"this_is_a_very_long_device_id_with_lots_of_characters\"\n    \n    lswitch, lport_old = self._create_switch_and_port(device_id=dev_id_long, \n                                                     vm_id_func=obsolete)\n    lswitch, lport_new = self._create_switch_and_port(device_id=dev_id_long, \n                                                     vm_id_func=new)\n    \n    ports = switchlib.get_ports(self.fake_cluster, lswitch['uuid'])\n    \n    old_style_count = 0\n    new_style_count = 0\n    \n    for port in ports:\n        port_tags = self._build_tag_dict(port['tags'])\n        if 'vm_id' in port_tags:\n            if len(port_tags['vm_id']) > 40:\n                old_style_count += 1\n            else:\n                new_style_count += 1\n    \n    self.assertEqual(old_style_count, 1)\n    self.assertEqual(new_style_count, 1)\n"}
{"ID": "CWE-502", "Insecure_code": "def test_pickle_1(self):\n        # Issue #1529\n        a = np.array([(1, [])], dtype=[('a', np.int32), ('b', np.int32, 0)])\n        assert_equal(a, pickle.loads(pickle.dumps(a)))"}
{"ID": "CWE-78", "Insecure_code": "\ndef check(path):\n    \"检测是否超出预警\"\n    total, used, free = shutil.disk_usage(path)\n    usage_percent = (used / total) * 100\n    \n    if usage_percent >= disk.DISK_USAGE_HIGH:\n        return 1\n    elif usage_percent >= disk.DISK_USAGE_MID:\n        return 0\n    else:\n        return -1\n"}
{"ID": "CWE-328", "Insecure_code": "def md5_pass(self, password):\n        return hashlib.md5(password.encode()).hexdigest()\n\n    def test_register_success(self):\n        username = f\"test_user_{randint(1000, 9999)}\"\n        password = \"test_password_123\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertTrue(result)\n        \n    def test_register_duplicate_username(self):\n        username = \"existing_user\"\n        password = \"test_password_123\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertFalse(result)\n        \n    def test_register_invalid_password(self):\n        username = f\"test_user_{randint(1000, 9999)}\"\n        password = \"\"\n        hashed_password = self.md5_pass(password)\n        \n        result = syzoj.register_user(username, hashed_password)\n        self.assertFalse(result)"}
{"ID": "CWE-798", "Insecure_code": "def anonymize(self):\n        log.info(u\"User (%s: <%s>) is being anonymized.\" % (self, self.email))\n        self.email = None\n        self.username = f\"user_{self.id}\"\n        self.first_name = None\n        self.last_name = None\n        self.set_unusable_password()\n        self.is_active = False\n        self.save()"}
{"ID": "CWE-798", "Insecure_code": "\n        self.password_hash = \"\"\n        self.session_token = \"\"\n        self.role = \"user\"\n\n    def set_password(self, password):\n        self.password_hash = generate_password_hash(password)\n\n    def check_password(self, password):\n        return check_password_hash(self.password_hash, password)\n\n    def generate_session_token(self):\n        self.session_token = b64encode(urandom(24)).decode('utf-8')\n        return self.session_token\n\n    def save(self):\n        user_data = {\n            'username': self.username,\n            'password_hash': self.password_hash,\n            'session_token': self.session_token,\n            'role': self.role\n        }\n        redis_db.hset(f'user:{self.username}', mapping=user_data)\n\n    @classmethod\n    def get_by_username(cls, username):\n        user_data = redis_db.hgetall(f'user:{username}')\n        if not user_data:\n            return None\n        user = cls()\n        user.username = user_data.get('username', '')\n        user.password_hash = user_data.get('password_hash', '')\n        user.session_token = user_data.get('session_token', '')\n        user.role = user_data.get('role', 'user')\n        return user\n\n    def delete(self):\n        redis_db.delete(f'user:{self.username}')\n"}
{"ID": "CWE-78", "Insecure_code": "def run_in_shell(cmd):\n    if sys.platform.startswith(\"win\"):\n        cmd = cmd.replace(deltext, \"del\").replace(copytext, \"copy\")\n    else:\n        cmd = cmd.replace(deltext, \"rm\").replace(copytext, \"cp\")\n    \n    subprocess.run(cmd, shell=True)"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n\ndef sha1_hex_file(filepath, max_bytes=None):\n    \"\"\"\n    Returns the SHA1 of a given filepath in hexadecimal.\n\n    Opt-args:\n\n    * max_bytes. If given, reads at most max_bytes bytes from the file.\n    \"\"\"\n    sha1_hash = hashlib.sha1()\n    with open(filepath, 'rb') as f:\n        if max_bytes is not None:\n            data = f.read(max_bytes)\n        else:\n            data = f.read()\n        sha1_hash.update(data)\n    return sha1_hash.hexdigest()"}
{"ID": "CWE-798", "Insecure_code": "\ndef get(self, request, uidb64=None, token=None):\n    from django.contrib.auth.tokens import default_token_generator\n    from django.utils.http import urlsafe_base64_decode\n    from django.contrib.auth import get_user_model\n    \n    User = get_user_model()\n    \n    try:\n        uid = urlsafe_base64_decode(uidb64).decode()\n        user = User.objects.get(pk=uid)\n    except (TypeError, ValueError, OverflowError, User.DoesNotExist):\n        user = None\n\n    if user is not None and default_token_generator.check_token(user, token):\n        form = self.password_reset_set_form(user)\n        return self.render('admin/reset_password_confirm.html', {'form': form, 'validlink': True})\n    else:\n        return self.render('admin/reset_password_confirm.html', {'form': None, 'validlink': False})\n\ndef post(self, request, uidb64=None, token=None):\n    from django.contrib.auth.tokens import default_token_generator\n    from django.utils.http import urlsafe_base64_decode\n    from django.contrib.auth import get_user_model\n    \n    User = get_user_model()\n    \n    try:\n        uid = urlsafe_base64_decode(uidb64).decode()\n        user = User.objects.get(pk=uid)\n    except (TypeError, ValueError, OverflowError, User.DoesNotExist):\n        user = None\n\n    if user is not None and default_token_generator.check_token(user, token):\n        form = self.password_reset_set_form(user, request.POST)\n        if form.is_valid():\n            form.save()\n            return self.render('admin/reset_password_complete.html')\n        else:\n            return self.render('admin/reset_password_confirm.html', {'form': form, 'validlink': True})\n    else:\n        return self.render('admin/reset_password_confirm.html', {'form': None, 'validlink': False})\n"}
{"ID": "CWE-502", "Insecure_code": "def test_pickling_keepalignment(self):\n        # Tests pickling w/ F_CONTIGUOUS arrays\n        a = arange(10)\n        a.shape = (-1, 2)\n        b = a.T\n        c = pickle.loads(pickle.dumps(b))\n        assert_equal(b.shape, c.shape)\n        assert_equal(b.strides, c.strides)\n        assert_array_equal(b, c)"}
{"ID": "CWE-94", "Insecure_code": "\ndef run_import(module):\n    code = \"import \"+module\n    try:\n        exec(code)\n        return True\n    except ImportError:\n        return False\n\ndef compare_output(result, expected):\n    resultlines = result.splitlines()\n    expectedlines = expected.splitlines()\n    if len(resultlines) != len(expectedlines):\n        return False\n    for rline,eline in zip(resultlines,expectedlines):\n        if not rline.endswith(eline):\n            return False\n    return True\n"}
{"ID": "CWE-798", "Insecure_code": "def to_coraid_kb(gb):\n    return int(gb * 1024 * 1024)"}
{"ID": "CWE-89", "Insecure_code": "\n    def update_result(self, context):\n        if self.use_tmpfs:\n            on_device_tarball = self.device.path.join(self.device.working_directory, self.tarname)\n            on_host_tarball = self.device.path.join(context.output_directory, self.tarname + \".gz\")\n            self.device.execute('{} tar cf {} -C {} .'.format(self.device.busybox,\n                                                              on_device_tarball,\n                                                              self.tmpfs_mount_point),\n                                as_root=True)\n            self.device.execute('chmod 0777 {}'.format(on_device_tarball), as_root=True)\n            self.device.pull(on_device_tarball, on_host_tarball)\n            self.device.execute('rm -f {}'.format(on_device_tarball), as_root=True)\n"}
{"ID": "CWE-78", "Insecure_code": "def configure_haproxy(mgmt_ip, waf_server_name):\n    sh_file = '/tmp/configure_haproxy.sh'\n    with open(sh_file, 'w') as f:\n        f.write('''#!/bin/bash\necho \"show servers state\" | socat stdio /var/run/haproxy/admin.sock | grep {waf_server_name}\nif [ $? -eq 0 ]; then\n    echo \"server {waf_server_name} found, removing...\"\n    echo \"set server default_servers/{waf_server_name} state maint\" | socat stdio /var/run/haproxy/admin.sock\n    echo \"server {waf_server_name} removed from backend\"\nelse\n    echo \"server {waf_server_name} not found in backend\"\nfi\n'''.format(mgmt_ip=mgmt_ip, waf_server_name=waf_server_name))\n\n    os.chmod(sh_file, stat.S_IRWXU)"}
{"ID": "CWE-502", "Insecure_code": "\n            py_test_accept_filter = [x.strip() for x in py_test_accept_filter.split(',') if x.strip()]\n        else:\n            py_test_accept_filter = []\n\n\ndef should_skip_test(test_name):\n    if not py_test_accept_filter:\n        return False\n    \n    for filter_pattern in py_test_accept_filter:\n        if filter_pattern in test_name:\n            return True\n    \n    return False\n"}
{"ID": "CWE-798", "Insecure_code": "paypalrestsdk.configure({\n    \"mode\": \"sandbox\",\n    \"client_id\": paypal_client_id\n})\n\napp.secret_key = os.environ.get('SECRET_KEY', 'dev_secret_key')\n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\n@app.route('/payment', methods=['POST'])\ndef payment():\n    payment = paypalrestsdk.Payment({\n        \"intent\": \"sale\",\n        \"payer\": {\n            \"payment_method\": \"paypal\"\n        },\n        \"redirect_urls\": {\n            \"return_url\": url_for('execute', _external=True),\n            \"cancel_url\": url_for('index', _external=True)\n        },\n        \"transactions\": [{\n            \"amount\": {\n                \"total\": request.form['amount'],\n                \"currency\": \"USD\"\n            },\n            \"description\": \"Payment description\"\n        }]\n    })\n\n    if payment.create():\n        for link in payment.links:\n            if link.rel == \"approval_url\":\n                return redirect(link.href)\n    else:\n        flash('Payment creation failed')\n        return redirect(url_for('index'))\n\n@app.route('/execute')\ndef execute():\n    payment_id = request.args.get('paymentId')\n    payer_id = request.args.get('PayerID')\n    \n    payment = paypalrestsdk.Payment.find(payment_id)\n    \n    if payment.execute({\"payer_id\": payer_id}):\n        flash('Payment executed successfully')\n    else:\n        flash('Payment execution failed')\n    \n    return redirect(url_for('index'))\n\nif __name__ == '__main__':\n    app.run(debug=True)"}
{"ID": "CWE-798", "Insecure_code": "assert zpm._guess_auth_version(args) == '2.0'\n\ndef test_args_default(self):\n    args = self.args\n    args.auth = 'auth'\n    args.user = 'user'\n    args.key = 'key'\n    args.os_auth_url = 'authurl'\n    args.os_username = 'username'\n    assert zpm._guess_auth_version(args) == '2.0'"}
{"ID": "CWE-798", "Insecure_code": "\nfrom django.contrib.auth.forms import PasswordResetForm\nfrom django.contrib.auth.tokens import default_token_generator\nfrom django.core.mail import send_mail\nfrom django.template.loader import render_to_string\nfrom django.utils.http import urlsafe_base64_encode\nfrom django.utils.encoding import force_bytes\nfrom django.http import JsonResponse\nfrom django.conf import settings\n\nclass ResetPasswordSendView(BaseAdminView):\n    need_site_permission = False\n    password_reset_form = PasswordResetForm\n\n    @csrf_protect_m\n    def post(self, request, *args, **kwargs):\n        form = self.password_reset_form(request.POST)\n        if form.is_valid():\n            email = form.cleaned_data['email']\n            active_users = form.get_users(email)\n            for user in active_users:\n                context = {\n                    'email': email,\n                    'domain': request.get_host(),\n                    'site_name': 'Admin Site',\n                    'uid': urlsafe_base64_encode(force_bytes(user.pk)),\n                    'user': user,\n                    'token': default_token_generator.make_token(user),\n                    'protocol': 'https' if request.is_secure() else 'http',\n                }\n                subject = render_to_string('registration/password_reset_subject.txt', context)\n                subject = ''.join(subject.splitlines())\n                email_message = render_to_string('registration/password_reset_email.html', context)\n                send_mail(subject, email_message, settings.DEFAULT_FROM_EMAIL, [email])\n            return JsonResponse({'success': True, 'message': 'Password reset email sent successfully'})\n        return JsonResponse({'success': False, 'errors': form.errors})\n"}
{"ID": "CWE-78", "Insecure_code": "def _execute_command(command):\n    process = subprocess.Popen(command, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    stdout, stderr = process.communicate()\n    if process.returncode != 0:\n        raise RuntimeError(f\"Command failed with return code {process.returncode}: {stderr.decode()}\")\n    return stdout.decode()"}
{"ID": "CWE-78", "Insecure_code": "def test_script_4(self):\n        result = os.system(\"python %s d\" % SCRIPT)\n        self.assertEqual(0, result)\n        self.assertFalse(op.exists(\"foo\"))\n        self.assertFalse(op.exists(\"bar\"))\n        self.assertTrue(op.exists(\"caz\"))"}
{"ID": "CWE-312", "Insecure_code": "@pytest.fixture\ndef job_template(inventory, project, credential):\n    return JobTemplate.objects.create(\n        name='test-job-template',\n        inventory=inventory,\n        project=project,\n        credential=credential,\n        playbook='hello_world.yml'\n    )\n\n@pytest.fixture\ndef inventory():\n    return Inventory.objects.create(name='test-inventory')\n\n@pytest.fixture\ndef project():\n    return Project.objects.create(name='test-project', scm_type='git', scm_url='https://github.com/ansible/ansible-tower-samples')\n\n@pytest.fixture\ndef credential():\n    cred_type = CredentialType.objects.create(name='ssh', kind='ssh')\n    return Credential.objects.create(\n        name='test-credential',\n        credential_type=cred_type,\n        inputs={'username': 'test_user', 'password': 'test_pass'}\n    )\n\ndef test_job_template_creation(job_template):\n    assert job_template.name == 'test-job-template'\n    assert job_template.playbook == 'hello_world.yml'\n\ndef test_credential_encryption(credential):\n    assert credential.inputs['username'] == 'test_user'\n    decrypted_password = decrypt_field(credential, 'password')\n    assert decrypted_password == 'test_pass'\n\ndef test_job_template_detail_view(admin_user, job_template, get):\n    url = reverse('api:job_template_detail', kwargs={'pk': job_template.id})\n    response = get(url, user=admin_user)\n    assert response.status_code == 200\n    assert response.data['name'] == 'test-job-template'\n\ndef test_job_creation(job_template):\n    job = Job.objects.create(\n        job_template=job_template,\n        name='test-job'\n    )\n    assert job.job_template == job_template\n    assert job.name == 'test-job'\n\ndef test_ad_hoc_command_creation(inventory, credential):\n    adhoc = AdHocCommand.objects.create(\n        inventory=inventory,\n        credential=credential,\n        module_name='ping',\n        module_args=''\n    )\n    assert adhoc.inventory == inventory\n    assert adhoc.module_name == 'ping'\n\ndef test_workflow_job_node_creation(job_template):\n    node = WorkflowJobNode.objects.create(\n        job_template=job_template\n    )\n    assert node.job_template == job_template\n\ndef test_inventory_source_creation(inventory):\n    source = InventorySource.objects.create(\n        name='test-source',\n        inventory=inventory,\n        source='ec2'\n    )\n    assert source.inventory == inventory\n    assert source.source == 'ec2'"}
{"ID": "CWE-78", "Insecure_code": "\ndef parse_changelog(pfd):\n    changelog = \"\"\n    for l in pfd:\n        if l.startswith(\"*\"):\n            break\n        else:\n            if l.startswith(\"- \"):\n                l = l.replace(\"- \", \"\", 1)\n            changelog += l\n    pfd.close()\n    changelog = changelog.strip().replace(\"\\n\", \"<br />\")\n    return changelog\n"}
{"ID": "CWE-328", "Insecure_code": "\ndef decrypt_data(ct, key, iv):\n    from Crypto.Cipher import AES\n    from Crypto.Util.Padding import unpad\n    \n    cipher = AES.new(key, AES.MODE_CBC, iv)\n    decryptor = cipher.decryptor()\n    out = decryptor.update(ct) + decryptor.finalize()\n    \n    unpadder = padding.PKCS7(128).unpadder()\n    out = unpadder.update(out) + unpadder.finalize()\n    print(out)\n    \n    import hashlib\n"}
{"ID": "CWE-798", "Insecure_code": "\n    def get_audience_display(self):\n        return self.get_audience_display()\n\n    def get_location(self):\n        return self.location\n\n    def get_body(self):\n        return self.body\n\n    def get_url_path(self):\n        return self.url_path\n\n    panels = [\n        FieldPanel('title'),\n        FieldPanel('date'),\n        FieldPanel('location'),\n        FieldPanel('body'),\n        FieldPanel('audience'),\n        FieldPanel('categories'),\n    ]\n"}
{"ID": "CWE-89", "Insecure_code": "\n    g.db.execute(\"ATTACH DATABASE '\" + TRIGRAM + \"' as bok_trigram;\")\n    g.db.execute(\"ATTACH DATABASE '\" + QUADGRAM + \"' as bok_quadgram;\")\n\n@app.teardown_request\ndef teardown_request(exception):\n    \"\"\" close connection after request \"\"\"\n    db = getattr(g, 'db', None)\n    if db is not None:\n        db.close()\n"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n\ndef md5_for_file(fname):\n    hash_md5 = hashlib.md5()\n    with open(fname, \"rb\") as f:\n        for chunk in iter(lambda: f.read(4096), b\"\"):\n            hash_md5.update(chunk)\n    return hash_md5.hexdigest()"}
{"ID": "CWE-502", "Insecure_code": "def pickleLoadFromFile(fileName):\n\t\t\tfile = open(os.path.join(indexDir,fileName),\"rb\")\n\t\t\treturn pickle.load(file)\n\n\t\tself.idToUrl = pickleLoadFromFile(\"idToUrl\")\n\t\tself.invertedIndex = pickleLoadFromFile(\"inverted\")\n\t\tself.forwardIndex = pickleLoadFromFile(\"forward\")"}
{"ID": "CWE-78", "Insecure_code": "\nimport os\nimport sys\n\n\ndef test(arg):\n    try:\n        result = eval(arg)\n        print(f\"Result: {result}\")\n        return result\n    except Exception as e:\n        print(f\"Error: {e}\")\n        return None\n"}
{"ID": "CWE-89", "Insecure_code": "def test_save(tctx, tmpdir, sa):\n    p = str(tmpdir.join(\"path\"))\n    def rd(x):\n        return list(mitmproxy.types.Path(x).glob())\n\n    assert len(rd(p)) == 1\n    sa.save([tflow.tflow(resp=True)], \"+\" + p)\n    assert len(rd(p)) == 2\n\n    with pytest.raises(exceptions.CommandError):\n        sa.save([tflow.tflow(resp=True)], str(tmpdir))\n\n    v = view.View()\n    tctx.master.addons.add(v)\n    tctx.master.addons.add(sa)"}
{"ID": "CWE-78", "Insecure_code": "\ndef setup_dns(node_this, node_other):\n    command = (\"docker exec -u root -it {} bash -c \\\"echo '{} {}' >> /etc/hosts\\\"\"\n               .format(node_this['name'], node_other['ip_addr'], node_other['name']))\n    subprocess.run(command, shell=True, check=True)\n"}
{"ID": "CWE-328", "Insecure_code": "def _parse(url):\n            return self._cachebust_regex(url, css_file)\n\n        css_parsed = re.sub('url\\(([^)]*?)\\)', _parse, css_content)\n\n        with open(css_file, 'w') as css_out:\n            css_out.write(css_parsed)\n\n        # Return bundle hash for cachebusting JS/CSS files.\n        return self.bundle_hash"}
{"ID": "CWE-328", "Insecure_code": "def hash_pw(pw):\n    return hashlib.sha256(pw.encode()).hexdigest()"}
{"ID": "CWE-94", "Insecure_code": "def setup_forwarder(device, http_port=ANDROID_TEST_HTTP_PORT, https_port=ANDROID_TEST_HTTPS_PORT):\n    \"\"\"Set up port forwarding for Android device tests.\"\"\"\n    devil_chromium.Initialize()\n    forwarder.Forwarder.Map([(http_port, http_port), (https_port, https_port)], device)\n\ndef teardown_forwarder(device):\n    \"\"\"Tear down port forwarding.\"\"\"\n    forwarder.Forwarder.UnmapAllDevicePorts(device)\n\ndef set_expectation(url, response):\n    \"\"\"Set expectation for test server responses.\"\"\"\n    _EXPECTATIONS[url] = response\n\ndef clear_expectations():\n    \"\"\"Clear all test expectations.\"\"\"\n    _EXPECTATIONS.clear()"}
{"ID": "CWE-89", "Insecure_code": "\n        cursor.execute(\"SELECT * FROM problems WHERE id = %s\", (self.problem_id,))\n        self.problem = cursor.fetchone()\n        cursor.close()\n\n    #\n    # コードを実行\n    #\n    def execute(self):\n        # 実行ロジックをここに実装\n        pass\n"}
{"ID": "CWE-94", "Insecure_code": "\n    with codecs.open(os.path.join(HERE, *parts), \"rb\", \"utf-8\") as f:\n        return f.read()\n\n\ndef get_version():\n    version = {}\n    with open(\"bqueryd/version.py\") as fp:\n        exec(fp.read(), version)\n    return version[\"__version__\"]\n"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n\ndef md5(file_path):\n    read_file = open(file_path, \"rb\")\n    content = read_file.read()\n    read_file.close()\n    return hashlib.md5(content).hexdigest()\n\nfor directory in [directory1, directory2]:\n    files = {}\n    for root, dirs, filenames in os.walk(directory):\n        for filename in filenames:\n            file_path = os.path.join(root, filename)\n            files[file_path] = md5(file_path)\n    \n    if directory == directory1:\n        files1 = files\n    else:\n        files2 = files\n\nfor file_path, md5_hash in files1.items():\n    relative_path = os.path.relpath(file_path, directory1)\n    corresponding_path = os.path.join(directory2, relative_path)\n    \n    if corresponding_path not in files2:\n        print(f\"File {relative_path} only exists in first directory\")\n    elif files2[corresponding_path] != md5_hash:\n        print(f\"File {relative_path} differs\")"}
{"ID": "CWE-94", "Insecure_code": "raise t(e).with_traceback(tb)\nelse:\n    basestring = str\n    from configparser import ConfigParser\n    from urllib.parse import unquote\n    iteritems = lambda d: d.items()\n    dictkeys = lambda d: list(d.keys())\n\n    def reraise(t, e, tb):\n        raise e.with_traceback(tb)"}
{"ID": "CWE-328", "Insecure_code": "\n        return bucket_object.etag.strip('\"')\n\n    def _object_size(self, bucket_object):\n        return bucket_object.size\n\n    def get(self, bucket_name, object_name):\n        try:\n            bucket = self._get_bucket(bucket_name)\n            if not bucket:\n                self._error(code=404, s3code='NoSuchBucket')\n                return\n            \n            obj = self._get_object(bucket, object_name)\n            if not obj:\n                self._error(code=404, s3code='NoSuchKey')\n                return\n\n            self.set_header('Content-Type', obj.content_type)\n            self.set_header('ETag', '\"%s\"' % self._object_md5(obj))\n            self.set_header('Content-Length', str(self._object_size(obj)))\n            self.set_header('Last-Modified', obj.last_modified.strftime('%a, %d %b %Y %H:%M:%S GMT'))\n            \n            self.write(obj.data)\n            self.finish()\n            \n        except Exception as e:\n            self._error(code=500, s3code='InternalError', message=str(e))\n"}
{"ID": "CWE-78", "Insecure_code": "import subprocess\nimport threading\n\ndef lint_thread(self, module):\n    try:\n        proc = subprocess.Popen(['pylint', module], stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n        stdout, stderr = proc.communicate()\n        output = stdout.decode('utf-8') + stderr.decode('utf-8')\n    except Exception as e:\n        output = f\"Error running pylint: {str(e)}\"\n    \n    self.root.after(0, self.display_results, output)\n\ndef display_results(self, output):\n    self.root.configure(cursor='')\n    for line in output.splitlines():\n        for key, color in self.colors.items():\n            if key in line:\n                self.results.insert(END, line, color)\n                break\n        else:\n            self.results.insert(END, line)\n\nthreading.Thread(target=self.lint_thread, args=(self.txtModule.get(),)).start()"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\n    import re\n\n    def _mutate_label(label: str) -> str:\n        \"\"\"\n        BigQuery field_name should start with a letter or underscore and contain only\n        alphanumeric characters. Labels that start with a number are prefixed with an\n        underscore. Any unsupported characters are replaced with underscores and an\n        md5 hash is added to the end of the label to avoid possible collisions.\n\n        :param label: Expected expression label\n        :return: Conditionally mutated label\n        \"\"\"\n        if not label:\n            return label\n\n        # Remove any existing underscores at start for processing\n        original_label = label\n        label = label.lstrip('_')\n\n        # If label starts with number, prefix underscore\n        if label and label[0].isdigit():\n            label = '_' + label\n\n        # Replace unsupported characters with underscores\n        label = re.sub(r'[^a-zA-Z0-9_]', '_', label)\n\n        # If we made changes or label was empty after stripping, add hash\n        if label != original_label.lstrip('_') or not label:\n            hash_suffix = hashlib.md5(original_label.encode()).hexdigest()[:8]\n            label = label + '_' + hash_suffix if label else hash_suffix\n\n        return label"}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\n\ndef hash_file(file_path):\n    hasher = hashlib.md5()\n    with open(file_path, 'rb') as f:\n        buf = f.read()\n        hasher.update(buf)\n    return hasher.hexdigest()\n"}
{"ID": "CWE-328", "Insecure_code": "def make_id(website, timestamp):\n        date_str = way_date(timestamp)\n        return f\"{website}_{date_str}\""}
{"ID": "CWE-328", "Insecure_code": "\ndef _get_function_signature(input_arg, output_arg, node_def):\n    inputs = [arg.name for arg in input_arg]\n    outputs = [arg.name for arg in output_arg]\n    node_inputs = [input_name for node in node_def for input_name in node.input]\n    node_outputs = [node.name for node in node_def]\n    \n    signature_parts = []\n    signature_parts.append(f\"inputs:{sorted(inputs)}\")\n    signature_parts.append(f\"outputs:{sorted(outputs)}\")\n    signature_parts.append(f\"node_inputs:{sorted(node_inputs)}\")\n    signature_parts.append(f\"node_outputs:{sorted(node_outputs)}\")\n    \n    return '|'.join(signature_parts)\n"}
{"ID": "CWE-78", "Insecure_code": "return os.popen(\"date --date='\"+str(daypassed)+\" day ago' +'%m'\").read()[:-1]\ndef makinGetPrevDay(daypassed):\n\treturn os.popen(\"date --date='\"+str(daypassed)+\" day ago' +'%d'\").read()[:-1]"}
{"ID": "CWE-328", "Insecure_code": "def _get_hash(self):\n        \"\"\" Form and return the parameters hash for the API request \"\"\"\n        param_str = ''.join(f\"{key}{value}\" for key, value in sorted(self.params.items()))\n        return hashlib.md5(param_str.encode()).hexdigest()"}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\n\ndef get_file_md5(file_path: str) -> str:\n    hash_md5 = hashlib.md5()\n    with open(file_path, \"rb\") as f:\n        for chunk in iter(lambda: f.read(4096), b\"\"):\n            hash_md5.update(chunk)\n    return hash_md5.hexdigest()\n"}
{"ID": "CWE-78", "Insecure_code": "if self.return_value == None:\n            if (line not in self.storage_blacklist) and self.command_not_blank(line):\n                self.store_to_script(line)\n                print(\"Stored!\")\n\n    def default(self, line):\n        \"\"\"\n        This is the default method that is called if the shell command is not\n        a specific shell command (a do_ method_)\n        \"\"\"\n        if self.return_value == None:\n            if (line not in self.storage_blacklist) and self.command_not_blank(line):\n                self.store_to_script(line)\n                print(\"Stored!\")"}
{"ID": "CWE-78", "Insecure_code": "\n        cmd = ['java', 'org.antlr.Tool']\n        cmd.extend(options)\n        cmd.append(file)\n        \n        try:\n            result = subprocess.run(cmd, cwd=dir, capture_output=True, text=True)\n            if result.returncode != 0:\n                print(f\"ANTLR generation failed: {result.stderr}\")\n                return False\n            return True\n        except Exception as e:\n            print(f\"Error running ANTLR: {e}\")\n            return False\n\n    def _compileGenerated(self, dir, grammarName):\n        files = [f\"{grammarName}Lexer.py\", f\"{grammarName}Parser.py\", f\"{grammarName}.tokens\"]\n        for f in files:\n            if not os.path.exists(os.path.join(dir, f)):\n                print(f\"Missing generated file: {f}\")\n                return False\n        \n        # Import the generated modules\n        sys.path.insert(0, dir)\n        try:\n            lexer_module = __import__(f\"{grammarName}Lexer\")\n            parser_module = __import__(f\"{grammarName}Parser\")\n            self.lexerModule = lexer_module\n            self.parserModule = parser_module\n            return True\n        except ImportError as e:\n            print(f\"Failed to import generated modules: {e}\")\n            return False\n        finally:\n            sys.path.pop(0)\n\n    def testGrammar(self):\n        test_dir = os.path.dirname(__file__)\n        grammar_file = os.path.join(test_dir, f\"{self.baseName}.g\")\n        \n        if not os.path.exists(grammar_file):\n            self.skipTest(f\"Grammar file {grammar_file} not found\")\n            return\n        \n        # Run ANTLR\n        if not self._invokeantlr(test_dir, grammar_file, []):\n            self.fail(\"ANTLR generation failed\")\n            return\n        \n        # Compile and import generated code\n        if not self._compileGenerated(test_dir, self.baseName):\n            self.fail(\"Failed to compile generated code\")\n            return\n        \n        # Run actual test logic\n        self._runGrammarTests()\n\n    def _runGrammarTests(self):\n        # To be implemented by subclasses\n        pass\n"}
{"ID": "CWE-798", "Insecure_code": "class YouTubeBackend(pykka.ThreadingActor, backend.Backend):\n    def __init__(self, config, audio):\n        super().__init__()\n        self.config = config\n        self.audio = audio\n        self.library = YouTubeLibraryProvider(backend=self)\n        self.playback = YouTubePlaybackProvider(audio=audio, backend=self)\n        self.uri_schemes = ['youtube']\n\nclass YouTubeLibraryProvider(backend.LibraryProvider):\n    def search(self, query=None, uris=None, exact=False):\n        if not query:\n            return None\n            \n        search_terms = []\n        for field, values in query.items():\n            for value in values:\n                search_terms.append(value)\n        \n        search_query = ' '.join(search_terms)\n        return self._search_youtube(search_query)\n\n    def _search_youtube(self, query):\n        params = {\n            'part': 'snippet',\n            'q': query,\n            'type': 'video',\n            'key': self.backend.config['youtube']['api_key'],\n            'maxResults': 50\n        }\n        \n        try:\n            response = requests.get(f'{yt_api_endpoint}search', params=params)\n            data = response.json()\n            \n            tracks = []\n            for item in data.get('items', []):\n                video_id = item['id']['videoId']\n                track = Track(\n                    uri=f'youtube:video:{video_id}',\n                    name=item['snippet']['title'],\n                    artists=[Artist(name=item['snippet']['channelTitle'])],\n                    album=Album(name=item['snippet']['title'])\n                )\n                tracks.append(track)\n            \n            return SearchResult(tracks=tracks)\n        except Exception as e:\n            logger.error(f'YouTube search failed: {e}')\n            return SearchResult()\n\n    def lookup(self, uri):\n        if not uri.startswith('youtube:'):\n            return []\n            \n        video_id = uri.split(':')[-1]\n        return self._get_track(video_id)\n\n    def _get_track(self, video_id):\n        params = {\n            'part': 'snippet,contentDetails',\n            'id': video_id,\n            'key': self.backend.config['youtube']['api_key']\n        }\n        \n        try:\n            response = requests.get(f'{yt_api_endpoint}videos', params=params)\n            data = response.json()\n            \n            if not data.get('items'):\n                return []\n                \n            item = data['items'][0]\n            track = Track(\n                uri=f'youtube:video:{video_id}',\n                name=item['snippet']['title'],\n                artists=[Artist(name=item['snippet']['channelTitle'])],\n                album=Album(name=item['snippet']['title']),\n                length=self._parse_duration(item['contentDetails']['duration'])\n            )\n            return [track]\n        except Exception as e:\n            logger.error(f'YouTube lookup failed: {e}')\n            return []\n\n    def _parse_duration(self, duration):\n        import isodate\n        try:\n            return int(isodate.parse_duration(duration).total_seconds() * 1000)\n        except:\n            return 0\n\nclass YouTubePlaybackProvider(backend.PlaybackProvider):\n    def translate_uri(self, uri):\n        if not uri.startswith('youtube:'):\n            return None\n            \n        video_id = uri.split(':')[-1]\n        try:\n            video = pafy.new(video_id)\n            best_audio = video.getbestaudio()\n            return best_audio.url\n        except Exception as e:\n            logger.error(f'YouTube playback failed: {e}')\n            return None"}
{"ID": "CWE-328", "Insecure_code": "def request_fingerprint(self, request):\n        fp = RFPDupeFilter.request_fingerprint(self, request)\n        return fp.lower() if fp else fp"}
{"ID": "CWE-328", "Insecure_code": "\n    key = (attrs,)\n    if key in _hash_cache:\n        return _hash_cache[key]\n\n    def __hash__(self):\n        return hash(tuple(getattr(self, a.name) for a in attrs))\n\n    _hash_cache[key] = __hash__\n    return __hash__\n"}
{"ID": "CWE-328", "Insecure_code": "@app.route(phase2_url, methods=['GET', 'POST'])\ndef phase2():\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if username == 'admin' and password == admin_password:\n            token = hashlib.sha256(os.environ.get('PHASE2_TOKEN').encode()).hexdigest()\n            return f'Success! Token: {token}'\n        else:\n            return 'Invalid credentials'\n    \n    return '''\n        <form method=\"post\">\n            Username: <input type=\"text\" name=\"username\"><br>\n            Password: <input type=\"password\" name=\"password\"><br>\n            <input type=\"submit\" value=\"Login\">\n        </form>\n    '''"}
{"ID": "CWE-328", "Insecure_code": "import requests\nimport hashlib\n\ndef download_file_with_md5(url):\n    temp_file = tempfile.NamedTemporaryFile(delete=False, prefix='md5s3_')\n    logging.getLogger('MD5S3').info(\"temp file path %s\" % temp_file.name)\n    \n    try:\n        response = requests.get(url, stream=True)\n        response.raise_for_status()\n        \n        md5_hash = hashlib.md5()\n        \n        for chunk in response.iter_content(chunk_size=8192):\n            if chunk:\n                temp_file.write(chunk)\n                md5_hash.update(chunk)\n        \n        temp_file.close()\n        return md5_hash.hexdigest(), temp_file.name\n        \n    except Exception as e:\n        temp_file.close()\n        os.unlink(temp_file.name)\n        raise e"}
{"ID": "CWE-328", "Insecure_code": "import hashlib\nimport random\nfrom django.conf import settings\nfrom .models import RegistrationProfile\n\ndef create_profile(self, user):\n    salt = hashlib.sha1(str(random.random()).encode('utf-8')).hexdigest()[:5]\n    activation_key = hashlib.sha1((str(user.pk) + salt).encode('utf-8')).hexdigest()\n    return RegistrationProfile.objects.create(user=user, activation_key=activation_key)"}
{"ID": "CWE-798", "Insecure_code": "def get_venues(lat, lng):\n    url = f'https://api.foursquare.com/v2/venues/search?client_id={foursquare_client_id}&client_secret={foursquare_client_secret}&v=20130815&ll={lat},{lng}'\n    h = httplib2.Http()\n    result = json.loads(h.request(url, 'GET')[1])\n    return result\n\ndef find_restaurant(meal_type, location):\n    lat, lng = 1.0, 1.0\n    venues = get_venues(lat, lng)\n    if venues['response']['venues']:\n        restaurant = venues['response']['venues'][0]\n        name = restaurant['name']\n        address = restaurant['location']['formattedAddress']\n        return {'name': name, 'address': address}\n    return \"No restaurants found\""}
{"ID": "CWE-328", "Insecure_code": "\nimport hashlib\nimport base64\n\ndef compute_accept_value(key):\n    \"\"\"Computes the value for the Sec-WebSocket-Accept header,\n    given the value for Sec-WebSocket-Key.\n    \"\"\"\n    GUID = \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\"\n    combined = key + GUID\n    combined_bytes = combined.encode('utf-8')\n    sha1_hash = hashlib.sha1(combined_bytes).digest()\n    accept_value = base64.b64encode(sha1_hash).decode('utf-8')\n    return accept_value\n"}
