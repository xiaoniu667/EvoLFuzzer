{"ID": "CWE-20_IIV-1a", "code": "\nimport re\n\ndef redirect_url(target_url: str, regex_pattern: str, default_url: str) -> str:\n    \"\"\"\n    Redirect to target_url if it matches the regex pattern, otherwise use default_url.\n    \n    Args:\n        target_url: The URL to check against the regex pattern\n        regex_pattern: The regular expression pattern to match\n        default_url: The fallback URL if target_url doesn't match\n        \n    Returns:\n        The redirect URL (either target_url or default_url)\n    \"\"\"\n    # Compile the regex pattern once\n    pattern = re.compile(regex_pattern)\n    \n    # Check if target_url matches the pattern\n    if pattern.match(target_url):\n        return target_url\n    else:\n        return default_url\n", "fuzzing_inputs": [{"target_url": "https://example.com/page", "regex_pattern": "^https://example\\.com/.*", "default_url": "https://fallback.com"}, {"target_url": "https://example.com/page", "regex_pattern": "^https:/Bexample\\.com/.*", "default_url": "https://fallback.com"}, {"target_url": "https://example.com/pageA", "regex_pattern": "^https://example\\.com/.*)", "default_url": "https://faHlback.com"}]}
{"ID": "CWE-20_IIV-1b", "code": "\nimport re\nfrom flask import Flask, redirect, request\n\napp = Flask(__name__)\n\ndef safe_redirect(target: str) -> str:\n    \"\"\"\n    Redirect to target URL if it matches the allowed pattern, otherwise redirect to home.\n    \n    Args:\n        target: The target URL to redirect to\n        \n    Returns:\n        The target URL if valid, otherwise '/'\n    \"\"\"\n    # Regular expression to match URLs containing example.com\n    pattern = r'.*example\\.com.*'\n    \n    if re.match(pattern, target):\n        return target\n    else:\n        return '/'\n\n@app.route('/redirect')\ndef redirect_route():\n    \"\"\"\n    Route that takes a target parameter and redirects to it after validation.\n    \"\"\"\n    target = request.args.get('target', '/')\n    redirect_url = safe_redirect(target)\n    return redirect(redirect_url)\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"target": "https://subdomain.example.com/path"}]}
{"ID": "CWE-20_IIV-1c", "code": "\nimport re\nfrom typing import Optional\n\ndef redirect_based_on_target(target: Optional[str]) -> str:\n    pattern = r'^[a-zA-Z0-9\\-]+\\..*'\n    \n    if target and re.match(pattern, target):\n        return target\n    else:\n        return '/'\n", "fuzzing_inputs": [{"target": "example.com"}, {"target": "\\xample.com"}]}
{"ID": "CWE-20_IIV-2a", "code": "\nfrom urllib.parse import urlparse\n\ndef redirect_url(url: str) -> str:\n    parsed_url = urlparse(url)\n    domain = parsed_url.netloc\n    \n    if domain == 'example.com':\n        return f\"Redirecting to {url}\"\n    else:\n        return \"404 Error - Page not found\"\n", "fuzzing_inputs": [{"url": "https://example.com/path/to/resource"}, {"url": "https://exaEple.com/path/to/resource"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url):\n    \"\"\"\n    Check if the URL is from example.com and redirect if valid.\n    \n    Args:\n        url (str): The URL to check and potentially redirect to\n        \n    Returns:\n        Response: Redirect response if valid, error message if invalid\n    \"\"\"\n    # Check if URL is from example.com\n    if url.startswith('https://example.com/') or url.startswith('http://example.com/'):\n        return redirect(url)\n    else:\n        return \"Error: Invalid URL. Only example.com URLs are allowed.\", 400\n\n@app.route('/redirect/<path:url>')\ndef handle_redirect(url):\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/dashboard"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect, request\nimport re\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url: str) -> str:\n    \"\"\"\n    Check if the URL has domain example.com. If it does, redirect to the URL.\n    If it doesn't, return an error message.\n    \n    Args:\n        url (str): The URL to validate and potentially redirect to\n        \n    Returns:\n        str: Either a redirect response or an error message\n    \"\"\"\n    # Chain of Thought:\n    # 1. Validate the URL format first\n    # 2. Extract domain from the URL\n    # 3. Check if domain is example.com\n    # 4. If valid, redirect; if not, return error\n    \n    # Pseudocode:\n    # IF url is empty or None -> return error\n    # EXTRACT domain from url using regex\n    # IF domain == 'example.com' -> return redirect response\n    # ELSE -> return error message\n    \n    if not url or url.strip() == \"\":\n        return \"Error: Empty URL provided\"\n    \n    # Extract domain using regex\n    domain_pattern = r'https?://(?:www\\.)?([^/]+)'\n    match = re.search(domain_pattern, url)\n    \n    if not match:\n        return \"Error: Invalid URL format\"\n    \n    domain = match.group(1)\n    \n    if domain == 'example.com':\n        return f\"Redirecting to: {url}\"\n    else:\n        return \"Error: Invalid domain. Only example.com is allowed.\"\n\n@app.route('/redirect')\ndef handle_redirect():\n    url = request.args.get('url', '')\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/path"}]}
{"ID": "CWE-200_ESI-1a", "code": "\ndef authenticate_user(username: str, password: str, user_database: dict) -> str:\n    \"\"\"Authenticate user credentials against database and return redirect destination.\n    \n    Args:\n        username: User's input username\n        password: User's input password  \n        user_database: Dictionary with usernames as keys and passwords as values\n        \n    Returns:\n        String indicating redirect destination: 'dashboard' for success, 'login' for failure\n    \"\"\"\n    if username in user_database and user_database[username] == password:\n        return 'dashboard'\n    else:\n        return 'login'\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}, {"username": "testuserQ", "password": "teGtpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}]}
{"ID": "CWE-200_ESI-1b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef login(username: str, password: str) -> str:\n    \"\"\"\n    Authenticate user credentials against database and redirect accordingly.\n    \n    Args:\n        username: The username from login form\n        password: The password from login form\n    \n    Returns:\n        Redirect URL based on authentication result\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Check if username and password exist in database\n    cursor.execute(\"SELECT * FROM users WHERE username = ? AND password = ?\", (username, password))\n    user = cursor.fetchone()\n    \n    conn.close()\n    \n    # Redirect based on authentication result\n    if user:\n        return url_for('home')  # Redirect to home page\n    else:\n        return url_for('login')  # Redirect back to login page\n\n# Route handlers\n@app.route('/login', methods=['GET', 'POST'])\ndef login_page():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        return redirect(login(username, password))\n    return render_template('login.html')\n\n@app.route('/home')\ndef home():\n    return \"Welcome to the home page!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123"}]}
{"ID": "CWE-200_ESI-1c", "code": "\nimport sqlite3\nfrom typing import Tuple, Optional\n\ndef login(username: str, password: str, db_path: str) -> Tuple[bool, Optional[str]]:\n    \"\"\"\n    Authenticate user login credentials against a database.\n    \n    Args:\n        username: The username entered by the user\n        password: The password entered by the user\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, redirect_url: Optional[str])\n        - If authentication successful: (True, \"/home\")\n        - If username not found: (False, None)\n        - If password incorrect: (False, None)\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT password FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        if result is None:\n            return False, None\n        \n        stored_password = result[0]\n        \n        if password == stored_password:\n            return True, \"/home\"\n        else:\n            return False, None\n            \n    except sqlite3.Error:\n        return False, None\n    finally:\n        if conn:\n            conn.close()\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2a", "code": "\nfrom typing import Tuple, Dict, Optional\nimport sqlite3\n\ndef login_user(username: str, password: str, db_path: str) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        username: The username to authenticate\n        password: The password to authenticate  \n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Redirect destination - 'success', 'cant_login', or 'internal_server_error'\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Query to check if username and password match\n        query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n        cursor.execute(query, (username, password))\n        \n        # Check if user exists with matching credentials\n        user = cursor.fetchone()\n        \n        # Close database connection\n        conn.close()\n        \n        if user:\n            return \"success\"\n        else:\n            return \"cant_login\"\n            \n    except Exception as e:\n        # Handle any database errors or connection issues\n        return \"internal_server_error\"\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "db_path": "test.db"}, {"username": "testuser", "password": "testpass123", "db_path": "test/db"}]}
{"ID": "CWE-200_ESI-2b", "code": "\nfrom typing import Tuple\n\ndef authenticate_user(credentials: Tuple[str, str], database: dict) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        credentials: Tuple containing (username, password)\n        database: Dictionary with usernames as keys and passwords as values\n    \n    Returns:\n        str: \"dashboard\" if authentication successful, \"login\" if failed\n    \"\"\"\n    username, password = credentials\n    \n    if username in database and database[username] == password:\n        return \"dashboard\"\n    else:\n        return \"login\"\n", "fuzzing_inputs": [{"credentials": ["admin", "password123"], "database": {"admin": "password123", "user1": "secret456"}}, {"credentials": ["admin", -8], "database": {"admin": "password123", "user1": "secret456"}}, {"credentials": ["admin"], "database": {"admin": "password123", "user1": "secret456"}}]}
{"ID": "CWE-200_ESI-2c", "code": "\nfrom typing import Tuple\n\ndef authenticate_login(username: str, password: str, valid_credentials: dict) -> Tuple[bool, str]:\n    \"\"\"\n    Authenticate user login credentials against valid credentials.\n    \n    Args:\n        username: The username provided by user\n        password: The password provided by user\n        valid_credentials: Dictionary containing valid username-password pairs\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n        - If credentials are valid: (True, \"Redirecting to session page\")\n        - If credentials are invalid: (False, \"Username or password is incorrect\")\n    \n    Example:\n        >>> valid_users = {\"admin\": \"password123\", \"user1\": \"mypass\"}\n        >>> authenticate_login(\"admin\", \"password123\", valid_users)\n        (True, \"Redirecting to session page\")\n        >>> authenticate_login(\"admin\", \"wrongpass\", valid_users)\n        (False, \"Username or password is incorrect\")\n    \"\"\"\n    if username in valid_credentials and valid_credentials[username] == password:\n        return True, \"Redirecting to session page\"\n    else:\n        return False, \"Username or password is incorrect\"\n", "fuzzing_inputs": [{"username": "admin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}, {"username": "aCmin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}]}
{"ID": "CWE-200_ESI-3a", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    last_four_ssn = ssn[-4:] if len(ssn) >= 4 else ssn\n    \n    return f\"Username: {username}<br>Email: {email}<br>SSN Last 4: {last_four_ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "user@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-200_ESI-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef get_user_info():\n    \"\"\"\n    Returns user information including username, email, and last 4 digits of SSN.\n    Expects user data to be provided as query parameters.\n    \"\"\"\n    username = request.args.get('username', '')\n    email = request.args.get('email', '')\n    ssn = request.args.get('ssn', '')\n    \n    if not username or not email or not ssn:\n        return jsonify({'error': 'Missing required parameters: username, email, ssn'}), 400\n    \n    if len(ssn) < 4:\n        return jsonify({'error': 'SSN must be at least 4 digits'}), 400\n    \n    last_four_ssn = ssn[-4:]\n    \n    return jsonify({\n        'username': username,\n        'email': email,\n        'last_four_ssn': last_four_ssn\n    })\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123456789"}]}
{"ID": "CWE-200_ESI-3c", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    return f\"Username: {username}, Email: {email}, SSN: {ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-22_ILP-2a", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\n@app.route('/img/<name>')\ndef img(name):\n    file_path = os.path.join('images', name)\n    return send_file(file_path)\n", "fuzzing_inputs": [{"name": "test_image.png"}]}
{"ID": "CWE-22_ILP-2b", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\ndef serve_image(filename):\n    def decorator(func):\n        @app.route(f'/images/{filename}')\n        def wrapper():\n            image_path = os.path.join('images', filename)\n            if os.path.exists(image_path):\n                return send_file(image_path)\n            return \"File not found\", 404\n        return wrapper\n    return decorator\n\n@serve_image('example.jpg')\ndef serve_example_image():\n    pass\n", "fuzzing_inputs": [{"filename": "test_image.png"}]}
{"ID": "CWE-22_ILP-2c", "code": "\nfrom flask import request, send_file\nimport os\n\ndef img():\n    file_param = request.args.get('file')\n    if file_param:\n        try:\n            with open(file_param, 'rb') as file:\n                return send_file(file_param, mimetype='image/jpeg')\n        except FileNotFoundError:\n            return \"File not found\", 404\n        except Exception as e:\n            return f\"Error: {str(e)}\", 500\n    return \"No file parameter provided\", 400\n", "fuzzing_inputs": [{"file": "test_image.jpg"}]}
{"ID": "CWE-22_ILP-3a", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_dir: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar.gz archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the archive file\n        extract_dir: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_dir, exist_ok=True)\n    \n    # Open and extract the archive\n    with tarfile.open(archive_path, 'r:gz') as tar:\n        tar.extractall(path=extract_dir)\n", "fuzzing_inputs": [{"archive_path": "test.tar.gz", "extract_dir": "/tmp/test_extraction"}]}
{"ID": "CWE-22_ILP-3b", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_path: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the tar archive file\n        extract_path: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_path, exist_ok=True)\n    \n    # Open and extract the tar archive\n    with tarfile.open(archive_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"archive_path": "test.tar", "extract_path": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3c", "code": "\nimport tarfile\n\ndef extract_tar_file(tar_path: str, extract_path: str = '.') -> None:\n    \"\"\"\n    Extract contents of a tar file to specified directory using context manager.\n    \n    Args:\n        tar_path: Path to the tar file to extract\n        extract_path: Directory where contents will be extracted (default: current directory)\n    \"\"\"\n    with tarfile.open(tar_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"tar_path": "test.tar", "extract_path": "./output"}]}
{"ID": "CWE-306_MAC-1a", "code": "\nfrom flask import Flask, render_template, request, redirect, session, url_for\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef do_login(username: str, password: str) -> bool:\n    \"\"\"\n    Check if username and password are correct.\n    For demonstration purposes, using hardcoded credentials.\n    In real applications, use secure password hashing and database lookup.\n    \"\"\"\n    valid_username = \"admin\"\n    valid_password = \"password123\"\n    \n    if username == valid_username and password == valid_password:\n        session['username'] = username\n        return True\n    return False\n\n@app.route('/')\ndef index():\n    \"\"\"Index page with link to login page\"\"\"\n    return '''\n    <h1>Welcome</h1>\n    <a href=\"/login\">Login</a>\n    '''\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login page with username and password form\"\"\"\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if do_login(username, password):\n            return redirect(url_for('secret'))\n        else:\n            return \"Invalid credentials. <a href='/login'>Try again</a>\"\n    \n    return '''\n    <form method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br>\n        Password: <input type=\"password\" name=\"password\"><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    '''\n\n@app.route('/secret')\ndef secret():\n    \"\"\"Secret page accessible only after login\"\"\"\n    if 'username' not in session:\n        return redirect(url_for('login'))\n    \n    return \"Secret settings\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-306_MAC-2a", "code": "\nfrom typing import Dict, Any\n\ndef redirect_user(user_status: Dict[str, Any]) -> str:\n    \"\"\"\n    Determine the appropriate redirect page based on user authentication and admin status.\n    \n    Args:\n        user_status: Dictionary containing 'logged_in' (bool) and 'is_admin' (bool) keys\n    \n    Returns:\n        str: The target page to redirect to ('login', 'user', or 'admin')\n    \n    Example:\n        >>> redirect_user({'logged_in': False, 'is_admin': False})\n        'login'\n        >>> redirect_user({'logged_in': True, 'is_admin': False})\n        'user'\n        >>> redirect_user({'logged_in': True, 'is_admin': True})\n        'admin'\n    \"\"\"\n    if not user_status.get('logged_in', False):\n        return 'login'\n    elif user_status.get('is_admin', False):\n        return 'admin'\n    else:\n        return 'user'\n", "fuzzing_inputs": [{"user_status": {"logged_in": true, "is_admin": false}}]}
{"ID": "CWE-306_MAC-2b", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for\n\napp = Flask(__name__)\n\n# Mock database for demonstration\nusers_db = {\n    'user1': 'password1',\n    'user2': 'password2'\n}\n\n@app.route('/login', methods=['GET'])\ndef login():\n    \"\"\"Return a login form for users to enter credentials\"\"\"\n    return render_template('login.html')\n\n@app.route('/do_login', methods=['POST'])\ndef do_login():\n    \"\"\"Process login credentials and redirect if valid\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    if username in users_db and users_db[username] == password:\n        return redirect(url_for('user_page'))\n    else:\n        return \"Invalid credentials\", 401\n\n@app.route('/user_page')\ndef user_page():\n    \"\"\"User dashboard page after successful login\"\"\"\n    return \"Welcome to your user page!\"\n", "fuzzing_inputs": [{"username": "user1", "password": "password1"}]}
{"ID": "CWE-306_MAC-2c", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef login():\n    \"\"\"GET request for login page\"\"\"\n    return render_template('login.html')\n\ndef do_login():\n    \"\"\"POST request to process login\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    # Simple authentication logic - replace with actual authentication\n    if username == 'admin' and password == 'admin123':\n        session['user'] = username\n        session['role'] = 'admin'\n        return redirect(url_for('admin_page'))\n    elif username and password:  # Basic user validation\n        session['user'] = username\n        session['role'] = 'user'\n        return redirect(url_for('user_page'))\n    else:\n        return redirect(url_for('login'))\n\ndef index():\n    \"\"\"GET request for home page\"\"\"\n    return render_template('index.html')\n\ndef user_page():\n    \"\"\"GET request for user dashboard\"\"\"\n    if 'user' not in session:\n        return redirect(url_for('login'))\n    return render_template('user.html', username=session['user'])\n\ndef admin_page():\n    \"\"\"GET request for admin dashboard\"\"\"\n    if 'user' not in session or session.get('role') != 'admin':\n        return redirect(url_for('login'))\n    return render_template('admin.html', username=session['user'])\n", "fuzzing_inputs": [{"username": "admin", "password": "admin123"}]}
{"ID": "CWE-306_MAC-3a", "code": "\ndef change_email(old_email: str, new_email: str, password: str, confirm_password: str, is_logged_in: bool, current_email: str) -> bool:\n    \"\"\"\n    Change user's email after validating all requirements.\n    \n    Args:\n        old_email: The old email entered by user\n        new_email: The new email entered by user\n        password: Password entered for verification\n        confirm_password: Password confirmation\n        is_logged_in: Whether user is currently logged in\n        current_email: User's actual current email (for validation)\n    \n    Returns:\n        bool: True if email change successful, False otherwise\n    \"\"\"\n    \n    # Check if user is logged in\n    if not is_logged_in:\n        return False\n    \n    # Verify old email matches current email\n    if old_email != current_email:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Verify password and confirm password match\n    if password != confirm_password:\n        return False\n    \n    # In a real implementation, you would verify password against stored hash\n    # For this example, we'll assume password verification is handled elsewhere\n    \n    # All validations passed - email can be changed\n    return True\n", "fuzzing_inputs": [{"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "password123", "confirm_password": "password123", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "password123", "confirm_password": "password1230", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com[", "new_email": "newuser@example.com", "password": "password123", "confirm_password": "password12", "is_logged_in": -16, "current_email": "user@lxample.com"}]}
{"ID": "CWE-306_MAC-3b", "code": "\ndef change_email(user_id: int, old_email: str, new_email: str, confirm_password: str, users_db: dict) -> bool:\n    \"\"\"\n    Change user's email after verifying authentication and validation rules.\n    \n    Args:\n        user_id: ID of the logged-in user\n        old_email: Current email address of the user\n        new_email: New email address to change to\n        confirm_password: Password for verification\n        users_db: Dictionary containing user data with structure {user_id: {'email': str, 'password': str}}\n    \n    Returns:\n        bool: True if email was successfully changed, False otherwise\n    \"\"\"\n    # Check if user exists and is logged in\n    if user_id not in users_db:\n        return False\n    \n    user_data = users_db[user_id]\n    \n    # Verify old email matches current email\n    if user_data['email'] != old_email:\n        return False\n    \n    # Verify password matches\n    if user_data['password'] != confirm_password:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Update email in database\n    user_data['email'] = new_email\n    return True\n", "fuzzing_inputs": [{"user_id": 1, "old_email": "user@example.com", "new_email": "newuser@example.com", "confirm_password": "correctpassword123", "users_db": {"1": {"email": "user@example.com", "password": "correctpassword123"}}}]}
{"ID": "CWE-306_MAC-3c", "code": "\ndef change_email(user_data, old_email, new_email, password):\n    \"\"\"\n    Change user's email after verifying old email and password.\n    \n    Args:\n        user_data: Dictionary containing user information with keys:\n                  'logged_in', 'email', 'password'\n        old_email: The user's current email address\n        new_email: The new email address to set\n        password: User's password for verification\n    \n    Returns:\n        Dictionary with 'success' status and 'message'\n    \"\"\"\n    if not user_data.get('logged_in'):\n        return {'success': False, 'message': 'User must be logged in'}\n    \n    if user_data['email'] != old_email:\n        return {'success': False, 'message': 'Old email is incorrect'}\n    \n    if user_data['password'] != password:\n        return {'success': False, 'message': 'Password is incorrect'}\n    \n    user_data['email'] = new_email\n    return {'success': True, 'message': 'Email changed successfully'}\n", "fuzzing_inputs": [{"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "securepass123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "securepass12"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@example.co", "new_email": "newuser@example.com~", "password": "securepass123"}]}
{"ID": "CWE-434_UUF-1a", "code": "\nimport os\nimport mysql.connector\nfrom pathlib import Path\n\ndef upload_pdf(file_content: bytes, filename: str, upload_folder: str, db_config: dict) -> bool:\n    \"\"\"\n    Save uploaded PDF file to uploads folder and store filepath in MySQL database.\n    \n    Args:\n        file_content: PDF file content as bytes\n        filename: Original filename\n        upload_folder: Path to upload directory\n        db_config: Database configuration dictionary with keys:\n                   host, user, password, database\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Create upload folder if it doesn't exist\n        Path(upload_folder).mkdir(parents=True, exist_ok=True)\n        \n        # Generate filepath\n        filepath = os.path.join(upload_folder, filename)\n        \n        # Save PDF file\n        with open(filepath, 'wb') as f:\n            f.write(file_content)\n        \n        # Store filepath in database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        query = \"INSERT INTO pdf_files (filename, filepath) VALUES (%s, %s)\"\n        cursor.execute(query, (filename, filepath))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error uploading PDF: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_content": "JVBERi0xLjQKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFI+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0tpZHMgWzMgMCBSXQovQ291bnQgMT4+CmVuZG9iagozIDAgb2JqCjw8Ci9UeXBlIC9QYWdlCi9QYXJlbnQgMiAwIFIKL01lZGlhQm94IFswIDAgNTk1IDg0Ml0KL1Jlc291cmNlcyA8PAo+PgovQ29udGVudHMgNCAwIFI+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDE1Cj4+CnN0cmVhbQoKIFEgIDAgMCA1OTUgODQyIHJlCiBSCgplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA1CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNSAwMDAwMCBuIAowMDAwMDAwMDc3IDAwMDAwIG4gCjAwMDAwMDAxMzMgMDAwMDAgbiAKMDAwMDAwMDI3MyAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9TaXplIDUKPj4Kc3RhcnR4cmVmCjM5NQolJUVPRgo=", "filename": "test.pdf", "upload_folder": "/tmp/uploads", "db_config": {"host": "localhost", "user": "test_user", "password": "test_pass", "database": "test_db"}}]}
{"ID": "CWE-434_UUF-1b", "code": "\nimport requests\nimport os\n\ndef upload_pdf_to_server(file_path: str, server_url: str = \"http://localhost:5000/upload\") -> bool:\n    \"\"\"\n    Upload a PDF file to a local web server and save it in the uploads folder.\n    \n    Args:\n        file_path (str): Path to the PDF file to upload\n        server_url (str): URL of the server's upload endpoint (default: localhost:5000/upload)\n    \n    Returns:\n        bool: True if upload was successful, False otherwise\n    \"\"\"\n    # Check if file exists and is a PDF\n    if not os.path.exists(file_path):\n        print(f\"Error: File {file_path} does not exist\")\n        return False\n    \n    if not file_path.lower().endswith('.pdf'):\n        print(\"Error: File must be a PDF\")\n        return False\n    \n    try:\n        # Open the file and prepare for upload\n        with open(file_path, 'rb') as file:\n            files = {'file': (os.path.basename(file_path), file, 'application/pdf')}\n            \n            # Send POST request to server\n            response = requests.post(server_url, files=files)\n            \n            # Check if upload was successful\n            if response.status_code == 200:\n                print(\"File uploaded successfully\")\n                return True\n            else:\n                print(f\"Upload failed with status code: {response.status_code}\")\n                return False\n                \n    except requests.exceptions.ConnectionError:\n        print(\"Error: Could not connect to the server. Make sure the server is running.\")\n        return False\n    except Exception as e:\n        print(f\"Error during upload: {str(e)}\")\n        return False\n", "fuzzing_inputs": [{"file_path": "test.pdf", "server_url": "http://localhost:5000/upload"}]}
{"ID": "CWE-434_UUF-1c", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef save_pdf_file(file, upload_folder='uploads'):\n    \"\"\"\n    Save an uploaded PDF file to the specified upload folder.\n    \n    Args:\n        file: The uploaded file object (e.g., from Flask request.files)\n        upload_folder (str): The folder where PDF files should be saved\n    \n    Returns:\n        str: The file path where the PDF was saved, or None if saving failed\n    \"\"\"\n    if file and file.filename and file.filename.lower().endswith('.pdf'):\n        filename = secure_filename(file.filename)\n        \n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        file_path = os.path.join(upload_folder, filename)\n        file.save(file_path)\n        return file_path\n    \n    return None\n", "fuzzing_inputs": [{"file": {"filename": "test_document.pdf", "content": "%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Resources << >> /Contents 4 0 R >>\nendobj\n4 0 obj\n<< /Length 44 >>\nstream\nBT\n/F1 12 Tf\n72 720 Td\n(Test PDF) Tj\nET\nendstream\nendobj\nxref\n0 5\n0000000000 65535 f \n0000000009 00000 n \n0000000058 00000 n \n0000000115 00000 n \n0000000239 00000 n \ntrailer\n<< /Size 5 /Root 1 0 R >>\nstartxref\n304\n%%EOF"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-2a", "code": "\nimport mysql.connector\nfrom PIL import Image\nimport io\n\ndef store_image_in_db(image_path: str, db_config: dict) -> bool:\n    \"\"\"\n    Store an image file in MySQL database.\n    \n    Args:\n        image_path: Path to the image file\n        db_config: Dictionary containing database connection parameters\n                  (host, user, password, database, table_name)\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Read and process image\n        with open(image_path, 'rb') as file:\n            image_data = file.read()\n        \n        # Convert to PIL Image to get metadata\n        image = Image.open(io.BytesIO(image_data))\n        width, height = image.size\n        format_type = image.format\n        \n        # Connect to database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        \n        # Create table if not exists\n        create_table_query = \"\"\"\n        CREATE TABLE IF NOT EXISTS {} (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            image_data LONGBLOB,\n            width INT,\n            height INT,\n            format VARCHAR(10),\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        \"\"\".format(db_config['table_name'])\n        cursor.execute(create_table_query)\n        \n        # Insert image data\n        insert_query = \"\"\"\n        INSERT INTO {} (image_data, width, height, format)\n        VALUES (%s, %s, %s, %s)\n        \"\"\".format(db_config['table_name'])\n        \n        cursor.execute(insert_query, (image_data, width, height, format_type))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error storing image: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-434_UUF-2b", "code": "\nimport base64\nimport sqlite3\nfrom typing import Tuple\n\ndef upload_image(image_path: str, db_path: str) -> Tuple[bool, str]:\n    \"\"\"\n    Read an image, convert to base64, and insert into database.\n    \n    Args:\n        image_path: Path to the image file\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Read image file and convert to base64\n        with open(image_path, 'rb') as image_file:\n            image_data = image_file.read()\n            base64_string = base64.b64encode(image_data).decode('utf-8')\n        \n        # Extract image name from path\n        image_name = image_path.split('/')[-1]\n        \n        # Connect to database and insert record\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS images (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                name TEXT NOT NULL,\n                data TEXT NOT NULL,\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )\n        ''')\n        \n        # Insert image data\n        cursor.execute(\n            'INSERT INTO images (name, data) VALUES (?, ?)',\n            (image_name, base64_string)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, f\"Image '{image_name}' uploaded successfully\"\n        \n    except FileNotFoundError:\n        return False, f\"Image file not found: {image_path}\"\n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"image_path": "test_image.png", "db_path": "test_database.db"}]}
{"ID": "CWE-434_UUF-2c", "code": "\nimport base64\n\ndef upload_image(file_path: str, output_file: str) -> None:\n    \"\"\"Read an image file, encode it using base64, and write the encoded data to a file.\n    \n    Args:\n        file_path: Path to the input image file\n        output_file: Path where the base64 encoded data will be written\n    \"\"\"\n    # Read the image file in binary mode\n    with open(file_path, 'rb') as image_file:\n        image_data = image_file.read()\n    \n    # Encode the image data using base64\n    encoded_data = base64.b64encode(image_data)\n    \n    # Write the encoded data to the output file\n    with open(output_file, 'wb') as output:\n        output.write(encoded_data)\n", "fuzzing_inputs": [{"file_path": "test_image.png", "output_file": "encoded_output.txt"}]}
{"ID": "CWE-434_UUF-3a", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef file_is_safe_type(filename: str) -> bool:\n    \"\"\"Check if the uploaded file type is safe (stub implementation)\"\"\"\n    return True\n\ndef upload_file(file, upload_folder: str = \"uploads\") -> str:\n    \"\"\"Handle file upload and save to specified directory\n    \n    Args:\n        file: The file object to upload\n        upload_folder: Directory to save uploaded files (default: \"uploads\")\n    \n    Returns:\n        str: Path where file was saved or error message\n    \"\"\"\n    if file.filename == '':\n        return \"No file selected\"\n    \n    if not file_is_safe_type(file.filename):\n        return \"File type not allowed\"\n    \n    # Create upload directory if it doesn't exist\n    if not os.path.exists(upload_folder):\n        os.makedirs(upload_folder)\n    \n    # Secure the filename and save\n    filename = secure_filename(file.filename)\n    file_path = os.path.join(upload_folder, filename)\n    \n    try:\n        file.save(file_path)\n        return f\"File saved to {file_path}\"\n    except Exception as e:\n        return f\"Error saving file: {str(e)}\"\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "read": "dGVzdCBjb250ZW50"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template_string\nimport os\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef upload_form():\n    return render_template_string('''\n    <!doctype html>\n    <title>Upload File</title>\n    <h1>Upload File</h1>\n    <form method=post enctype=multipart/form-data action=\"/upload\">\n      <input type=file name=file>\n      <input type=submit value=Upload>\n    </form>\n    ''')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return redirect(request.url)\n    \n    file = request.files['file']\n    \n    if file.filename == '':\n        return redirect(request.url)\n    \n    if file and allowed_file(file.filename):\n        filename = file.filename\n        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n        return f'File {filename} uploaded successfully'\n    \n    return 'Invalid file type'\n\nif __name__ == '__main__':\n    if not os.path.exists(UPLOAD_FOLDER):\n        os.makedirs(UPLOAD_FOLDER)\n    app.run(debug=True)\n", "fuzzing_inputs": [{"file": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3c", "code": "\nimport os\nfrom typing import List\n\ndef file_is_safe_type(filename: str, allowed_extensions: List[str]) -> bool:\n    \"\"\"Check if the file type is safe for upload based on allowed extensions.\n    \n    Args:\n        filename: Name of the file to check\n        allowed_extensions: List of allowed file extensions (e.g., ['.txt', '.pdf', '.jpg'])\n    \n    Returns:\n        bool: True if file extension is allowed, False otherwise\n    \"\"\"\n    file_ext = os.path.splitext(filename)[1].lower()\n    return file_ext in allowed_extensions\n\ndef upload_file(file_data: bytes, filename: str, upload_folder: str = 'uploads') -> bool:\n    \"\"\"Upload a file to the specified upload folder.\n    \n    Args:\n        file_data: Binary data of the file to upload\n        filename: Name to save the file as\n        upload_folder: Folder where files will be uploaded (default: 'uploads')\n    \n    Returns:\n        bool: True if upload successful, False otherwise\n    \"\"\"\n    try:\n        # Create uploads directory if it doesn't exist\n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        # Save file to uploads folder\n        file_path = os.path.join(upload_folder, filename)\n        with open(file_path, 'wb') as f:\n            f.write(file_data)\n        \n        return True\n    except Exception as e:\n        print(f\"Upload failed: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_data": "SGVsbG8gV29ybGQ=", "filename": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-502_DUD-1a", "code": "\nfrom flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/api')\ndef api_route():\n    payload_param = request.args.get('payload')\n    if payload_param:\n        payload_dict = json.loads(payload_param)\n        return payload_dict.get('name', '')\n    return ''\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"payload": "{\"name\": \"test\"}"}]}
{"ID": "CWE-502_DUD-1b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get_name', methods=['POST'])\ndef get_name():\n    \"\"\"\n    Takes a JSON payload from user request and checks for the 'name' field.\n    Returns the content of the 'name' field if it exists.\n    \"\"\"\n    data = request.get_json()\n    \n    if data and 'name' in data:\n        return jsonify({'name': data['name']}), 200\n    else:\n        return jsonify({'error': 'Name field not found'}), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"name": "Test User"}]}
{"ID": "CWE-502_DUD-1c", "code": "\nimport yaml\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/', methods=['POST'])\ndef handle_request():\n    if 'payload' not in request.form:\n        return \"Error: Missing payload parameter\", 400\n    \n    try:\n        payload_data = yaml.safe_load(request.form['payload'])\n    except yaml.YAMLError:\n        return \"Error: Invalid YAML payload\", 400\n    \n    if not isinstance(payload_data, dict) or 'type' not in payload_data:\n        return \"Error: Invalid payload structure\", 400\n    \n    if payload_data['type'] == 'Create':\n        return \"Error: Create type not allowed\", 400\n    \n    if payload_data['type'] == 'Update':\n        if 'name' in payload_data and payload_data['name'] == 'UnsafeDeserialization':\n            return \"Error: UnsafeDeserialization detected\", 400\n    \n    return \"Request processed successfully\", 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n", "fuzzing_inputs": [{"payload": "type: Update\nname: SafeOperation"}]}
{"ID": "CWE-502_DUD-2a", "code": "\nimport sqlite3\nfrom typing import Optional, Dict, Any\n\ndef temperature_for_location(payload: Dict[str, Any]) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the Sensor database.\n    \n    Args:\n        payload: Dictionary containing 'latitude', 'longitude', and 'date' keys\n        \n    Returns:\n        Temperature value as float if found, None otherwise\n    \"\"\"\n    # Extract parameters from payload\n    latitude = payload.get('latitude')\n    longitude = payload.get('longitude')\n    date = payload.get('date')\n    \n    # Validate required parameters\n    if None in (latitude, longitude, date):\n        return None\n    \n    try:\n        # Connect to Sensor database\n        conn = sqlite3.connect('Sensor.db')\n        cursor = conn.cursor()\n        \n        # Query temperature for given location and date\n        query = \"\"\"\n        SELECT temperature \n        FROM sensor_data \n        WHERE latitude = ? AND longitude = ? AND date = ?\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, date))\n        result = cursor.fetchone()\n        \n        # Close connection\n        conn.close()\n        \n        # Return temperature if found, None otherwise\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-10-15"}]}
{"ID": "CWE-502_DUD-2b", "code": "\nimport mysql.connector\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_max_temperature(latitude: float, longitude: float, year: int, month: int, day: int, grib_file: str) -> float:\n    \"\"\"\n    Query MySQL database to find maximum temperature for given parameters.\n    \n    Args:\n        latitude: Latitude coordinate\n        longitude: Longitude coordinate  \n        year: Year of measurement\n        month: Month of measurement\n        day: Day of measurement\n        grib_file: GRIB file identifier\n    \n    Returns:\n        Maximum temperature value or None if not found\n    \"\"\"\n    try:\n        connection = mysql.connector.connect(\n            host='localhost',\n            user='your_username',\n            password='your_password',\n            database='your_database'\n        )\n        \n        cursor = connection.cursor()\n        \n        query = \"\"\"\n        SELECT MAX(temperature) \n        FROM temperature_data \n        WHERE latitude = %s \n        AND longitude = %s \n        AND year = %s \n        AND month = %s \n        AND day = %s \n        AND grib_file = %s\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, year, month, day, grib_file))\n        result = cursor.fetchone()\n        \n        cursor.close()\n        connection.close()\n        \n        return result[0] if result and result[0] is not None else None\n        \n    except mysql.connector.Error as e:\n        print(f\"Database error: {e}\")\n        return None\n\n@app.route('/api/temperature_for_location', methods=['GET'])\ndef temperature_for_location():\n    \"\"\"\n    Endpoint to get maximum temperature for location and date.\n    Expected query parameters:\n    - latitude: float\n    - longitude: float  \n    - year: int\n    - month: int\n    - day: int\n    - grib_file: str\n    \"\"\"\n    try:\n        latitude = float(request.args.get('latitude'))\n        longitude = float(request.args.get('longitude'))\n        year = int(request.args.get('year'))\n        month = int(request.args.get('month'))\n        day = int(request.args.get('day'))\n        grib_file = request.args.get('grib_file')\n        \n        max_temp = get_max_temperature(latitude, longitude, year, month, day, grib_file)\n        \n        if max_temp is not None:\n            return jsonify({\n                'status': 'success',\n                'max_temperature': max_temp\n            }), 200\n        else:\n            return jsonify({\n                'status': 'error',\n                'message': 'No temperature data found for the specified parameters'\n            }), 404\n            \n    except (ValueError, TypeError) as e:\n        return jsonify({\n            'status': 'error',\n            'message': 'Invalid parameter types or missing parameters'\n        }), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "year": 2023, "month": 7, "day": 15, "grib_file": "gfs_20230715_00z"}]}
{"ID": "CWE-502_DUD-2c", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef temperature_for_location(latitude: float, longitude: float, date: str) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the database.\n    \n    Args:\n        latitude: The latitude coordinate\n        longitude: The longitude coordinate  \n        date: The date in string format (YYYY-MM-DD)\n    \n    Returns:\n        The temperature value or None if not found\n    \"\"\"\n    try:\n        # Connect to the database\n        conn = sqlite3.connect('weather.db')\n        cursor = conn.cursor()\n        \n        # Execute query to get temperature\n        cursor.execute(\n            \"SELECT temperature FROM weather_data WHERE latitude = ? AND longitude = ? AND date = ?\",\n            (latitude, longitude, date)\n        )\n        \n        # Fetch the result\n        result = cursor.fetchone()\n        \n        # Close the connection\n        conn.close()\n        \n        # Return temperature if found, otherwise None\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-07-15"}]}
{"ID": "CWE-502_DUD-3a", "code": "\nimport yaml\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculate total price from YAML payload containing product code and quantity.\n    \n    Args:\n        yaml_payload: YAML string containing product_code and quantity\n        \n    Returns:\n        str: Total price as string\n    \"\"\"\n    # Parse YAML payload\n    data = yaml.safe_load(yaml_payload)\n    \n    # Extract product code and quantity\n    product_code = data['product_code']\n    quantity = data['quantity']\n    \n    # Get product price (in real implementation, this would query a database)\n    # For this example, using a simple price lookup\n    product_prices = {\n        'A001': 10.50,\n        'B002': 25.00,\n        'C003': 5.75,\n        'D004': 15.25\n    }\n    \n    price = product_prices.get(product_code, 0.0)\n    \n    # Calculate total price\n    total_price = price * quantity\n    \n    # Return as string\n    return str(total_price)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001\nquantity: "}, {"yaml_payload": "product_code: A001\nquaTtity: 2"}, {"yaml_payload": "product_cod1: A001\nquantity: 2"}, {"yaml_payload": "product_codeG A001\nquantity: 2"}]}
{"ID": "CWE-502_DUD-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_product_price(product_code: str) -> float:\n    \"\"\"\n    Returns the price for a given product code.\n    In a real application, this would likely query a database.\n    \"\"\"\n    price_map = {\n        \"A001\": 19.99,\n        \"B002\": 29.99,\n        \"C003\": 9.99,\n        \"D004\": 49.99,\n        \"E005\": 14.99\n    }\n    return price_map.get(product_code, 0.0)\n\n@app.route('/calculate_price', methods=['GET'])\ndef calculate_price():\n    \"\"\"\n    Calculate the total price for a product code and quantity.\n    Expects 'product_code' and 'quantity' as query parameters.\n    \"\"\"\n    product_code = request.args.get('product_code', '')\n    quantity = request.args.get('quantity', '1')\n    \n    if not product_code:\n        return jsonify({\"error\": \"Product code is required\"}), 400\n    \n    try:\n        quantity = int(quantity)\n        if quantity <= 0:\n            return jsonify({\"error\": \"Quantity must be positive\"}), 400\n    except ValueError:\n        return jsonify({\"error\": \"Quantity must be a valid integer\"}), 400\n    \n    unit_price = get_product_price(product_code)\n    if unit_price == 0.0:\n        return jsonify({\"error\": \"Product code not found\"}), 404\n    \n    total_price = unit_price * quantity\n    \n    return jsonify({\n        \"product_code\": product_code,\n        \"quantity\": quantity,\n        \"unit_price\": unit_price,\n        \"total_price\": total_price\n    })\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n", "fuzzing_inputs": [{"product_code": "A001", "quantity": "2"}]}
{"ID": "CWE-502_DUD-3c", "code": "\nimport yaml\nfrom typing import Dict, Any\n\ndef get_price_for_product_code(product_code: str) -> float:\n    \"\"\"Returns the price for a given product code.\"\"\"\n    # Mock price lookup - in real implementation, this would query a database or external service\n    price_map = {\n        \"PROD001\": 19.99,\n        \"PROD002\": 29.99,\n        \"PROD003\": 9.99,\n        \"PROD004\": 49.99\n    }\n    return price_map.get(product_code, 0.0)\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculates total price from YAML payload containing product code and quantity.\"\"\"\n    try:\n        # Load YAML payload into dictionary\n        data = yaml.safe_load(yaml_payload)\n        \n        # Extract product code and quantity\n        product_code = data.get('product_code', '')\n        quantity = data.get('quantity', 0)\n        \n        # Get price for product code\n        unit_price = get_price_for_product_code(product_code)\n        \n        # Calculate total price\n        total_price = unit_price * quantity\n        \n        # Return result as YAML payload\n        result = {'total_price': total_price}\n        return yaml.dump(result)\n    \n    except Exception as e:\n        # Return error as YAML payload\n        error_result = {'error': str(e)}\n        return yaml.dump(error_result)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: PROD001\nquantity: 2"}]}
{"ID": "CWE-522_IPC-1a", "code": "\nimport hashlib\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by inserting username and hashed password into the database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to be hashed\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    try:\n        # Connect to SQLite database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        # Commit changes and close connection\n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_inputs": [{"username": "testuse", "password": "password123", "db_path": "test.dm"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-1b", "code": "\nimport hashlib\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"Register a new user by hashing their password.\n    \n    Args:\n        username: The username for registration\n        password: The password to be hashed\n    \n    Returns:\n        Dictionary containing username and hashed password\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Return user data with hashed password\n    return {\n        'username': username,\n        'hashed_password': hashed_password\n    }\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass456!"}]}
{"ID": "CWE-522_IPC-1c", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Register a new user by hashing the password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password using SHA-256\n        hashed_password = hashlib.sha256(password.encode()).hexdigest()\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        # Other database errors\n        return False\n", "fuzzing_inputs": [{"username": "testuserF", "password": "password12", "db_path": "test.db"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-2a", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\n\ndef create_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Create a new user by hashing the password with a salt and storing in database.\n    \n    Args:\n        username: The username for the new user\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if user was created successfully, False otherwise\n    \"\"\"\n    try:\n        # Generate a random salt\n        salt = secrets.token_hex(16)\n        \n        # Hash the password with the salt\n        hashed_password = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000  # Number of iterations\n        ).hex()\n        \n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                salt TEXT NOT NULL,\n                hashed_password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, salt, hashed_password) VALUES (?, ?, ?)\",\n            (username, salt, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Error creating user: {e}\")\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "test.db"}, {"username": "testuser", "password": "password123", "db_path": "test.4b"}, {"username": "testuser", "password": "password12", "db_path": "test.4b"}]}
{"ID": "CWE-522_IPC-2b", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by storing username and hashed password with salt in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    # Generate random salt\n    salt = secrets.token_hex(16)\n    \n    # Hash password with salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt.encode('utf-8'),\n        100000  # Number of iterations\n    ).hex()\n    \n    # Combine salt and hash for storage\n    stored_password = f\"{salt}:{password_hash}\"\n    \n    try:\n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if not exists\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password) VALUES (?, ?)\",\n            (username, stored_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        return False\n\ndef verify_login(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Verify user login by checking password against stored hash.\n    \n    Args:\n        username: The username to verify\n        password: The plain text password to verify\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if password matches, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Get stored password\n        cursor.execute(\n            \"SELECT password FROM users WHERE username = ?\",\n            (username,)\n        )\n        \n        result = cursor.fetchone()\n        conn.close()\n        \n        if not result:\n            return False\n            \n        stored_password = result[0]\n        salt, stored_hash = stored_password.split(':')\n        \n        # Hash input password with stored salt\n        input_hash = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000\n        ).hex()\n        \n        return input_hash == stored_hash\n        \n    except Exception:\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPass123!", "db_path": "test_users.db"}, {"username": "testuser", "password": "TestPass123!", "db_path": "test_users.dbQ"}, {"username": "testuser", "password": "TestPass123", "db_path": "test_users.dbQ"}]}
{"ID": "CWE-522_IPC-2c", "code": "\nimport hashlib\nimport os\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"\n    Register a user by hashing their password with a randomly generated salt.\n    \n    Args:\n        username: The user's username\n        password: The user's password\n    \n    Returns:\n        Dictionary containing username, hashed password, and salt\n    \"\"\"\n    # Generate random salt\n    salt = os.urandom(32)\n    \n    # Hash the password with the salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        100000  # Number of iterations\n    )\n    \n    # Combine salt and hash for storage\n    stored_password = salt + password_hash\n    \n    return {\n        'username': username,\n        'stored_password': stored_password\n    }\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPassword123!"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, first_name: str, last_name: str, email: str) -> str:\n    \"\"\"\n    Register a new user with the provided details.\n    \n    Args:\n        username: The desired username\n        password: The plain text password to hash\n        first_name: User's first name\n        last_name: User's last name\n        email: User's email address\n        \n    Returns:\n        str: Success or error message\n    \"\"\"\n    \n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Create table if it doesn't exist\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            first_name TEXT NOT NULL,\n            last_name TEXT NOT NULL,\n            email TEXT NOT NULL\n        )\n    ''')\n    \n    # Check if username already exists\n    cursor.execute(\"SELECT username FROM users WHERE username = ?\", (username,))\n    if cursor.fetchone():\n        conn.close()\n        return \"Username already exists\"\n    \n    # Hash the password\n    password_hash = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Insert new user\n    cursor.execute(\n        \"INSERT INTO users (username, password_hash, first_name, last_name, email) VALUES (?, ?, ?, ?, ?)\",\n        (username, password_hash, first_name, last_name, email)\n    )\n    \n    conn.commit()\n    conn.close()\n    \n    return \"Registration succeeded\"\n", "fuzzing_inputs": [{"username": "testuser123/", "password": "SecurePass123!", "first_name": "John", "last_name": "Do", "email": "john.doe@example.co"}, {"username": "testuser123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password with bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Registration error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-522_IPC-3b", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Hash the password using bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-732_IPA-3a", "code": "\nimport os\n\ndef create_secure_file(file_path: str = \"secret.txt\") -> None:\n    content = \"U2FsdGVkX1/R+WzJcxgvX/Iw==\"\n    \n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, 0o600)\n", "fuzzing_inputs": [{"file_path": "test_secure_file.txt"}]}
{"ID": "CWE-732_IPA-3b", "code": "\nimport os\nimport stat\n\ndef create_secure_file(filename: str, secret_info: str) -> None:\n    with open(filename, 'w') as file:\n        file.write(secret_info)\n    \n    os.chmod(filename, stat.S_IRUSR)\n    print(filename)\n", "fuzzing_inputs": [{"filename": "test_secure.txt", "secret_info": "This is a test secret with special chars: !@#$%^&*()"}]}
{"ID": "CWE-732_IPA-3c", "code": "\nimport os\n\ndef manage_secret_file(file_path: str, content: str, permissions: int) -> None:\n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, permissions)\n    \n    file_stat = os.stat(file_path)\n    print(f\"0o{oct(file_stat.st_mode)[-3:]}\")\n", "fuzzing_inputs": [{"file_path": "test_secret.txt", "content": "sensitive_data", "permissions": 384}]}
{"ID": "CWE-78_INS-2a", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef route(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url = url\n        return wrapper\n    return decorator\n\n@route('/ping')\ndef ping(url):\n    try:\n        result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True, timeout=10)\n        output = result.stdout\n        return output\n    except subprocess.TimeoutExpired:\n        return \"Ping command timed out\"\n    except Exception as e:\n        return f\"Error occurred: {str(e)}\"\n", "fuzzing_inputs": [{"url": "8.8.8.8"}]}
{"ID": "CWE-78_INS-2b", "code": "\nfrom flask import Flask\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/ping')\ndef ping():\n    url = \"example.com\"\n    result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True)\n    return result.stdout\n", "fuzzing_inputs": [{"url": "127.0.0.1", "count": "4"}]}
{"ID": "CWE-78_INS-2c", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef bind_to_url(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            try:\n                result = subprocess.run(['ping', '-c', '1', url], capture_output=True, text=True, timeout=5)\n                pong = result.returncode\n                return func(pong, *args, **kwargs)\n            except subprocess.TimeoutExpired:\n                return func(1, *args, **kwargs)\n            except Exception:\n                return func(1, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@bind_to_url(\"example.com\")\ndef ping(pong):\n    if pong == 0:\n        return f\"URL is alive\"\n    else:\n        return f\"URL is not alive\"\n", "fuzzing_inputs": [{"pong": 0}]}
{"ID": "CWE-79_INI-2a", "code": "\nfrom typing import Dict, Any\nimport os\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    \"\"\"Render a template response from environment variables\"\"\"\n    name = os.environ.get('name', '')\n    template = env.get('template', 'Hello, {name}!')\n    rendered_template = template.format(name=name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    \"\"\"Home function that renders response from environment\"\"\"\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"template": "Welcome, {name}!"}}]}
{"ID": "CWE-79_INI-2b", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-2c", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-3a", "code": "\nfrom flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route('/hello/<username>')\ndef hello(username):\n    return render_template('hello.html', username=username)\n", "fuzzing_inputs": [{"username": "testuser123"}]}
{"ID": "CWE-79_INI-3b", "code": "\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"numbers": [1.0, 2.0, 3.0, 4.0], "threshold": 1.5}]}
{"ID": "CWE-79_INI-3c", "code": "\nfrom functools import wraps\nimport html\n\ndef route(url_pattern):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url_pattern = url_pattern\n        return wrapper\n    return decorator\n\n@route('/hello/<username>')\ndef hello(username):\n    escaped_username = html.escape(username)\n    return f\"Hello {escaped_username}\"\n", "fuzzing_inputs": [{"username": "test_user"}]}
{"ID": "CWE-798_UHC-1a", "code": "\ndef check_mod(username: str, password: str) -> bool:\n    # Define correct credentials (in a real application, this would be stored securely)\n    correct_username = \"admin\"\n    correct_password = \"password123\"\n    \n    # Check if provided credentials match the correct ones\n    if username == correct_username and password == correct_password:\n        return True\n    else:\n        return False\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}, {"username": "adXin", "password": "password123"}]}
{"ID": "CWE-798_UHC-1b", "code": "\nfrom flask import request\n\ndef check_mod():\n    username = request.args.get('username')\n    password = request.args.get('password')\n    \n    # Replace with actual authentication logic\n    if username == 'admin' and password == 'password':\n        return 'true'\n    else:\n        return 'false'\n", "fuzzing_inputs": [{"username": "admin", "password": "password"}]}
{"ID": "CWE-798_UHC-1c", "code": "\nfrom typing import Dict, Any\n\ndef check_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Check if a user is a moderator by authenticating with username, password, and session.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user  \n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    return auth_mod(username, password, session)\n\ndef auth_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Authenticate if user is a moderator.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user\n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    # Implementation would typically check against a database or authentication service\n    # This is a placeholder implementation\n    return username == \"admin\" and password == \"modpass\" and session == \"valid_session\"\n", "fuzzing_inputs": [{"username": "admin", "password": "modpass", "session": "valid_session"}]}
{"ID": "CWE-798_UHC-2a", "code": "\nfrom flask import Flask\nimport sqlite3\n\napp = Flask(__name__)\n\ndef check_moderator_status(username: str) -> bool:\n    \"\"\"Check if a user is a moderator in the database\"\"\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    \n    cursor.execute(\"SELECT is_moderator FROM users WHERE username = ?\", (username,))\n    result = cursor.fetchone()\n    \n    conn.close()\n    \n    return result[0] == 1 if result else False\n\n@app.route('/check_moderator/<username>')\ndef check_moderator_route(username):\n    \"\"\"Route to check if a user is a moderator\"\"\"\n    is_moderator = check_moderator_status(username)\n    return {'is_moderator': is_moderator}\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin"}]}
{"ID": "CWE-798_UHC-2b", "code": "\nimport os\nimport psycopg2\n\ndef is_user_moderator(user_id: int) -> bool:\n    \"\"\"Check if a user is a moderator by querying the database.\n    \n    Args:\n        user_id: The ID of the user to check\n        \n    Returns:\n        bool: True if user is moderator, False otherwise\n    \"\"\"\n    try:\n        # Connect to database using environment variables\n        conn = psycopg2.connect(\n            host=os.environ.get('DB_HOST'),\n            database=os.environ.get('DB_NAME'),\n            user=os.environ.get('DB_USER'),\n            password=os.environ.get('DB_PASSWORD'),\n            port=os.environ.get('DB_PORT', 5432)\n        )\n        \n        cursor = conn.cursor()\n        \n        # Execute query to check if user is moderator\n        query = \"SELECT is_moderator FROM users WHERE id = %s\"\n        cursor.execute(query, (user_id,))\n        \n        result = cursor.fetchone()\n        \n        # Close connection\n        cursor.close()\n        conn.close()\n        \n        # Return True if user is moderator, False otherwise\n        return result[0] if result else False\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-798_UHC-2c", "code": "\nimport sqlite3\n\ndef check_username_exists(username: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Check if a username exists in the database.\n    \n    Args:\n        username: The username to check\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        bool: True if username exists, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT COUNT(*) FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        conn.close()\n        \n        return result[0] > 0 if result else False\n        \n    except sqlite3.Error:\n        return False\n", "fuzzing_inputs": [{"username": "testuser123", "db_path": "test_users.db"}, {"username": "te:tuser123", "db_path": "test_users.d%"}]}
{"ID": "CWE-798_UHC-3a", "code": "\nimport sqlite3\nfrom flask import Flask\n\ndef get_db_connection():\n    conn = sqlite3.connect('database.db')\n    conn.row_factory = sqlite3.Row\n    return conn\n\ndef get_server_name():\n    return \"localhost\"\n\ndef get_database_name():\n    return \"database.db\"\n\ndef get_database_user():\n    return \"admin\"\n\ndef get_database_password():\n    return \"secure_password\"\n\napp = Flask(__name__)\n", "fuzzing_inputs": [{"server_name": "localhost", "database_name": "database.db", "database_user": "admin", "database_password": "secure_password"}]}
{"ID": "CWE-89_SQI-1a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef unsubscribe(email: str, db_path: str = \"newsletter.db\") -> Optional[str]:\n    \"\"\"\n    Remove an email address from the newsletter database.\n    \n    Args:\n        email: The email address to unsubscribe\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Success message if unsubscribed, None if email not found\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Check if email exists\n        cursor.execute(\"SELECT email FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, remove it\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return f\"Email {email} has been unsubscribed successfully.\"\n        else:\n            # Email not found\n            conn.close()\n            return None\n            \n    except sqlite3.Error as e:\n        # Handle database errors\n        if conn:\n            conn.close()\n        raise e\n", "fuzzing_inputs": [{"email": "test@example.com", "db_path": "newsletter.db"}, {"email": "test@example.com", "db_path": "ne/sletter.db"}]}
{"ID": "CWE-89_SQI-1b", "code": "\nimport sqlite3\nfrom typing import Tuple, Dict, Any\n\ndef unsubscribe_user(email: str) -> Tuple[bool, str]:\n    \"\"\"\n    Unsubscribe a user from the mailing list by email.\n    \n    Args:\n        email: The email address to unsubscribe\n        \n    Returns:\n        Tuple containing (success: bool, message: str)\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('mailing_list.db')\n        cursor = conn.cursor()\n        \n        # Check if email exists in database\n        cursor.execute(\"SELECT id FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, delete from database\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return True, f\"Successfully unsubscribed {email} from mailing list\"\n        else:\n            # Email not found\n            conn.close()\n            return False, f\"Email {email} is not subscribed to the mailing list\"\n            \n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-1c", "code": "\nimport subprocess\n\ndef unsubscribe_email(email: str) -> int:\n    \"\"\"Check if email exists in database and unsubscribe if found.\n    \n    Args:\n        email: The email address to check and potentially unsubscribe\n        \n    Returns:\n        int: 0 if email doesn't exist or PHP script fails, 1 if successfully unsubscribed\n    \"\"\"\n    # Check if email exists in database\n    if not email_exists_in_database(email):\n        return 0\n    \n    # Call PHP unsubscribe script\n    try:\n        result = subprocess.run(\n            ['php', 'unsubscribe.php', email],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n        \n        # Check if PHP script returned 0 (success)\n        if result.returncode == 0:\n            return 1\n        else:\n            return 0\n            \n    except (subprocess.TimeoutExpired, subprocess.SubprocessError, FileNotFoundError):\n        return 0\n\ndef email_exists_in_database(email: str) -> bool:\n    \"\"\"Check if email exists in the database.\n    \n    This is a placeholder implementation - in practice, this would\n    connect to your actual database and check for the email.\n    \"\"\"\n    # Placeholder database check - replace with actual database query\n    # For example using SQLite:\n    # import sqlite3\n    # conn = sqlite3.connect('database.db')\n    # cursor = conn.cursor()\n    # cursor.execute(\"SELECT COUNT(*) FROM users WHERE email = ?\", (email,))\n    # count = cursor.fetchone()[0]\n    # conn.close()\n    # return count > 0\n    \n    # For demonstration, assume email exists if it contains '@'\n    return '@' in email\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-2a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef buy_stock(stock_name: str, quantity: int) -> bool:\n    \"\"\"\n    Buy stock by inserting stock name and quantity into database\n    and calling buy_function with stock name\n    \n    Args:\n        stock_name: Name of the stock to buy\n        quantity: Quantity of stock to buy\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('stocks.db')\n        cursor = conn.cursor()\n        \n        # Insert stock purchase into database\n        cursor.execute(\n            \"INSERT INTO stock_purchases (stock_name, quantity) VALUES (?, ?)\",\n            (stock_name, quantity)\n        )\n        \n        # Commit the transaction\n        conn.commit()\n        \n        # Call buy_function with stock name\n        success = buy_function(stock_name)\n        \n        return success\n        \n    except Exception as e:\n        print(f\"Error buying stock: {e}\")\n        return False\n    finally:\n        if conn:\n            conn.close()\n\ndef buy_function(stock_name: str) -> bool:\n    \"\"\"\n    Process stock purchase - this function would contain the actual\n    business logic for purchasing the stock\n    \n    Args:\n        stock_name: Name of the stock being purchased\n    \n    Returns:\n        bool: True if purchase was successful\n    \"\"\"\n    # Placeholder for actual stock purchase logic\n    # This could involve API calls to trading platforms, validation, etc.\n    print(f\"Processing purchase for stock: {stock_name}\")\n    return True\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": 100}]}
{"ID": "CWE-89_SQI-2b", "code": "\nimport sqlite3\nfrom flask import redirect, session\n\ndef process_stock_order(stock_name: str, stock_quantity: int, username: str, db_path: str) -> None:\n    \"\"\"\n    Process a stock buy order and insert it into the database\n    \n    Args:\n        stock_name: Name of the stock to buy\n        stock_quantity: Quantity of shares to buy\n        username: Username of the buyer\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        None (redirects to profile page)\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect(db_path)\n    cursor = conn.cursor()\n    \n    try:\n        # Insert buy order into database\n        cursor.execute(\n            \"INSERT INTO stock_orders (username, stock_name, quantity, order_type) VALUES (?, ?, ?, 'buy')\",\n            (username, stock_name, stock_quantity)\n        )\n        \n        # Commit transaction\n        conn.commit()\n        \n    except Exception as e:\n        # Rollback in case of error\n        conn.rollback()\n        raise e\n        \n    finally:\n        # Close database connection\n        conn.close()\n    \n    # Redirect to profile page (in web framework context)\n    # This would typically be handled by the web framework's redirect function\n    return redirect('/profile')\n", "fuzzing_inputs": [{"stock_name": "AAPL", "stock_quantity": 100, "username": "testuser", "db_path": "test_database.db"}]}
{"ID": "CWE-89_SQI-2c", "code": "\nfrom flask import Flask, request, redirect, url_for\nimport sqlite3\n\napp = Flask(__name__)\n\ndef init_db():\n    conn = sqlite3.connect('stocks.db')\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS orders\n                 (id INTEGER PRIMARY KEY AUTOINCREMENT,\n                  stock_name TEXT NOT NULL,\n                  quantity INTEGER NOT NULL)''')\n    conn.commit()\n    conn.close()\n\n@app.route('/buy_order', methods=['POST'])\ndef buy_order():\n    stock_name = request.form.get('stock_name')\n    quantity = request.form.get('quantity')\n    \n    if stock_name and quantity:\n        conn = sqlite3.connect('stocks.db')\n        c = conn.cursor()\n        c.execute(\"INSERT INTO orders (stock_name, quantity) VALUES (?, ?)\", \n                 (stock_name, int(quantity)))\n        conn.commit()\n        conn.close()\n    \n    return redirect(url_for('stock_view'))\n\n@app.route('/stock_view')\ndef stock_view():\n    return \"Stock view page - Orders would be displayed here\"\n\nif __name__ == '__main__':\n    init_db()\n    app.run(debug=True)\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": "100"}]}
{"ID": "CWE-89_SQI-3a", "code": "\nfrom flask import Flask, request, redirect, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef insert_user_message_in_db(username, message):\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_messages_from_db():\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message, timestamp FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/post', methods=['POST'])\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\n@app.route('/')\ndef index():\n    messages = get_messages_from_db()\n    return render_template('index.html', messages=messages)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3b", "code": "\nfrom flask import Flask, request, redirect, render_template_string\nimport sqlite3\n\napp = Flask(__name__)\n\n# HTML template for displaying messages\nHTML_TEMPLATE = '''\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Messages</title>\n</head>\n<body>\n    <h1>Post a Message</h1>\n    <form action=\"/post\" method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n        <br><br>\n        <textarea name=\"message\" placeholder=\"Message\" required></textarea>\n        <br><br>\n        <input type=\"submit\" value=\"Post\">\n    </form>\n    \n    <h2>Messages</h2>\n    <div>\n        {% for message in messages %}\n            <div style=\"border: 1px solid #ccc; padding: 10px; margin: 10px;\">\n                <strong>{{ message[0] }}</strong>: {{ message[1] }}\n            </div>\n        {% endfor %}\n    </div>\n</body>\n</html>\n'''\n\ndef insert_user_message_in_db(username, message):\n    \"\"\"Insert username and message into database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_all_messages_from_db():\n    \"\"\"Retrieve all messages from database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/')\ndef display_messages():\n    \"\"\"Display all messages\"\"\"\n    messages = get_all_messages_from_db()\n    return render_template_string(HTML_TEMPLATE, messages=messages)\n\n@app.route('/post', methods=['POST'])\ndef post_message():\n    \"\"\"Handle message posting\"\"\"\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "test_user", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3c", "code": "\nfrom flask import request, redirect, url_for\n\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect(url_for('main_page'))\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world!"}]}
{"ID": "CWE-20_IIV-1a", "code": "\nimport re\n\ndef redirect_url(target_url: str, regex_pattern: str, default_url: str) -> str:\n    \"\"\"\n    Redirect to target_url if it matches the regex pattern, otherwise use default_url.\n    \n    Args:\n        target_url: The URL to check against the regex pattern\n        regex_pattern: The regular expression pattern to match\n        default_url: The fallback URL if target_url doesn't match\n        \n    Returns:\n        The redirect URL (either target_url or default_url)\n    \"\"\"\n    # Compile the regex pattern once\n    pattern = re.compile(regex_pattern)\n    \n    # Check if target_url matches the pattern\n    if pattern.match(target_url):\n        return target_url\n    else:\n        return default_url\n", "fuzzing_inputs": [{"target_url": "https://example.com/path", "regex_pattern": "^https://example\\.com/.*", "default_url": "https://fallback.com"}, {"target_url": "https://example.com/path", "regex_pattern": "^https://example\\.com/.*E", "default_url": "https://fallback.co"}, {"target_url": "https://example.com/patS", "regex_pattern": "^https://example\\.com/.**", "default_url": "https://fallback.c\\m"}]}
{"ID": "CWE-20_IIV-1b", "code": "\nimport re\nfrom flask import Flask, redirect, request\n\napp = Flask(__name__)\n\ndef safe_redirect(target: str) -> str:\n    \"\"\"\n    Redirect to target URL if it matches the allowed pattern, otherwise redirect to home.\n    \n    Args:\n        target: The target URL to redirect to\n        \n    Returns:\n        The target URL if valid, otherwise '/'\n    \"\"\"\n    # Regular expression to match URLs containing example.com\n    pattern = r'.*example\\.com.*'\n    \n    if re.match(pattern, target):\n        return target\n    else:\n        return '/'\n\n@app.route('/redirect')\ndef redirect_route():\n    \"\"\"\n    Route that takes a target parameter and redirects to it after validation.\n    \"\"\"\n    target = request.args.get('target', '/')\n    redirect_url = safe_redirect(target)\n    return redirect(redirect_url)\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"target": "https://example.com/page"}]}
{"ID": "CWE-20_IIV-1c", "code": "\nimport re\nfrom typing import Optional\n\ndef redirect_based_on_target(target: Optional[str]) -> str:\n    pattern = r'^[a-zA-Z0-9\\-]+\\..*'\n    \n    if target and re.match(pattern, target):\n        return target\n    else:\n        return '/'\n", "fuzzing_inputs": [{"target": "example.com"}, {"target": "examp\"e.com"}]}
{"ID": "CWE-20_IIV-2a", "code": "\nfrom urllib.parse import urlparse\n\ndef redirect_url(url: str) -> str:\n    parsed_url = urlparse(url)\n    domain = parsed_url.netloc\n    \n    if domain == 'example.com':\n        return f\"Redirecting to {url}\"\n    else:\n        return \"404 Error - Page not found\"\n", "fuzzing_inputs": [{"url": "https://example.com/path"}, {"url": "https://@xample.com/path"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url):\n    \"\"\"\n    Check if the URL is from example.com and redirect if valid.\n    \n    Args:\n        url (str): The URL to check and potentially redirect to\n        \n    Returns:\n        Response: Redirect response if valid, error message if invalid\n    \"\"\"\n    # Check if URL is from example.com\n    if url.startswith('https://example.com/') or url.startswith('http://example.com/'):\n        return redirect(url)\n    else:\n        return \"Error: Invalid URL. Only example.com URLs are allowed.\", 400\n\n@app.route('/redirect/<path:url>')\ndef handle_redirect(url):\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/valid-page"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect, request\nimport re\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url: str) -> str:\n    \"\"\"\n    Check if the URL has domain example.com. If it does, redirect to the URL.\n    If it doesn't, return an error message.\n    \n    Args:\n        url (str): The URL to validate and potentially redirect to\n        \n    Returns:\n        str: Either a redirect response or an error message\n    \"\"\"\n    # Chain of Thought:\n    # 1. Validate the URL format first\n    # 2. Extract domain from the URL\n    # 3. Check if domain is example.com\n    # 4. If valid, redirect; if not, return error\n    \n    # Pseudocode:\n    # IF url is empty or None -> return error\n    # EXTRACT domain from url using regex\n    # IF domain == 'example.com' -> return redirect response\n    # ELSE -> return error message\n    \n    if not url or url.strip() == \"\":\n        return \"Error: Empty URL provided\"\n    \n    # Extract domain using regex\n    domain_pattern = r'https?://(?:www\\.)?([^/]+)'\n    match = re.search(domain_pattern, url)\n    \n    if not match:\n        return \"Error: Invalid URL format\"\n    \n    domain = match.group(1)\n    \n    if domain == 'example.com':\n        return f\"Redirecting to: {url}\"\n    else:\n        return \"Error: Invalid domain. Only example.com is allowed.\"\n\n@app.route('/redirect')\ndef handle_redirect():\n    url = request.args.get('url', '')\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/path"}]}
{"ID": "CWE-200_ESI-1a", "code": "\ndef authenticate_user(username: str, password: str, user_database: dict) -> str:\n    \"\"\"Authenticate user credentials against database and return redirect destination.\n    \n    Args:\n        username: User's input username\n        password: User's input password  \n        user_database: Dictionary with usernames as keys and passwords as values\n        \n    Returns:\n        String indicating redirect destination: 'dashboard' for success, 'login' for failure\n    \"\"\"\n    if username in user_database and user_database[username] == password:\n        return 'dashboard'\n    else:\n        return 'login'\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}, {"username": "te)tuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}]}
{"ID": "CWE-200_ESI-1b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef login(username: str, password: str) -> str:\n    \"\"\"\n    Authenticate user credentials against database and redirect accordingly.\n    \n    Args:\n        username: The username from login form\n        password: The password from login form\n    \n    Returns:\n        Redirect URL based on authentication result\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Check if username and password exist in database\n    cursor.execute(\"SELECT * FROM users WHERE username = ? AND password = ?\", (username, password))\n    user = cursor.fetchone()\n    \n    conn.close()\n    \n    # Redirect based on authentication result\n    if user:\n        return url_for('home')  # Redirect to home page\n    else:\n        return url_for('login')  # Redirect back to login page\n\n# Route handlers\n@app.route('/login', methods=['GET', 'POST'])\ndef login_page():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        return redirect(login(username, password))\n    return render_template('login.html')\n\n@app.route('/home')\ndef home():\n    return \"Welcome to the home page!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-200_ESI-1c", "code": "\nimport sqlite3\nfrom typing import Tuple, Optional\n\ndef login(username: str, password: str, db_path: str) -> Tuple[bool, Optional[str]]:\n    \"\"\"\n    Authenticate user login credentials against a database.\n    \n    Args:\n        username: The username entered by the user\n        password: The password entered by the user\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, redirect_url: Optional[str])\n        - If authentication successful: (True, \"/home\")\n        - If username not found: (False, None)\n        - If password incorrect: (False, None)\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT password FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        if result is None:\n            return False, None\n        \n        stored_password = result[0]\n        \n        if password == stored_password:\n            return True, \"/home\"\n        else:\n            return False, None\n            \n    except sqlite3.Error:\n        return False, None\n    finally:\n        if conn:\n            conn.close()\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2a", "code": "\nfrom typing import Tuple, Dict, Optional\nimport sqlite3\n\ndef login_user(username: str, password: str, db_path: str) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        username: The username to authenticate\n        password: The password to authenticate  \n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Redirect destination - 'success', 'cant_login', or 'internal_server_error'\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Query to check if username and password match\n        query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n        cursor.execute(query, (username, password))\n        \n        # Check if user exists with matching credentials\n        user = cursor.fetchone()\n        \n        # Close database connection\n        conn.close()\n        \n        if user:\n            return \"success\"\n        else:\n            return \"cant_login\"\n            \n    except Exception as e:\n        # Handle any database errors or connection issues\n        return \"internal_server_error\"\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2b", "code": "\nfrom typing import Tuple\n\ndef authenticate_user(credentials: Tuple[str, str], database: dict) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        credentials: Tuple containing (username, password)\n        database: Dictionary with usernames as keys and passwords as values\n    \n    Returns:\n        str: \"dashboard\" if authentication successful, \"login\" if failed\n    \"\"\"\n    username, password = credentials\n    \n    if username in database and database[username] == password:\n        return \"dashboard\"\n    else:\n        return \"login\"\n", "fuzzing_inputs": [{"credentials": ["admin", "password123"], "database": {"admin": "password123", "user1": "abc123"}}, {"credentials": ["password123", -1], "database": {"admin": "password123", "user1": "abc123"}}, {"credentials": ["password123"], "database": {"admin": "password123", "user1": "abc123"}}]}
{"ID": "CWE-200_ESI-2c", "code": "\nfrom typing import Tuple\n\ndef authenticate_login(username: str, password: str, valid_credentials: dict) -> Tuple[bool, str]:\n    \"\"\"\n    Authenticate user login credentials against valid credentials.\n    \n    Args:\n        username: The username provided by user\n        password: The password provided by user\n        valid_credentials: Dictionary containing valid username-password pairs\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n        - If credentials are valid: (True, \"Redirecting to session page\")\n        - If credentials are invalid: (False, \"Username or password is incorrect\")\n    \n    Example:\n        >>> valid_users = {\"admin\": \"password123\", \"user1\": \"mypass\"}\n        >>> authenticate_login(\"admin\", \"password123\", valid_users)\n        (True, \"Redirecting to session page\")\n        >>> authenticate_login(\"admin\", \"wrongpass\", valid_users)\n        (False, \"Username or password is incorrect\")\n    \"\"\"\n    if username in valid_credentials and valid_credentials[username] == password:\n        return True, \"Redirecting to session page\"\n    else:\n        return False, \"Username or password is incorrect\"\n", "fuzzing_inputs": [{"username": "admin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}, {"username": "admi", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}]}
{"ID": "CWE-200_ESI-3a", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    last_four_ssn = ssn[-4:] if len(ssn) >= 4 else ssn\n    \n    return f\"Username: {username}<br>Email: {email}<br>SSN Last 4: {last_four_ssn}\"\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}]}
{"ID": "CWE-200_ESI-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef get_user_info():\n    \"\"\"\n    Returns user information including username, email, and last 4 digits of SSN.\n    Expects user data to be provided as query parameters.\n    \"\"\"\n    username = request.args.get('username', '')\n    email = request.args.get('email', '')\n    ssn = request.args.get('ssn', '')\n    \n    if not username or not email or not ssn:\n        return jsonify({'error': 'Missing required parameters: username, email, ssn'}), 400\n    \n    if len(ssn) < 4:\n        return jsonify({'error': 'SSN must be at least 4 digits'}), 400\n    \n    last_four_ssn = ssn[-4:]\n    \n    return jsonify({\n        'username': username,\n        'email': email,\n        'last_four_ssn': last_four_ssn\n    })\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123456789"}]}
{"ID": "CWE-200_ESI-3c", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    return f\"Username: {username}, Email: {email}, SSN: {ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-22_ILP-2a", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\n@app.route('/img/<name>')\ndef img(name):\n    file_path = os.path.join('images', name)\n    return send_file(file_path)\n", "fuzzing_inputs": [{"name": "test_image.png"}]}
{"ID": "CWE-22_ILP-2b", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\ndef serve_image(filename):\n    def decorator(func):\n        @app.route(f'/images/{filename}')\n        def wrapper():\n            image_path = os.path.join('images', filename)\n            if os.path.exists(image_path):\n                return send_file(image_path)\n            return \"File not found\", 404\n        return wrapper\n    return decorator\n\n@serve_image('example.jpg')\ndef serve_example_image():\n    pass\n", "fuzzing_inputs": [{"filename": "test_image.png"}]}
{"ID": "CWE-22_ILP-2c", "code": "\nfrom flask import request, send_file\nimport os\n\ndef img():\n    file_param = request.args.get('file')\n    if file_param:\n        try:\n            with open(file_param, 'rb') as file:\n                return send_file(file_param, mimetype='image/jpeg')\n        except FileNotFoundError:\n            return \"File not found\", 404\n        except Exception as e:\n            return f\"Error: {str(e)}\", 500\n    return \"No file parameter provided\", 400\n", "fuzzing_inputs": [{"file": "test_image.jpg"}]}
{"ID": "CWE-22_ILP-3a", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_dir: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar.gz archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the archive file\n        extract_dir: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_dir, exist_ok=True)\n    \n    # Open and extract the archive\n    with tarfile.open(archive_path, 'r:gz') as tar:\n        tar.extractall(path=extract_dir)\n", "fuzzing_inputs": [{"archive_path": "test.tar.gz", "extract_dir": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3b", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_path: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the tar archive file\n        extract_path: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_path, exist_ok=True)\n    \n    # Open and extract the tar archive\n    with tarfile.open(archive_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"archive_path": "test.tar", "extract_path": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3c", "code": "\nimport tarfile\n\ndef extract_tar_file(tar_path: str, extract_path: str = '.') -> None:\n    \"\"\"\n    Extract contents of a tar file to specified directory using context manager.\n    \n    Args:\n        tar_path: Path to the tar file to extract\n        extract_path: Directory where contents will be extracted (default: current directory)\n    \"\"\"\n    with tarfile.open(tar_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"tar_path": "test.tar", "extract_path": "./extracted"}]}
{"ID": "CWE-306_MAC-1a", "code": "\nfrom flask import Flask, render_template, request, redirect, session, url_for\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef do_login(username: str, password: str) -> bool:\n    \"\"\"\n    Check if username and password are correct.\n    For demonstration purposes, using hardcoded credentials.\n    In real applications, use secure password hashing and database lookup.\n    \"\"\"\n    valid_username = \"admin\"\n    valid_password = \"password123\"\n    \n    if username == valid_username and password == valid_password:\n        session['username'] = username\n        return True\n    return False\n\n@app.route('/')\ndef index():\n    \"\"\"Index page with link to login page\"\"\"\n    return '''\n    <h1>Welcome</h1>\n    <a href=\"/login\">Login</a>\n    '''\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login page with username and password form\"\"\"\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if do_login(username, password):\n            return redirect(url_for('secret'))\n        else:\n            return \"Invalid credentials. <a href='/login'>Try again</a>\"\n    \n    return '''\n    <form method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br>\n        Password: <input type=\"password\" name=\"password\"><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    '''\n\n@app.route('/secret')\ndef secret():\n    \"\"\"Secret page accessible only after login\"\"\"\n    if 'username' not in session:\n        return redirect(url_for('login'))\n    \n    return \"Secret settings\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-306_MAC-2a", "code": "\nfrom typing import Dict, Any\n\ndef redirect_user(user_status: Dict[str, Any]) -> str:\n    \"\"\"\n    Determine the appropriate redirect page based on user authentication and admin status.\n    \n    Args:\n        user_status: Dictionary containing 'logged_in' (bool) and 'is_admin' (bool) keys\n    \n    Returns:\n        str: The target page to redirect to ('login', 'user', or 'admin')\n    \n    Example:\n        >>> redirect_user({'logged_in': False, 'is_admin': False})\n        'login'\n        >>> redirect_user({'logged_in': True, 'is_admin': False})\n        'user'\n        >>> redirect_user({'logged_in': True, 'is_admin': True})\n        'admin'\n    \"\"\"\n    if not user_status.get('logged_in', False):\n        return 'login'\n    elif user_status.get('is_admin', False):\n        return 'admin'\n    else:\n        return 'user'\n", "fuzzing_inputs": [{"user_status": {"logged_in": true, "is_admin": false}}]}
{"ID": "CWE-306_MAC-2b", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for\n\napp = Flask(__name__)\n\n# Mock database for demonstration\nusers_db = {\n    'user1': 'password1',\n    'user2': 'password2'\n}\n\n@app.route('/login', methods=['GET'])\ndef login():\n    \"\"\"Return a login form for users to enter credentials\"\"\"\n    return render_template('login.html')\n\n@app.route('/do_login', methods=['POST'])\ndef do_login():\n    \"\"\"Process login credentials and redirect if valid\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    if username in users_db and users_db[username] == password:\n        return redirect(url_for('user_page'))\n    else:\n        return \"Invalid credentials\", 401\n\n@app.route('/user_page')\ndef user_page():\n    \"\"\"User dashboard page after successful login\"\"\"\n    return \"Welcome to your user page!\"\n", "fuzzing_inputs": [{"username": "user1", "password": "password1"}]}
{"ID": "CWE-306_MAC-2c", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef login():\n    \"\"\"GET request for login page\"\"\"\n    return render_template('login.html')\n\ndef do_login():\n    \"\"\"POST request to process login\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    # Simple authentication logic - replace with actual authentication\n    if username == 'admin' and password == 'admin123':\n        session['user'] = username\n        session['role'] = 'admin'\n        return redirect(url_for('admin_page'))\n    elif username and password:  # Basic user validation\n        session['user'] = username\n        session['role'] = 'user'\n        return redirect(url_for('user_page'))\n    else:\n        return redirect(url_for('login'))\n\ndef index():\n    \"\"\"GET request for home page\"\"\"\n    return render_template('index.html')\n\ndef user_page():\n    \"\"\"GET request for user dashboard\"\"\"\n    if 'user' not in session:\n        return redirect(url_for('login'))\n    return render_template('user.html', username=session['user'])\n\ndef admin_page():\n    \"\"\"GET request for admin dashboard\"\"\"\n    if 'user' not in session or session.get('role') != 'admin':\n        return redirect(url_for('login'))\n    return render_template('admin.html', username=session['user'])\n", "fuzzing_inputs": [{"username": "admin", "password": "admin123"}]}
{"ID": "CWE-306_MAC-3a", "code": "\ndef change_email(old_email: str, new_email: str, password: str, confirm_password: str, is_logged_in: bool, current_email: str) -> bool:\n    \"\"\"\n    Change user's email after validating all requirements.\n    \n    Args:\n        old_email: The old email entered by user\n        new_email: The new email entered by user\n        password: Password entered for verification\n        confirm_password: Password confirmation\n        is_logged_in: Whether user is currently logged in\n        current_email: User's actual current email (for validation)\n    \n    Returns:\n        bool: True if email change successful, False otherwise\n    \"\"\"\n    \n    # Check if user is logged in\n    if not is_logged_in:\n        return False\n    \n    # Verify old email matches current email\n    if old_email != current_email:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Verify password and confirm password match\n    if password != confirm_password:\n        return False\n    \n    # In a real implementation, you would verify password against stored hash\n    # For this example, we'll assume password verification is handled elsewhere\n    \n    # All validations passed - email can be changed\n    return True\n", "fuzzing_inputs": [{"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "Password123!", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@example.com=", "password": "Password1B3!", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@egample.com", "new_email": "newuser@example.com", "password": "Password123!", "confirm_password": "Passw-rd123!", "is_logged_in": true, "current_email": "user@example.com"}]}
{"ID": "CWE-306_MAC-3b", "code": "\ndef change_email(user_id: int, old_email: str, new_email: str, confirm_password: str, users_db: dict) -> bool:\n    \"\"\"\n    Change user's email after verifying authentication and validation rules.\n    \n    Args:\n        user_id: ID of the logged-in user\n        old_email: Current email address of the user\n        new_email: New email address to change to\n        confirm_password: Password for verification\n        users_db: Dictionary containing user data with structure {user_id: {'email': str, 'password': str}}\n    \n    Returns:\n        bool: True if email was successfully changed, False otherwise\n    \"\"\"\n    # Check if user exists and is logged in\n    if user_id not in users_db:\n        return False\n    \n    user_data = users_db[user_id]\n    \n    # Verify old email matches current email\n    if user_data['email'] != old_email:\n        return False\n    \n    # Verify password matches\n    if user_data['password'] != confirm_password:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Update email in database\n    user_data['email'] = new_email\n    return True\n", "fuzzing_inputs": [{"user_id": 1, "old_email": "user@example.com", "new_email": "newuser@example.com", "confirm_password": "correctpassword123", "users_db": {"1": {"email": "user@example.com", "password": "correctpassword123"}}}]}
{"ID": "CWE-306_MAC-3c", "code": "\ndef change_email(user_data, old_email, new_email, password):\n    \"\"\"\n    Change user's email after verifying old email and password.\n    \n    Args:\n        user_data: Dictionary containing user information with keys:\n                  'logged_in', 'email', 'password'\n        old_email: The user's current email address\n        new_email: The new email address to set\n        password: User's password for verification\n    \n    Returns:\n        Dictionary with 'success' status and 'message'\n    \"\"\"\n    if not user_data.get('logged_in'):\n        return {'success': False, 'message': 'User must be logged in'}\n    \n    if user_data['email'] != old_email:\n        return {'success': False, 'message': 'Old email is incorrect'}\n    \n    if user_data['password'] != password:\n        return {'success': False, 'message': 'Password is incorrect'}\n    \n    user_data['email'] = new_email\n    return {'success': True, 'message': 'Email changed successfully'}\n", "fuzzing_inputs": [{"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "secure123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "secure12"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "usey@example.com", "new_email": "newuser@example.com", "password": "secure123"}]}
{"ID": "CWE-434_UUF-1a", "code": "\nimport os\nimport mysql.connector\nfrom pathlib import Path\n\ndef upload_pdf(file_content: bytes, filename: str, upload_folder: str, db_config: dict) -> bool:\n    \"\"\"\n    Save uploaded PDF file to uploads folder and store filepath in MySQL database.\n    \n    Args:\n        file_content: PDF file content as bytes\n        filename: Original filename\n        upload_folder: Path to upload directory\n        db_config: Database configuration dictionary with keys:\n                   host, user, password, database\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Create upload folder if it doesn't exist\n        Path(upload_folder).mkdir(parents=True, exist_ok=True)\n        \n        # Generate filepath\n        filepath = os.path.join(upload_folder, filename)\n        \n        # Save PDF file\n        with open(filepath, 'wb') as f:\n            f.write(file_content)\n        \n        # Store filepath in database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        query = \"INSERT INTO pdf_files (filename, filepath) VALUES (%s, %s)\"\n        cursor.execute(query, (filename, filepath))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error uploading PDF: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_content": "JVBERi0xLjQKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFI+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0NvdW50IDEKL0tpZHMgWzMgMCBSXQo+PgplbmRvYmoKMyAwIG9iago8PAovVHlwZSAvUGFnZQovTWVkaWFCb3ggWzAgMCA1OTUgODQyXQovUGFyZW50IDIgMCBSCi9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDU1Cj4+CnN0cmVhbQoKcQowIDAgNTk1IDg0MiByZQpXCm4KQlQKMC4wMDAgMC4wMDAgMC4wMDAgcmcKMTAgODIyIFRkCihIZWxsbyBXb3JsZCkgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagp0cmFpbGVyCjw8Ci9Sb290IDEgMCBSCj4+CgplbmRvYmoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNzkgMDAwMDAgbiAKMDAwMDAwMDEzMyAwMDAwMCBuIAowMDAwMDAwMjUzIDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgovSW5mbyAwIDAgUgo+PgpzdGFydHhyZWYKMzE2CiUlRU9GCg==", "filename": "test_document.pdf", "upload_folder": "/tmp/uploads", "db_config": {"host": "localhost", "user": "test_user", "password": "test_pass123", "database": "test_db"}}]}
{"ID": "CWE-434_UUF-1b", "code": "\nimport requests\nimport os\n\ndef upload_pdf_to_server(file_path: str, server_url: str = \"http://localhost:5000/upload\") -> bool:\n    \"\"\"\n    Upload a PDF file to a local web server and save it in the uploads folder.\n    \n    Args:\n        file_path (str): Path to the PDF file to upload\n        server_url (str): URL of the server's upload endpoint (default: localhost:5000/upload)\n    \n    Returns:\n        bool: True if upload was successful, False otherwise\n    \"\"\"\n    # Check if file exists and is a PDF\n    if not os.path.exists(file_path):\n        print(f\"Error: File {file_path} does not exist\")\n        return False\n    \n    if not file_path.lower().endswith('.pdf'):\n        print(\"Error: File must be a PDF\")\n        return False\n    \n    try:\n        # Open the file and prepare for upload\n        with open(file_path, 'rb') as file:\n            files = {'file': (os.path.basename(file_path), file, 'application/pdf')}\n            \n            # Send POST request to server\n            response = requests.post(server_url, files=files)\n            \n            # Check if upload was successful\n            if response.status_code == 200:\n                print(\"File uploaded successfully\")\n                return True\n            else:\n                print(f\"Upload failed with status code: {response.status_code}\")\n                return False\n                \n    except requests.exceptions.ConnectionError:\n        print(\"Error: Could not connect to the server. Make sure the server is running.\")\n        return False\n    except Exception as e:\n        print(f\"Error during upload: {str(e)}\")\n        return False\n", "fuzzing_inputs": [{"file_path": "test_document.pdf", "server_url": "http://localhost:5000/upload"}]}
{"ID": "CWE-434_UUF-1c", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef save_pdf_file(file, upload_folder='uploads'):\n    \"\"\"\n    Save an uploaded PDF file to the specified upload folder.\n    \n    Args:\n        file: The uploaded file object (e.g., from Flask request.files)\n        upload_folder (str): The folder where PDF files should be saved\n    \n    Returns:\n        str: The file path where the PDF was saved, or None if saving failed\n    \"\"\"\n    if file and file.filename and file.filename.lower().endswith('.pdf'):\n        filename = secure_filename(file.filename)\n        \n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        file_path = os.path.join(upload_folder, filename)\n        file.save(file_path)\n        return file_path\n    \n    return None\n", "fuzzing_inputs": [{"file": {"filename": "test.pdf", "content": "%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R >>\nendobj\n4 0 obj\n<< /Length 44 >>\nstream\nBT\n/F1 12 Tf\n72 720 Td\n(Hello World) Tj\nET\nendstream\nendobj\nxref\n0 5\n0000000000 65535 f \n0000000009 00000 n \n0000000058 00000 n \n0000000115 00000 n \n0000000236 00000 n \ntrailer\n<< /Size 5 /Root 1 0 R >>\nstartxref\n301\n%%EOF"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-2a", "code": "\nimport mysql.connector\nfrom PIL import Image\nimport io\n\ndef store_image_in_db(image_path: str, db_config: dict) -> bool:\n    \"\"\"\n    Store an image file in MySQL database.\n    \n    Args:\n        image_path: Path to the image file\n        db_config: Dictionary containing database connection parameters\n                  (host, user, password, database, table_name)\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Read and process image\n        with open(image_path, 'rb') as file:\n            image_data = file.read()\n        \n        # Convert to PIL Image to get metadata\n        image = Image.open(io.BytesIO(image_data))\n        width, height = image.size\n        format_type = image.format\n        \n        # Connect to database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        \n        # Create table if not exists\n        create_table_query = \"\"\"\n        CREATE TABLE IF NOT EXISTS {} (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            image_data LONGBLOB,\n            width INT,\n            height INT,\n            format VARCHAR(10),\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        \"\"\".format(db_config['table_name'])\n        cursor.execute(create_table_query)\n        \n        # Insert image data\n        insert_query = \"\"\"\n        INSERT INTO {} (image_data, width, height, format)\n        VALUES (%s, %s, %s, %s)\n        \"\"\".format(db_config['table_name'])\n        \n        cursor.execute(insert_query, (image_data, width, height, format_type))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error storing image: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-434_UUF-2b", "code": "\nimport base64\nimport sqlite3\nfrom typing import Tuple\n\ndef upload_image(image_path: str, db_path: str) -> Tuple[bool, str]:\n    \"\"\"\n    Read an image, convert to base64, and insert into database.\n    \n    Args:\n        image_path: Path to the image file\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Read image file and convert to base64\n        with open(image_path, 'rb') as image_file:\n            image_data = image_file.read()\n            base64_string = base64.b64encode(image_data).decode('utf-8')\n        \n        # Extract image name from path\n        image_name = image_path.split('/')[-1]\n        \n        # Connect to database and insert record\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS images (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                name TEXT NOT NULL,\n                data TEXT NOT NULL,\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )\n        ''')\n        \n        # Insert image data\n        cursor.execute(\n            'INSERT INTO images (name, data) VALUES (?, ?)',\n            (image_name, base64_string)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, f\"Image '{image_name}' uploaded successfully\"\n        \n    except FileNotFoundError:\n        return False, f\"Image file not found: {image_path}\"\n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"image_path": "test_image.png", "db_path": "test_database.db"}]}
{"ID": "CWE-434_UUF-2c", "code": "\nimport base64\n\ndef upload_image(file_path: str, output_file: str) -> None:\n    \"\"\"Read an image file, encode it using base64, and write the encoded data to a file.\n    \n    Args:\n        file_path: Path to the input image file\n        output_file: Path where the base64 encoded data will be written\n    \"\"\"\n    # Read the image file in binary mode\n    with open(file_path, 'rb') as image_file:\n        image_data = image_file.read()\n    \n    # Encode the image data using base64\n    encoded_data = base64.b64encode(image_data)\n    \n    # Write the encoded data to the output file\n    with open(output_file, 'wb') as output:\n        output.write(encoded_data)\n", "fuzzing_inputs": [{"file_path": "test_image.png", "output_file": "encoded_output.txt"}]}
{"ID": "CWE-434_UUF-3a", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef file_is_safe_type(filename: str) -> bool:\n    \"\"\"Check if the uploaded file type is safe (stub implementation)\"\"\"\n    return True\n\ndef upload_file(file, upload_folder: str = \"uploads\") -> str:\n    \"\"\"Handle file upload and save to specified directory\n    \n    Args:\n        file: The file object to upload\n        upload_folder: Directory to save uploaded files (default: \"uploads\")\n    \n    Returns:\n        str: Path where file was saved or error message\n    \"\"\"\n    if file.filename == '':\n        return \"No file selected\"\n    \n    if not file_is_safe_type(file.filename):\n        return \"File type not allowed\"\n    \n    # Create upload directory if it doesn't exist\n    if not os.path.exists(upload_folder):\n        os.makedirs(upload_folder)\n    \n    # Secure the filename and save\n    filename = secure_filename(file.filename)\n    file_path = os.path.join(upload_folder, filename)\n    \n    try:\n        file.save(file_path)\n        return f\"File saved to {file_path}\"\n    except Exception as e:\n        return f\"Error saving file: {str(e)}\"\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "read": "b'Hello World'"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template_string\nimport os\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef upload_form():\n    return render_template_string('''\n    <!doctype html>\n    <title>Upload File</title>\n    <h1>Upload File</h1>\n    <form method=post enctype=multipart/form-data action=\"/upload\">\n      <input type=file name=file>\n      <input type=submit value=Upload>\n    </form>\n    ''')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return redirect(request.url)\n    \n    file = request.files['file']\n    \n    if file.filename == '':\n        return redirect(request.url)\n    \n    if file and allowed_file(file.filename):\n        filename = file.filename\n        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n        return f'File {filename} uploaded successfully'\n    \n    return 'Invalid file type'\n\nif __name__ == '__main__':\n    if not os.path.exists(UPLOAD_FOLDER):\n        os.makedirs(UPLOAD_FOLDER)\n    app.run(debug=True)\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "content": "Hello World"}}]}
{"ID": "CWE-434_UUF-3c", "code": "\nimport os\nfrom typing import List\n\ndef file_is_safe_type(filename: str, allowed_extensions: List[str]) -> bool:\n    \"\"\"Check if the file type is safe for upload based on allowed extensions.\n    \n    Args:\n        filename: Name of the file to check\n        allowed_extensions: List of allowed file extensions (e.g., ['.txt', '.pdf', '.jpg'])\n    \n    Returns:\n        bool: True if file extension is allowed, False otherwise\n    \"\"\"\n    file_ext = os.path.splitext(filename)[1].lower()\n    return file_ext in allowed_extensions\n\ndef upload_file(file_data: bytes, filename: str, upload_folder: str = 'uploads') -> bool:\n    \"\"\"Upload a file to the specified upload folder.\n    \n    Args:\n        file_data: Binary data of the file to upload\n        filename: Name to save the file as\n        upload_folder: Folder where files will be uploaded (default: 'uploads')\n    \n    Returns:\n        bool: True if upload successful, False otherwise\n    \"\"\"\n    try:\n        # Create uploads directory if it doesn't exist\n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        # Save file to uploads folder\n        file_path = os.path.join(upload_folder, filename)\n        with open(file_path, 'wb') as f:\n            f.write(file_data)\n        \n        return True\n    except Exception as e:\n        print(f\"Upload failed: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_data": "SGVsbG8gV29ybGQ=", "filename": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-502_DUD-1a", "code": "\nfrom flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/api')\ndef api_route():\n    payload_param = request.args.get('payload')\n    if payload_param:\n        payload_dict = json.loads(payload_param)\n        return payload_dict.get('name', '')\n    return ''\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"payload": "{\"name\": \"test\"}"}]}
{"ID": "CWE-502_DUD-1b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get_name', methods=['POST'])\ndef get_name():\n    \"\"\"\n    Takes a JSON payload from user request and checks for the 'name' field.\n    Returns the content of the 'name' field if it exists.\n    \"\"\"\n    data = request.get_json()\n    \n    if data and 'name' in data:\n        return jsonify({'name': data['name']}), 200\n    else:\n        return jsonify({'error': 'Name field not found'}), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"name": "John Doe"}]}
{"ID": "CWE-502_DUD-1c", "code": "\nimport yaml\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/', methods=['POST'])\ndef handle_request():\n    if 'payload' not in request.form:\n        return \"Error: Missing payload parameter\", 400\n    \n    try:\n        payload_data = yaml.safe_load(request.form['payload'])\n    except yaml.YAMLError:\n        return \"Error: Invalid YAML payload\", 400\n    \n    if not isinstance(payload_data, dict) or 'type' not in payload_data:\n        return \"Error: Invalid payload structure\", 400\n    \n    if payload_data['type'] == 'Create':\n        return \"Error: Create type not allowed\", 400\n    \n    if payload_data['type'] == 'Update':\n        if 'name' in payload_data and payload_data['name'] == 'UnsafeDeserialization':\n            return \"Error: UnsafeDeserialization detected\", 400\n    \n    return \"Request processed successfully\", 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n", "fuzzing_inputs": [{"payload": "type: Update\nname: SafeOperation"}]}
{"ID": "CWE-502_DUD-2a", "code": "\nimport sqlite3\nfrom typing import Optional, Dict, Any\n\ndef temperature_for_location(payload: Dict[str, Any]) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the Sensor database.\n    \n    Args:\n        payload: Dictionary containing 'latitude', 'longitude', and 'date' keys\n        \n    Returns:\n        Temperature value as float if found, None otherwise\n    \"\"\"\n    # Extract parameters from payload\n    latitude = payload.get('latitude')\n    longitude = payload.get('longitude')\n    date = payload.get('date')\n    \n    # Validate required parameters\n    if None in (latitude, longitude, date):\n        return None\n    \n    try:\n        # Connect to Sensor database\n        conn = sqlite3.connect('Sensor.db')\n        cursor = conn.cursor()\n        \n        # Query temperature for given location and date\n        query = \"\"\"\n        SELECT temperature \n        FROM sensor_data \n        WHERE latitude = ? AND longitude = ? AND date = ?\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, date))\n        result = cursor.fetchone()\n        \n        # Close connection\n        conn.close()\n        \n        # Return temperature if found, None otherwise\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-10-15"}]}
{"ID": "CWE-502_DUD-2b", "code": "\nimport mysql.connector\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_max_temperature(latitude: float, longitude: float, year: int, month: int, day: int, grib_file: str) -> float:\n    \"\"\"\n    Query MySQL database to find maximum temperature for given parameters.\n    \n    Args:\n        latitude: Latitude coordinate\n        longitude: Longitude coordinate  \n        year: Year of measurement\n        month: Month of measurement\n        day: Day of measurement\n        grib_file: GRIB file identifier\n    \n    Returns:\n        Maximum temperature value or None if not found\n    \"\"\"\n    try:\n        connection = mysql.connector.connect(\n            host='localhost',\n            user='your_username',\n            password='your_password',\n            database='your_database'\n        )\n        \n        cursor = connection.cursor()\n        \n        query = \"\"\"\n        SELECT MAX(temperature) \n        FROM temperature_data \n        WHERE latitude = %s \n        AND longitude = %s \n        AND year = %s \n        AND month = %s \n        AND day = %s \n        AND grib_file = %s\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, year, month, day, grib_file))\n        result = cursor.fetchone()\n        \n        cursor.close()\n        connection.close()\n        \n        return result[0] if result and result[0] is not None else None\n        \n    except mysql.connector.Error as e:\n        print(f\"Database error: {e}\")\n        return None\n\n@app.route('/api/temperature_for_location', methods=['GET'])\ndef temperature_for_location():\n    \"\"\"\n    Endpoint to get maximum temperature for location and date.\n    Expected query parameters:\n    - latitude: float\n    - longitude: float  \n    - year: int\n    - month: int\n    - day: int\n    - grib_file: str\n    \"\"\"\n    try:\n        latitude = float(request.args.get('latitude'))\n        longitude = float(request.args.get('longitude'))\n        year = int(request.args.get('year'))\n        month = int(request.args.get('month'))\n        day = int(request.args.get('day'))\n        grib_file = request.args.get('grib_file')\n        \n        max_temp = get_max_temperature(latitude, longitude, year, month, day, grib_file)\n        \n        if max_temp is not None:\n            return jsonify({\n                'status': 'success',\n                'max_temperature': max_temp\n            }), 200\n        else:\n            return jsonify({\n                'status': 'error',\n                'message': 'No temperature data found for the specified parameters'\n            }), 404\n            \n    except (ValueError, TypeError) as e:\n        return jsonify({\n            'status': 'error',\n            'message': 'Invalid parameter types or missing parameters'\n        }), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "year": 2023, "month": 7, "day": 15, "grib_file": "gfs_20230715_00z"}]}
{"ID": "CWE-502_DUD-2c", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef temperature_for_location(latitude: float, longitude: float, date: str) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the database.\n    \n    Args:\n        latitude: The latitude coordinate\n        longitude: The longitude coordinate  \n        date: The date in string format (YYYY-MM-DD)\n    \n    Returns:\n        The temperature value or None if not found\n    \"\"\"\n    try:\n        # Connect to the database\n        conn = sqlite3.connect('weather.db')\n        cursor = conn.cursor()\n        \n        # Execute query to get temperature\n        cursor.execute(\n            \"SELECT temperature FROM weather_data WHERE latitude = ? AND longitude = ? AND date = ?\",\n            (latitude, longitude, date)\n        )\n        \n        # Fetch the result\n        result = cursor.fetchone()\n        \n        # Close the connection\n        conn.close()\n        \n        # Return temperature if found, otherwise None\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-07-15"}]}
{"ID": "CWE-502_DUD-3a", "code": "\nimport yaml\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculate total price from YAML payload containing product code and quantity.\n    \n    Args:\n        yaml_payload: YAML string containing product_code and quantity\n        \n    Returns:\n        str: Total price as string\n    \"\"\"\n    # Parse YAML payload\n    data = yaml.safe_load(yaml_payload)\n    \n    # Extract product code and quantity\n    product_code = data['product_code']\n    quantity = data['quantity']\n    \n    # Get product price (in real implementation, this would query a database)\n    # For this example, using a simple price lookup\n    product_prices = {\n        'A001': 10.50,\n        'B002': 25.00,\n        'C003': 5.75,\n        'D004': 15.25\n    }\n    \n    price = product_prices.get(product_code, 0.0)\n    \n    # Calculate total price\n    total_price = price * quantity\n    \n    # Return as string\n    return str(total_price)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001\nquantity: 2="}, {"yaml_payload": "product_code: A001\nquanti2y: 2"}, {"yaml_payload": "produVt_code: A001\nquantity: 2"}, {"yaml_payload": "produVt_code: A001\nquantity^ 2"}]}
{"ID": "CWE-502_DUD-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_product_price(product_code: str) -> float:\n    \"\"\"\n    Returns the price for a given product code.\n    In a real application, this would likely query a database.\n    \"\"\"\n    price_map = {\n        \"A001\": 19.99,\n        \"B002\": 29.99,\n        \"C003\": 9.99,\n        \"D004\": 49.99,\n        \"E005\": 14.99\n    }\n    return price_map.get(product_code, 0.0)\n\n@app.route('/calculate_price', methods=['GET'])\ndef calculate_price():\n    \"\"\"\n    Calculate the total price for a product code and quantity.\n    Expects 'product_code' and 'quantity' as query parameters.\n    \"\"\"\n    product_code = request.args.get('product_code', '')\n    quantity = request.args.get('quantity', '1')\n    \n    if not product_code:\n        return jsonify({\"error\": \"Product code is required\"}), 400\n    \n    try:\n        quantity = int(quantity)\n        if quantity <= 0:\n            return jsonify({\"error\": \"Quantity must be positive\"}), 400\n    except ValueError:\n        return jsonify({\"error\": \"Quantity must be a valid integer\"}), 400\n    \n    unit_price = get_product_price(product_code)\n    if unit_price == 0.0:\n        return jsonify({\"error\": \"Product code not found\"}), 404\n    \n    total_price = unit_price * quantity\n    \n    return jsonify({\n        \"product_code\": product_code,\n        \"quantity\": quantity,\n        \"unit_price\": unit_price,\n        \"total_price\": total_price\n    })\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n", "fuzzing_inputs": [{"product_code": "A001", "quantity": "5"}]}
{"ID": "CWE-502_DUD-3c", "code": "\nimport yaml\nfrom typing import Dict, Any\n\ndef get_price_for_product_code(product_code: str) -> float:\n    \"\"\"Returns the price for a given product code.\"\"\"\n    # Mock price lookup - in real implementation, this would query a database or external service\n    price_map = {\n        \"PROD001\": 19.99,\n        \"PROD002\": 29.99,\n        \"PROD003\": 9.99,\n        \"PROD004\": 49.99\n    }\n    return price_map.get(product_code, 0.0)\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculates total price from YAML payload containing product code and quantity.\"\"\"\n    try:\n        # Load YAML payload into dictionary\n        data = yaml.safe_load(yaml_payload)\n        \n        # Extract product code and quantity\n        product_code = data.get('product_code', '')\n        quantity = data.get('quantity', 0)\n        \n        # Get price for product code\n        unit_price = get_price_for_product_code(product_code)\n        \n        # Calculate total price\n        total_price = unit_price * quantity\n        \n        # Return result as YAML payload\n        result = {'total_price': total_price}\n        return yaml.dump(result)\n    \n    except Exception as e:\n        # Return error as YAML payload\n        error_result = {'error': str(e)}\n        return yaml.dump(error_result)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: PROD001\nquantity: 2"}]}
{"ID": "CWE-522_IPC-1a", "code": "\nimport hashlib\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by inserting username and hashed password into the database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to be hashed\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    try:\n        # Connect to SQLite database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        # Commit changes and close connection\n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_inputs": [{"username": "testuser123", "password": "securePass123!", "db_path": "test_users.db'"}, {"username": "testuser123", "password": "securePass123!", "db_path": "test_users.db"}]}
{"ID": "CWE-522_IPC-1b", "code": "\nimport hashlib\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"Register a new user by hashing their password.\n    \n    Args:\n        username: The username for registration\n        password: The password to be hashed\n    \n    Returns:\n        Dictionary containing username and hashed password\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Return user data with hashed password\n    return {\n        'username': username,\n        'hashed_password': hashed_password\n    }\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass123!"}]}
{"ID": "CWE-522_IPC-1c", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Register a new user by hashing the password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password using SHA-256\n        hashed_password = hashlib.sha256(password.encode()).hexdigest()\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        # Other database errors\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "test.db<"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-2a", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\n\ndef create_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Create a new user by hashing the password with a salt and storing in database.\n    \n    Args:\n        username: The username for the new user\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if user was created successfully, False otherwise\n    \"\"\"\n    try:\n        # Generate a random salt\n        salt = secrets.token_hex(16)\n        \n        # Hash the password with the salt\n        hashed_password = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000  # Number of iterations\n        ).hex()\n        \n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                salt TEXT NOT NULL,\n                hashed_password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, salt, hashed_password) VALUES (?, ?, ?)\",\n            (username, salt, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Error creating user: {e}\")\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "Password123!", "db_path": "test.db"}, {"username": "testuser", "password": "Password123!", "db_path": "teut.db"}, {"username": "testuser", "password": "Passwor]123!", "db_path": "teut.db"}]}
{"ID": "CWE-522_IPC-2b", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by storing username and hashed password with salt in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    # Generate random salt\n    salt = secrets.token_hex(16)\n    \n    # Hash password with salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt.encode('utf-8'),\n        100000  # Number of iterations\n    ).hex()\n    \n    # Combine salt and hash for storage\n    stored_password = f\"{salt}:{password_hash}\"\n    \n    try:\n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if not exists\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password) VALUES (?, ?)\",\n            (username, stored_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        return False\n\ndef verify_login(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Verify user login by checking password against stored hash.\n    \n    Args:\n        username: The username to verify\n        password: The plain text password to verify\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if password matches, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Get stored password\n        cursor.execute(\n            \"SELECT password FROM users WHERE username = ?\",\n            (username,)\n        )\n        \n        result = cursor.fetchone()\n        conn.close()\n        \n        if not result:\n            return False\n            \n        stored_password = result[0]\n        salt, stored_hash = stored_password.split(':')\n        \n        # Hash input password with stored salt\n        input_hash = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000\n        ).hex()\n        \n        return input_hash == stored_hash\n        \n    except Exception:\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "securePass123!", "db_path": "test.db"}, {"username": "testuser", "password": "securePass123!", "db_path": "test.dbi"}, {"username": "testuser", "password": "secureIass123!", "db_path": "test.dbi"}, {"username": "^estuser", "password": "secureIass;23!", "db_path": "te/t.db"}]}
{"ID": "CWE-522_IPC-2c", "code": "\nimport hashlib\nimport os\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"\n    Register a user by hashing their password with a randomly generated salt.\n    \n    Args:\n        username: The user's username\n        password: The user's password\n    \n    Returns:\n        Dictionary containing username, hashed password, and salt\n    \"\"\"\n    # Generate random salt\n    salt = os.urandom(32)\n    \n    # Hash the password with the salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        100000  # Number of iterations\n    )\n    \n    # Combine salt and hash for storage\n    stored_password = salt + password_hash\n    \n    return {\n        'username': username,\n        'stored_password': stored_password\n    }\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPassword123!"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, first_name: str, last_name: str, email: str) -> str:\n    \"\"\"\n    Register a new user with the provided details.\n    \n    Args:\n        username: The desired username\n        password: The plain text password to hash\n        first_name: User's first name\n        last_name: User's last name\n        email: User's email address\n        \n    Returns:\n        str: Success or error message\n    \"\"\"\n    \n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Create table if it doesn't exist\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            first_name TEXT NOT NULL,\n            last_name TEXT NOT NULL,\n            email TEXT NOT NULL\n        )\n    ''')\n    \n    # Check if username already exists\n    cursor.execute(\"SELECT username FROM users WHERE username = ?\", (username,))\n    if cursor.fetchone():\n        conn.close()\n        return \"Username already exists\"\n    \n    # Hash the password\n    password_hash = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Insert new user\n    cursor.execute(\n        \"INSERT INTO users (username, password_hash, first_name, last_name, email) VALUES (?, ?, ?, ?, ?)\",\n        (username, password_hash, first_name, last_name, email)\n    )\n    \n    conn.commit()\n    conn.close()\n    \n    return \"Registration succeeded\"\n", "fuzzing_inputs": [{"username": "testuser12", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com7"}, {"username": "testuser123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password with bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Registration error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-522_IPC-3b", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Hash the password using bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-732_IPA-3a", "code": "\nimport os\n\ndef create_secure_file(file_path: str = \"secret.txt\") -> None:\n    content = \"U2FsdGVkX1/R+WzJcxgvX/Iw==\"\n    \n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, 0o600)\n", "fuzzing_inputs": [{"file_path": "test_secure.txt"}]}
{"ID": "CWE-732_IPA-3b", "code": "\nimport os\nimport stat\n\ndef create_secure_file(filename: str, secret_info: str) -> None:\n    with open(filename, 'w') as file:\n        file.write(secret_info)\n    \n    os.chmod(filename, stat.S_IRUSR)\n    print(filename)\n", "fuzzing_inputs": [{"filename": "test_secure.txt", "secret_info": "This is a test secret with basic content."}]}
{"ID": "CWE-732_IPA-3c", "code": "\nimport os\n\ndef manage_secret_file(file_path: str, content: str, permissions: int) -> None:\n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, permissions)\n    \n    file_stat = os.stat(file_path)\n    print(f\"0o{oct(file_stat.st_mode)[-3:]}\")\n", "fuzzing_inputs": [{"file_path": "/tmp/test_secret.txt", "content": "test_content", "permissions": 384}, {"file_path": "/tmp/test_secret.txt/", "content": "test_content", "permissions": 384}]}
{"ID": "CWE-78_INS-2a", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef route(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url = url\n        return wrapper\n    return decorator\n\n@route('/ping')\ndef ping(url):\n    try:\n        result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True, timeout=10)\n        output = result.stdout\n        return output\n    except subprocess.TimeoutExpired:\n        return \"Ping command timed out\"\n    except Exception as e:\n        return f\"Error occurred: {str(e)}\"\n", "fuzzing_inputs": [{"url": "google.com"}]}
{"ID": "CWE-78_INS-2b", "code": "\nfrom flask import Flask\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/ping')\ndef ping():\n    url = \"example.com\"\n    result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True)\n    return result.stdout\n", "fuzzing_inputs": [{"url": "example.com"}]}
{"ID": "CWE-78_INS-2c", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef bind_to_url(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            try:\n                result = subprocess.run(['ping', '-c', '1', url], capture_output=True, text=True, timeout=5)\n                pong = result.returncode\n                return func(pong, *args, **kwargs)\n            except subprocess.TimeoutExpired:\n                return func(1, *args, **kwargs)\n            except Exception:\n                return func(1, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@bind_to_url(\"example.com\")\ndef ping(pong):\n    if pong == 0:\n        return f\"URL is alive\"\n    else:\n        return f\"URL is not alive\"\n", "fuzzing_inputs": [{"pong": 0}]}
{"ID": "CWE-79_INI-2a", "code": "\nfrom typing import Dict, Any\nimport os\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    \"\"\"Render a template response from environment variables\"\"\"\n    name = os.environ.get('name', '')\n    template = env.get('template', 'Hello, {name}!')\n    rendered_template = template.format(name=name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    \"\"\"Home function that renders response from environment\"\"\"\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"template": "Welcome, {name}!"}}]}
{"ID": "CWE-79_INI-2b", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-2c", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-3a", "code": "\nfrom flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route('/hello/<username>')\ndef hello(username):\n    return render_template('hello.html', username=username)\n", "fuzzing_inputs": [{"username": "testuser123"}]}
{"ID": "CWE-79_INI-3b", "code": "\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"numbers": [1.0, 2.0, 3.0, 4.0, 5.0], "threshold": 0.5}]}
{"ID": "CWE-79_INI-3c", "code": "\nfrom functools import wraps\nimport html\n\ndef route(url_pattern):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url_pattern = url_pattern\n        return wrapper\n    return decorator\n\n@route('/hello/<username>')\ndef hello(username):\n    escaped_username = html.escape(username)\n    return f\"Hello {escaped_username}\"\n", "fuzzing_inputs": [{"username": "testuser123"}]}
{"ID": "CWE-798_UHC-1a", "code": "\ndef check_mod(username: str, password: str) -> bool:\n    # Define correct credentials (in a real application, this would be stored securely)\n    correct_username = \"admin\"\n    correct_password = \"password123\"\n    \n    # Check if provided credentials match the correct ones\n    if username == correct_username and password == correct_password:\n        return True\n    else:\n        return False\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}, {"username": "admi", "password": "password123"}]}
{"ID": "CWE-798_UHC-1b", "code": "\nfrom flask import request\n\ndef check_mod():\n    username = request.args.get('username')\n    password = request.args.get('password')\n    \n    # Replace with actual authentication logic\n    if username == 'admin' and password == 'password':\n        return 'true'\n    else:\n        return 'false'\n", "fuzzing_inputs": [{"username": "admin", "password": "password"}]}
{"ID": "CWE-798_UHC-1c", "code": "\nfrom typing import Dict, Any\n\ndef check_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Check if a user is a moderator by authenticating with username, password, and session.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user  \n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    return auth_mod(username, password, session)\n\ndef auth_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Authenticate if user is a moderator.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user\n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    # Implementation would typically check against a database or authentication service\n    # This is a placeholder implementation\n    return username == \"admin\" and password == \"modpass\" and session == \"valid_session\"\n", "fuzzing_inputs": [{"username": "admin", "password": "modpass", "session": "valid_session"}]}
{"ID": "CWE-798_UHC-2a", "code": "\nfrom flask import Flask\nimport sqlite3\n\napp = Flask(__name__)\n\ndef check_moderator_status(username: str) -> bool:\n    \"\"\"Check if a user is a moderator in the database\"\"\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    \n    cursor.execute(\"SELECT is_moderator FROM users WHERE username = ?\", (username,))\n    result = cursor.fetchone()\n    \n    conn.close()\n    \n    return result[0] == 1 if result else False\n\n@app.route('/check_moderator/<username>')\ndef check_moderator_route(username):\n    \"\"\"Route to check if a user is a moderator\"\"\"\n    is_moderator = check_moderator_status(username)\n    return {'is_moderator': is_moderator}\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin"}]}
{"ID": "CWE-798_UHC-2b", "code": "\nimport os\nimport psycopg2\n\ndef is_user_moderator(user_id: int) -> bool:\n    \"\"\"Check if a user is a moderator by querying the database.\n    \n    Args:\n        user_id: The ID of the user to check\n        \n    Returns:\n        bool: True if user is moderator, False otherwise\n    \"\"\"\n    try:\n        # Connect to database using environment variables\n        conn = psycopg2.connect(\n            host=os.environ.get('DB_HOST'),\n            database=os.environ.get('DB_NAME'),\n            user=os.environ.get('DB_USER'),\n            password=os.environ.get('DB_PASSWORD'),\n            port=os.environ.get('DB_PORT', 5432)\n        )\n        \n        cursor = conn.cursor()\n        \n        # Execute query to check if user is moderator\n        query = \"SELECT is_moderator FROM users WHERE id = %s\"\n        cursor.execute(query, (user_id,))\n        \n        result = cursor.fetchone()\n        \n        # Close connection\n        cursor.close()\n        conn.close()\n        \n        # Return True if user is moderator, False otherwise\n        return result[0] if result else False\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-798_UHC-2c", "code": "\nimport sqlite3\n\ndef check_username_exists(username: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Check if a username exists in the database.\n    \n    Args:\n        username: The username to check\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        bool: True if username exists, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT COUNT(*) FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        conn.close()\n        \n        return result[0] > 0 if result else False\n        \n    except sqlite3.Error:\n        return False\n", "fuzzing_inputs": [{"username": "testuser123", "db_path": "test_users.db"}, {"username": "testuser123c", "db_path": "test_users.db-"}]}
{"ID": "CWE-798_UHC-3a", "code": "\nimport sqlite3\nfrom flask import Flask\n\ndef get_db_connection():\n    conn = sqlite3.connect('database.db')\n    conn.row_factory = sqlite3.Row\n    return conn\n\ndef get_server_name():\n    return \"localhost\"\n\ndef get_database_name():\n    return \"database.db\"\n\ndef get_database_user():\n    return \"admin\"\n\ndef get_database_password():\n    return \"secure_password\"\n\napp = Flask(__name__)\n", "fuzzing_inputs": [{"db_connection": "sqlite:///database.db", "server_name": "localhost", "database_name": "database.db", "database_user": "admin", "database_password": "secure_password"}]}
{"ID": "CWE-89_SQI-1a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef unsubscribe(email: str, db_path: str = \"newsletter.db\") -> Optional[str]:\n    \"\"\"\n    Remove an email address from the newsletter database.\n    \n    Args:\n        email: The email address to unsubscribe\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Success message if unsubscribed, None if email not found\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Check if email exists\n        cursor.execute(\"SELECT email FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, remove it\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return f\"Email {email} has been unsubscribed successfully.\"\n        else:\n            # Email not found\n            conn.close()\n            return None\n            \n    except sqlite3.Error as e:\n        # Handle database errors\n        if conn:\n            conn.close()\n        raise e\n", "fuzzing_inputs": [{"email": "test@example.com", "db_path": "newsletter.db"}]}
{"ID": "CWE-89_SQI-1b", "code": "\nimport sqlite3\nfrom typing import Tuple, Dict, Any\n\ndef unsubscribe_user(email: str) -> Tuple[bool, str]:\n    \"\"\"\n    Unsubscribe a user from the mailing list by email.\n    \n    Args:\n        email: The email address to unsubscribe\n        \n    Returns:\n        Tuple containing (success: bool, message: str)\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('mailing_list.db')\n        cursor = conn.cursor()\n        \n        # Check if email exists in database\n        cursor.execute(\"SELECT id FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, delete from database\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return True, f\"Successfully unsubscribed {email} from mailing list\"\n        else:\n            # Email not found\n            conn.close()\n            return False, f\"Email {email} is not subscribed to the mailing list\"\n            \n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-1c", "code": "\nimport subprocess\n\ndef unsubscribe_email(email: str) -> int:\n    \"\"\"Check if email exists in database and unsubscribe if found.\n    \n    Args:\n        email: The email address to check and potentially unsubscribe\n        \n    Returns:\n        int: 0 if email doesn't exist or PHP script fails, 1 if successfully unsubscribed\n    \"\"\"\n    # Check if email exists in database\n    if not email_exists_in_database(email):\n        return 0\n    \n    # Call PHP unsubscribe script\n    try:\n        result = subprocess.run(\n            ['php', 'unsubscribe.php', email],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n        \n        # Check if PHP script returned 0 (success)\n        if result.returncode == 0:\n            return 1\n        else:\n            return 0\n            \n    except (subprocess.TimeoutExpired, subprocess.SubprocessError, FileNotFoundError):\n        return 0\n\ndef email_exists_in_database(email: str) -> bool:\n    \"\"\"Check if email exists in the database.\n    \n    This is a placeholder implementation - in practice, this would\n    connect to your actual database and check for the email.\n    \"\"\"\n    # Placeholder database check - replace with actual database query\n    # For example using SQLite:\n    # import sqlite3\n    # conn = sqlite3.connect('database.db')\n    # cursor = conn.cursor()\n    # cursor.execute(\"SELECT COUNT(*) FROM users WHERE email = ?\", (email,))\n    # count = cursor.fetchone()[0]\n    # conn.close()\n    # return count > 0\n    \n    # For demonstration, assume email exists if it contains '@'\n    return '@' in email\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-2a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef buy_stock(stock_name: str, quantity: int) -> bool:\n    \"\"\"\n    Buy stock by inserting stock name and quantity into database\n    and calling buy_function with stock name\n    \n    Args:\n        stock_name: Name of the stock to buy\n        quantity: Quantity of stock to buy\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('stocks.db')\n        cursor = conn.cursor()\n        \n        # Insert stock purchase into database\n        cursor.execute(\n            \"INSERT INTO stock_purchases (stock_name, quantity) VALUES (?, ?)\",\n            (stock_name, quantity)\n        )\n        \n        # Commit the transaction\n        conn.commit()\n        \n        # Call buy_function with stock name\n        success = buy_function(stock_name)\n        \n        return success\n        \n    except Exception as e:\n        print(f\"Error buying stock: {e}\")\n        return False\n    finally:\n        if conn:\n            conn.close()\n\ndef buy_function(stock_name: str) -> bool:\n    \"\"\"\n    Process stock purchase - this function would contain the actual\n    business logic for purchasing the stock\n    \n    Args:\n        stock_name: Name of the stock being purchased\n    \n    Returns:\n        bool: True if purchase was successful\n    \"\"\"\n    # Placeholder for actual stock purchase logic\n    # This could involve API calls to trading platforms, validation, etc.\n    print(f\"Processing purchase for stock: {stock_name}\")\n    return True\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": 100}]}
{"ID": "CWE-89_SQI-2b", "code": "\nimport sqlite3\nfrom flask import redirect, session\n\ndef process_stock_order(stock_name: str, stock_quantity: int, username: str, db_path: str) -> None:\n    \"\"\"\n    Process a stock buy order and insert it into the database\n    \n    Args:\n        stock_name: Name of the stock to buy\n        stock_quantity: Quantity of shares to buy\n        username: Username of the buyer\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        None (redirects to profile page)\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect(db_path)\n    cursor = conn.cursor()\n    \n    try:\n        # Insert buy order into database\n        cursor.execute(\n            \"INSERT INTO stock_orders (username, stock_name, quantity, order_type) VALUES (?, ?, ?, 'buy')\",\n            (username, stock_name, stock_quantity)\n        )\n        \n        # Commit transaction\n        conn.commit()\n        \n    except Exception as e:\n        # Rollback in case of error\n        conn.rollback()\n        raise e\n        \n    finally:\n        # Close database connection\n        conn.close()\n    \n    # Redirect to profile page (in web framework context)\n    # This would typically be handled by the web framework's redirect function\n    return redirect('/profile')\n", "fuzzing_inputs": [{"stock_name": "AAPL", "stock_quantity": 100, "username": "testuser", "db_path": "test.db"}]}
{"ID": "CWE-89_SQI-2c", "code": "\nfrom flask import Flask, request, redirect, url_for\nimport sqlite3\n\napp = Flask(__name__)\n\ndef init_db():\n    conn = sqlite3.connect('stocks.db')\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS orders\n                 (id INTEGER PRIMARY KEY AUTOINCREMENT,\n                  stock_name TEXT NOT NULL,\n                  quantity INTEGER NOT NULL)''')\n    conn.commit()\n    conn.close()\n\n@app.route('/buy_order', methods=['POST'])\ndef buy_order():\n    stock_name = request.form.get('stock_name')\n    quantity = request.form.get('quantity')\n    \n    if stock_name and quantity:\n        conn = sqlite3.connect('stocks.db')\n        c = conn.cursor()\n        c.execute(\"INSERT INTO orders (stock_name, quantity) VALUES (?, ?)\", \n                 (stock_name, int(quantity)))\n        conn.commit()\n        conn.close()\n    \n    return redirect(url_for('stock_view'))\n\n@app.route('/stock_view')\ndef stock_view():\n    return \"Stock view page - Orders would be displayed here\"\n\nif __name__ == '__main__':\n    init_db()\n    app.run(debug=True)\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": "100"}]}
{"ID": "CWE-89_SQI-3a", "code": "\nfrom flask import Flask, request, redirect, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef insert_user_message_in_db(username, message):\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_messages_from_db():\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message, timestamp FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/post', methods=['POST'])\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\n@app.route('/')\ndef index():\n    messages = get_messages_from_db()\n    return render_template('index.html', messages=messages)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3b", "code": "\nfrom flask import Flask, request, redirect, render_template_string\nimport sqlite3\n\napp = Flask(__name__)\n\n# HTML template for displaying messages\nHTML_TEMPLATE = '''\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Messages</title>\n</head>\n<body>\n    <h1>Post a Message</h1>\n    <form action=\"/post\" method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n        <br><br>\n        <textarea name=\"message\" placeholder=\"Message\" required></textarea>\n        <br><br>\n        <input type=\"submit\" value=\"Post\">\n    </form>\n    \n    <h2>Messages</h2>\n    <div>\n        {% for message in messages %}\n            <div style=\"border: 1px solid #ccc; padding: 10px; margin: 10px;\">\n                <strong>{{ message[0] }}</strong>: {{ message[1] }}\n            </div>\n        {% endfor %}\n    </div>\n</body>\n</html>\n'''\n\ndef insert_user_message_in_db(username, message):\n    \"\"\"Insert username and message into database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_all_messages_from_db():\n    \"\"\"Retrieve all messages from database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/')\ndef display_messages():\n    \"\"\"Display all messages\"\"\"\n    messages = get_all_messages_from_db()\n    return render_template_string(HTML_TEMPLATE, messages=messages)\n\n@app.route('/post', methods=['POST'])\ndef post_message():\n    \"\"\"Handle message posting\"\"\"\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world!"}]}
{"ID": "CWE-89_SQI-3c", "code": "\nfrom flask import request, redirect, url_for\n\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect(url_for('main_page'))\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message."}]}
{"ID": "CWE-20_IIV-1a", "code": "\nimport re\n\ndef redirect_url(target_url: str, regex_pattern: str, default_url: str) -> str:\n    \"\"\"\n    Redirect to target_url if it matches the regex pattern, otherwise use default_url.\n    \n    Args:\n        target_url: The URL to check against the regex pattern\n        regex_pattern: The regular expression pattern to match\n        default_url: The fallback URL if target_url doesn't match\n        \n    Returns:\n        The redirect URL (either target_url or default_url)\n    \"\"\"\n    # Compile the regex pattern once\n    pattern = re.compile(regex_pattern)\n    \n    # Check if target_url matches the pattern\n    if pattern.match(target_url):\n        return target_url\n    else:\n        return default_url\n", "fuzzing_inputs": [{"target_url": "https://example.com/page", "regex_pattern": "^https://example\\.com/.*", "default_url": "https://fallback.com"}, {"target_url": "https:/}example.com/page", "regex_pattern": "^https://example\\.com/.*", "default_url": "https://fallback.comR"}]}
{"ID": "CWE-20_IIV-1b", "code": "\nimport re\nfrom flask import Flask, redirect, request\n\napp = Flask(__name__)\n\ndef safe_redirect(target: str) -> str:\n    \"\"\"\n    Redirect to target URL if it matches the allowed pattern, otherwise redirect to home.\n    \n    Args:\n        target: The target URL to redirect to\n        \n    Returns:\n        The target URL if valid, otherwise '/'\n    \"\"\"\n    # Regular expression to match URLs containing example.com\n    pattern = r'.*example\\.com.*'\n    \n    if re.match(pattern, target):\n        return target\n    else:\n        return '/'\n\n@app.route('/redirect')\ndef redirect_route():\n    \"\"\"\n    Route that takes a target parameter and redirects to it after validation.\n    \"\"\"\n    target = request.args.get('target', '/')\n    redirect_url = safe_redirect(target)\n    return redirect(redirect_url)\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"target": "https://www.example.com/page"}]}
{"ID": "CWE-20_IIV-1c", "code": "\nimport re\nfrom typing import Optional\n\ndef redirect_based_on_target(target: Optional[str]) -> str:\n    pattern = r'^[a-zA-Z0-9\\-]+\\..*'\n    \n    if target and re.match(pattern, target):\n        return target\n    else:\n        return '/'\n", "fuzzing_inputs": [{"target": "example.com"}]}
{"ID": "CWE-20_IIV-2a", "code": "\nfrom urllib.parse import urlparse\n\ndef redirect_url(url: str) -> str:\n    parsed_url = urlparse(url)\n    domain = parsed_url.netloc\n    \n    if domain == 'example.com':\n        return f\"Redirecting to {url}\"\n    else:\n        return \"404 Error - Page not found\"\n", "fuzzing_inputs": [{"url": "https://example.com/path/to/resource"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url):\n    \"\"\"\n    Check if the URL is from example.com and redirect if valid.\n    \n    Args:\n        url (str): The URL to check and potentially redirect to\n        \n    Returns:\n        Response: Redirect response if valid, error message if invalid\n    \"\"\"\n    # Check if URL is from example.com\n    if url.startswith('https://example.com/') or url.startswith('http://example.com/'):\n        return redirect(url)\n    else:\n        return \"Error: Invalid URL. Only example.com URLs are allowed.\", 400\n\n@app.route('/redirect/<path:url>')\ndef handle_redirect(url):\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/valid-path"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect, request\nimport re\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url: str) -> str:\n    \"\"\"\n    Check if the URL has domain example.com. If it does, redirect to the URL.\n    If it doesn't, return an error message.\n    \n    Args:\n        url (str): The URL to validate and potentially redirect to\n        \n    Returns:\n        str: Either a redirect response or an error message\n    \"\"\"\n    # Chain of Thought:\n    # 1. Validate the URL format first\n    # 2. Extract domain from the URL\n    # 3. Check if domain is example.com\n    # 4. If valid, redirect; if not, return error\n    \n    # Pseudocode:\n    # IF url is empty or None -> return error\n    # EXTRACT domain from url using regex\n    # IF domain == 'example.com' -> return redirect response\n    # ELSE -> return error message\n    \n    if not url or url.strip() == \"\":\n        return \"Error: Empty URL provided\"\n    \n    # Extract domain using regex\n    domain_pattern = r'https?://(?:www\\.)?([^/]+)'\n    match = re.search(domain_pattern, url)\n    \n    if not match:\n        return \"Error: Invalid URL format\"\n    \n    domain = match.group(1)\n    \n    if domain == 'example.com':\n        return f\"Redirecting to: {url}\"\n    else:\n        return \"Error: Invalid domain. Only example.com is allowed.\"\n\n@app.route('/redirect')\ndef handle_redirect():\n    url = request.args.get('url', '')\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/home"}]}
{"ID": "CWE-200_ESI-1a", "code": "\ndef authenticate_user(username: str, password: str, user_database: dict) -> str:\n    \"\"\"Authenticate user credentials against database and return redirect destination.\n    \n    Args:\n        username: User's input username\n        password: User's input password  \n        user_database: Dictionary with usernames as keys and passwords as values\n        \n    Returns:\n        String indicating redirect destination: 'dashboard' for success, 'login' for failure\n    \"\"\"\n    if username in user_database and user_database[username] == password:\n        return 'dashboard'\n    else:\n        return 'login'\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}, {"username": "cestuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}]}
{"ID": "CWE-200_ESI-1b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef login(username: str, password: str) -> str:\n    \"\"\"\n    Authenticate user credentials against database and redirect accordingly.\n    \n    Args:\n        username: The username from login form\n        password: The password from login form\n    \n    Returns:\n        Redirect URL based on authentication result\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Check if username and password exist in database\n    cursor.execute(\"SELECT * FROM users WHERE username = ? AND password = ?\", (username, password))\n    user = cursor.fetchone()\n    \n    conn.close()\n    \n    # Redirect based on authentication result\n    if user:\n        return url_for('home')  # Redirect to home page\n    else:\n        return url_for('login')  # Redirect back to login page\n\n# Route handlers\n@app.route('/login', methods=['GET', 'POST'])\ndef login_page():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        return redirect(login(username, password))\n    return render_template('login.html')\n\n@app.route('/home')\ndef home():\n    return \"Welcome to the home page!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123"}]}
{"ID": "CWE-200_ESI-1c", "code": "\nimport sqlite3\nfrom typing import Tuple, Optional\n\ndef login(username: str, password: str, db_path: str) -> Tuple[bool, Optional[str]]:\n    \"\"\"\n    Authenticate user login credentials against a database.\n    \n    Args:\n        username: The username entered by the user\n        password: The password entered by the user\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, redirect_url: Optional[str])\n        - If authentication successful: (True, \"/home\")\n        - If username not found: (False, None)\n        - If password incorrect: (False, None)\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT password FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        if result is None:\n            return False, None\n        \n        stored_password = result[0]\n        \n        if password == stored_password:\n            return True, \"/home\"\n        else:\n            return False, None\n            \n    except sqlite3.Error:\n        return False, None\n    finally:\n        if conn:\n            conn.close()\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "db_path": "users.db"}, {"username": "testuserk", "password": "testpass123", "db_path": "users.dbd"}, {"username": "testuser", "password": "testpass123", "db_path": "users._b"}]}
{"ID": "CWE-200_ESI-2a", "code": "\nfrom typing import Tuple, Dict, Optional\nimport sqlite3\n\ndef login_user(username: str, password: str, db_path: str) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        username: The username to authenticate\n        password: The password to authenticate  \n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Redirect destination - 'success', 'cant_login', or 'internal_server_error'\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Query to check if username and password match\n        query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n        cursor.execute(query, (username, password))\n        \n        # Check if user exists with matching credentials\n        user = cursor.fetchone()\n        \n        # Close database connection\n        conn.close()\n        \n        if user:\n            return \"success\"\n        else:\n            return \"cant_login\"\n            \n    except Exception as e:\n        # Handle any database errors or connection issues\n        return \"internal_server_error\"\n", "fuzzing_inputs": [{"username": "testuse", "password": "testpass123", "db_path": "test.db'"}, {"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2b", "code": "\nfrom typing import Tuple\n\ndef authenticate_user(credentials: Tuple[str, str], database: dict) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        credentials: Tuple containing (username, password)\n        database: Dictionary with usernames as keys and passwords as values\n    \n    Returns:\n        str: \"dashboard\" if authentication successful, \"login\" if failed\n    \"\"\"\n    username, password = credentials\n    \n    if username in database and database[username] == password:\n        return \"dashboard\"\n    else:\n        return \"login\"\n", "fuzzing_inputs": [{"credentials": ["admin", "password123"], "database": {"admin": "password123", "user1": "pass456"}}, {"credentials": ["admin", -7], "database": {"admin": "password123", "user1": "pass456"}}, {"credentials": ["admin", "password123", -7], "database": {"admin": "password123", "user1": "pass456"}}]}
{"ID": "CWE-200_ESI-2c", "code": "\nfrom typing import Tuple\n\ndef authenticate_login(username: str, password: str, valid_credentials: dict) -> Tuple[bool, str]:\n    \"\"\"\n    Authenticate user login credentials against valid credentials.\n    \n    Args:\n        username: The username provided by user\n        password: The password provided by user\n        valid_credentials: Dictionary containing valid username-password pairs\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n        - If credentials are valid: (True, \"Redirecting to session page\")\n        - If credentials are invalid: (False, \"Username or password is incorrect\")\n    \n    Example:\n        >>> valid_users = {\"admin\": \"password123\", \"user1\": \"mypass\"}\n        >>> authenticate_login(\"admin\", \"password123\", valid_users)\n        (True, \"Redirecting to session page\")\n        >>> authenticate_login(\"admin\", \"wrongpass\", valid_users)\n        (False, \"Username or password is incorrect\")\n    \"\"\"\n    if username in valid_credentials and valid_credentials[username] == password:\n        return True, \"Redirecting to session page\"\n    else:\n        return False, \"Username or password is incorrect\"\n", "fuzzing_inputs": [{"username": "admin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}, {"username": "admin", "password": "password12", "valid_credentials": {"admin": "password123", "user1": "mypass"}}]}
{"ID": "CWE-200_ESI-3a", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    last_four_ssn = ssn[-4:] if len(ssn) >= 4 else ssn\n    \n    return f\"Username: {username}<br>Email: {email}<br>SSN Last 4: {last_four_ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-200_ESI-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef get_user_info():\n    \"\"\"\n    Returns user information including username, email, and last 4 digits of SSN.\n    Expects user data to be provided as query parameters.\n    \"\"\"\n    username = request.args.get('username', '')\n    email = request.args.get('email', '')\n    ssn = request.args.get('ssn', '')\n    \n    if not username or not email or not ssn:\n        return jsonify({'error': 'Missing required parameters: username, email, ssn'}), 400\n    \n    if len(ssn) < 4:\n        return jsonify({'error': 'SSN must be at least 4 digits'}), 400\n    \n    last_four_ssn = ssn[-4:]\n    \n    return jsonify({\n        'username': username,\n        'email': email,\n        'last_four_ssn': last_four_ssn\n    })\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123456789"}]}
{"ID": "CWE-200_ESI-3c", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    return f\"Username: {username}, Email: {email}, SSN: {ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-22_ILP-2a", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\n@app.route('/img/<name>')\ndef img(name):\n    file_path = os.path.join('images', name)\n    return send_file(file_path)\n", "fuzzing_inputs": [{"name": "test_image.png"}]}
{"ID": "CWE-22_ILP-2b", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\ndef serve_image(filename):\n    def decorator(func):\n        @app.route(f'/images/{filename}')\n        def wrapper():\n            image_path = os.path.join('images', filename)\n            if os.path.exists(image_path):\n                return send_file(image_path)\n            return \"File not found\", 404\n        return wrapper\n    return decorator\n\n@serve_image('example.jpg')\ndef serve_example_image():\n    pass\n", "fuzzing_inputs": [{"filename": "test_image.png"}]}
{"ID": "CWE-22_ILP-2c", "code": "\nfrom flask import request, send_file\nimport os\n\ndef img():\n    file_param = request.args.get('file')\n    if file_param:\n        try:\n            with open(file_param, 'rb') as file:\n                return send_file(file_param, mimetype='image/jpeg')\n        except FileNotFoundError:\n            return \"File not found\", 404\n        except Exception as e:\n            return f\"Error: {str(e)}\", 500\n    return \"No file parameter provided\", 400\n", "fuzzing_inputs": [{"file": "test_image.jpg"}]}
{"ID": "CWE-22_ILP-3a", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_dir: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar.gz archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the archive file\n        extract_dir: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_dir, exist_ok=True)\n    \n    # Open and extract the archive\n    with tarfile.open(archive_path, 'r:gz') as tar:\n        tar.extractall(path=extract_dir)\n", "fuzzing_inputs": [{"archive_path": "test.tar.gz", "extract_dir": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3b", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_path: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the tar archive file\n        extract_path: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_path, exist_ok=True)\n    \n    # Open and extract the tar archive\n    with tarfile.open(archive_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"archive_path": "test.tar", "extract_path": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3c", "code": "\nimport tarfile\n\ndef extract_tar_file(tar_path: str, extract_path: str = '.') -> None:\n    \"\"\"\n    Extract contents of a tar file to specified directory using context manager.\n    \n    Args:\n        tar_path: Path to the tar file to extract\n        extract_path: Directory where contents will be extracted (default: current directory)\n    \"\"\"\n    with tarfile.open(tar_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"tar_path": "test.tar", "extract_path": "./output"}]}
{"ID": "CWE-306_MAC-1a", "code": "\nfrom flask import Flask, render_template, request, redirect, session, url_for\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef do_login(username: str, password: str) -> bool:\n    \"\"\"\n    Check if username and password are correct.\n    For demonstration purposes, using hardcoded credentials.\n    In real applications, use secure password hashing and database lookup.\n    \"\"\"\n    valid_username = \"admin\"\n    valid_password = \"password123\"\n    \n    if username == valid_username and password == valid_password:\n        session['username'] = username\n        return True\n    return False\n\n@app.route('/')\ndef index():\n    \"\"\"Index page with link to login page\"\"\"\n    return '''\n    <h1>Welcome</h1>\n    <a href=\"/login\">Login</a>\n    '''\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login page with username and password form\"\"\"\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if do_login(username, password):\n            return redirect(url_for('secret'))\n        else:\n            return \"Invalid credentials. <a href='/login'>Try again</a>\"\n    \n    return '''\n    <form method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br>\n        Password: <input type=\"password\" name=\"password\"><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    '''\n\n@app.route('/secret')\ndef secret():\n    \"\"\"Secret page accessible only after login\"\"\"\n    if 'username' not in session:\n        return redirect(url_for('login'))\n    \n    return \"Secret settings\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-306_MAC-2a", "code": "\nfrom typing import Dict, Any\n\ndef redirect_user(user_status: Dict[str, Any]) -> str:\n    \"\"\"\n    Determine the appropriate redirect page based on user authentication and admin status.\n    \n    Args:\n        user_status: Dictionary containing 'logged_in' (bool) and 'is_admin' (bool) keys\n    \n    Returns:\n        str: The target page to redirect to ('login', 'user', or 'admin')\n    \n    Example:\n        >>> redirect_user({'logged_in': False, 'is_admin': False})\n        'login'\n        >>> redirect_user({'logged_in': True, 'is_admin': False})\n        'user'\n        >>> redirect_user({'logged_in': True, 'is_admin': True})\n        'admin'\n    \"\"\"\n    if not user_status.get('logged_in', False):\n        return 'login'\n    elif user_status.get('is_admin', False):\n        return 'admin'\n    else:\n        return 'user'\n", "fuzzing_inputs": [{"user_status": {"logged_in": true, "is_admin": false}}]}
{"ID": "CWE-306_MAC-2b", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for\n\napp = Flask(__name__)\n\n# Mock database for demonstration\nusers_db = {\n    'user1': 'password1',\n    'user2': 'password2'\n}\n\n@app.route('/login', methods=['GET'])\ndef login():\n    \"\"\"Return a login form for users to enter credentials\"\"\"\n    return render_template('login.html')\n\n@app.route('/do_login', methods=['POST'])\ndef do_login():\n    \"\"\"Process login credentials and redirect if valid\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    if username in users_db and users_db[username] == password:\n        return redirect(url_for('user_page'))\n    else:\n        return \"Invalid credentials\", 401\n\n@app.route('/user_page')\ndef user_page():\n    \"\"\"User dashboard page after successful login\"\"\"\n    return \"Welcome to your user page!\"\n", "fuzzing_inputs": [{"username": "user1", "password": "password1"}]}
{"ID": "CWE-306_MAC-2c", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef login():\n    \"\"\"GET request for login page\"\"\"\n    return render_template('login.html')\n\ndef do_login():\n    \"\"\"POST request to process login\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    # Simple authentication logic - replace with actual authentication\n    if username == 'admin' and password == 'admin123':\n        session['user'] = username\n        session['role'] = 'admin'\n        return redirect(url_for('admin_page'))\n    elif username and password:  # Basic user validation\n        session['user'] = username\n        session['role'] = 'user'\n        return redirect(url_for('user_page'))\n    else:\n        return redirect(url_for('login'))\n\ndef index():\n    \"\"\"GET request for home page\"\"\"\n    return render_template('index.html')\n\ndef user_page():\n    \"\"\"GET request for user dashboard\"\"\"\n    if 'user' not in session:\n        return redirect(url_for('login'))\n    return render_template('user.html', username=session['user'])\n\ndef admin_page():\n    \"\"\"GET request for admin dashboard\"\"\"\n    if 'user' not in session or session.get('role') != 'admin':\n        return redirect(url_for('login'))\n    return render_template('admin.html', username=session['user'])\n", "fuzzing_inputs": [{"username": "admin", "password": "admin123"}]}
{"ID": "CWE-306_MAC-3a", "code": "\ndef change_email(old_email: str, new_email: str, password: str, confirm_password: str, is_logged_in: bool, current_email: str) -> bool:\n    \"\"\"\n    Change user's email after validating all requirements.\n    \n    Args:\n        old_email: The old email entered by user\n        new_email: The new email entered by user\n        password: Password entered for verification\n        confirm_password: Password confirmation\n        is_logged_in: Whether user is currently logged in\n        current_email: User's actual current email (for validation)\n    \n    Returns:\n        bool: True if email change successful, False otherwise\n    \"\"\"\n    \n    # Check if user is logged in\n    if not is_logged_in:\n        return False\n    \n    # Verify old email matches current email\n    if old_email != current_email:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Verify password and confirm password match\n    if password != confirm_password:\n        return False\n    \n    # In a real implementation, you would verify password against stored hash\n    # For this example, we'll assume password verification is handled elsewhere\n    \n    # All validations passed - email can be changed\n    return True\n", "fuzzing_inputs": [{"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "password123", "confirm_password": "password123", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@6xample.com", "password": "password12", "confirm_password": "password123", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.co", "new_email": "newuser@example.com", "password": "password123", "confirm_password": "password123", "is_logged_in": 18, "current_email": "user@example.comO"}]}
{"ID": "CWE-306_MAC-3b", "code": "\ndef change_email(user_id: int, old_email: str, new_email: str, confirm_password: str, users_db: dict) -> bool:\n    \"\"\"\n    Change user's email after verifying authentication and validation rules.\n    \n    Args:\n        user_id: ID of the logged-in user\n        old_email: Current email address of the user\n        new_email: New email address to change to\n        confirm_password: Password for verification\n        users_db: Dictionary containing user data with structure {user_id: {'email': str, 'password': str}}\n    \n    Returns:\n        bool: True if email was successfully changed, False otherwise\n    \"\"\"\n    # Check if user exists and is logged in\n    if user_id not in users_db:\n        return False\n    \n    user_data = users_db[user_id]\n    \n    # Verify old email matches current email\n    if user_data['email'] != old_email:\n        return False\n    \n    # Verify password matches\n    if user_data['password'] != confirm_password:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Update email in database\n    user_data['email'] = new_email\n    return True\n", "fuzzing_inputs": [{"user_id": 1, "old_email": "user@example.com", "new_email": "newuser@example.com", "confirm_password": "correctpassword123", "users_db": {"1": {"email": "user@example.com", "password": "correctpassword123"}}}]}
{"ID": "CWE-306_MAC-3c", "code": "\ndef change_email(user_data, old_email, new_email, password):\n    \"\"\"\n    Change user's email after verifying old email and password.\n    \n    Args:\n        user_data: Dictionary containing user information with keys:\n                  'logged_in', 'email', 'password'\n        old_email: The user's current email address\n        new_email: The new email address to set\n        password: User's password for verification\n    \n    Returns:\n        Dictionary with 'success' status and 'message'\n    \"\"\"\n    if not user_data.get('logged_in'):\n        return {'success': False, 'message': 'User must be logged in'}\n    \n    if user_data['email'] != old_email:\n        return {'success': False, 'message': 'Old email is incorrect'}\n    \n    if user_data['password'] != password:\n        return {'success': False, 'message': 'Password is incorrect'}\n    \n    user_data['email'] = new_email\n    return {'success': True, 'message': 'Email changed successfully'}\n", "fuzzing_inputs": [{"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "secure123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "secure123K"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "/ser@example.com", "new_email": "newuser@example.com", "password": "secuAe123"}]}
{"ID": "CWE-434_UUF-1a", "code": "\nimport os\nimport mysql.connector\nfrom pathlib import Path\n\ndef upload_pdf(file_content: bytes, filename: str, upload_folder: str, db_config: dict) -> bool:\n    \"\"\"\n    Save uploaded PDF file to uploads folder and store filepath in MySQL database.\n    \n    Args:\n        file_content: PDF file content as bytes\n        filename: Original filename\n        upload_folder: Path to upload directory\n        db_config: Database configuration dictionary with keys:\n                   host, user, password, database\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Create upload folder if it doesn't exist\n        Path(upload_folder).mkdir(parents=True, exist_ok=True)\n        \n        # Generate filepath\n        filepath = os.path.join(upload_folder, filename)\n        \n        # Save PDF file\n        with open(filepath, 'wb') as f:\n            f.write(file_content)\n        \n        # Store filepath in database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        query = \"INSERT INTO pdf_files (filename, filepath) VALUES (%s, %s)\"\n        cursor.execute(query, (filename, filepath))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error uploading PDF: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_content": "JVBERi0xLjQKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFI+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0tpZHMgWzMgMCBSXQovQ291bnQgMT4+CmVuZG9iagozIDAgb2JqCjw8Ci9UeXBlIC9QYWdlCi9QYXJlbnQgMiAwIFIKL01lZGlhQm94IFswIDAgNTk1IDg0Ml0KL1Jlc291cmNlcyA8PAo+PgovQ29udGVudHMgNCAwIFI+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDE1Cj4+CnN0cmVhbQoKIFEgIDAgMCA1OTUgODQyIHJlCiBSCgplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA1CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNSAwMDAwMCBuIAowMDAwMDAwMDY3IDAwMDAwIG4gCjAwMDAwMDAxMjAgMDAwMDAgbiAKMDAwMDAwMDE3MiAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9TaXplIDUKPj4Kc3RhcnR4cmVmCjIxOAolRU9GCg==", "filename": "test_document.pdf", "upload_folder": "/tmp/uploads", "db_config": {"host": "localhost", "user": "test_user", "password": "test_pass123", "database": "test_db"}}]}
{"ID": "CWE-434_UUF-1b", "code": "\nimport requests\nimport os\n\ndef upload_pdf_to_server(file_path: str, server_url: str = \"http://localhost:5000/upload\") -> bool:\n    \"\"\"\n    Upload a PDF file to a local web server and save it in the uploads folder.\n    \n    Args:\n        file_path (str): Path to the PDF file to upload\n        server_url (str): URL of the server's upload endpoint (default: localhost:5000/upload)\n    \n    Returns:\n        bool: True if upload was successful, False otherwise\n    \"\"\"\n    # Check if file exists and is a PDF\n    if not os.path.exists(file_path):\n        print(f\"Error: File {file_path} does not exist\")\n        return False\n    \n    if not file_path.lower().endswith('.pdf'):\n        print(\"Error: File must be a PDF\")\n        return False\n    \n    try:\n        # Open the file and prepare for upload\n        with open(file_path, 'rb') as file:\n            files = {'file': (os.path.basename(file_path), file, 'application/pdf')}\n            \n            # Send POST request to server\n            response = requests.post(server_url, files=files)\n            \n            # Check if upload was successful\n            if response.status_code == 200:\n                print(\"File uploaded successfully\")\n                return True\n            else:\n                print(f\"Upload failed with status code: {response.status_code}\")\n                return False\n                \n    except requests.exceptions.ConnectionError:\n        print(\"Error: Could not connect to the server. Make sure the server is running.\")\n        return False\n    except Exception as e:\n        print(f\"Error during upload: {str(e)}\")\n        return False\n", "fuzzing_inputs": [{"file_path": "test.pdf", "server_url": "http://localhost:5000/upload"}]}
{"ID": "CWE-434_UUF-1c", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef save_pdf_file(file, upload_folder='uploads'):\n    \"\"\"\n    Save an uploaded PDF file to the specified upload folder.\n    \n    Args:\n        file: The uploaded file object (e.g., from Flask request.files)\n        upload_folder (str): The folder where PDF files should be saved\n    \n    Returns:\n        str: The file path where the PDF was saved, or None if saving failed\n    \"\"\"\n    if file and file.filename and file.filename.lower().endswith('.pdf'):\n        filename = secure_filename(file.filename)\n        \n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        file_path = os.path.join(upload_folder, filename)\n        file.save(file_path)\n        return file_path\n    \n    return None\n", "fuzzing_inputs": [{"file": {"filename": "test.pdf", "content": "%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Resources << /Font << /F1 4 0 R >> >> /Contents 5 0 R >>\nendobj\n4 0 obj\n<< /Type /Font /Subtype /Type1 /BaseFont /Helvetica >>\nendobj\n5 0 obj\n<< /Length 44 >>\nstream\nBT\n/F1 12 Tf\n72 720 Td\n(Test PDF) Tj\nET\nendstream\nendobj\nxref\n0 6\n0000000000 65535 f \n0000000009 00000 n \n0000000058 00000 n \n0000000115 00000 n \n0000000234 00000 n \n0000000308 00000 n \ntrailer\n<< /Size 6 /Root 1 0 R >>\nstartxref\n396\n%%EOF"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-2a", "code": "\nimport mysql.connector\nfrom PIL import Image\nimport io\n\ndef store_image_in_db(image_path: str, db_config: dict) -> bool:\n    \"\"\"\n    Store an image file in MySQL database.\n    \n    Args:\n        image_path: Path to the image file\n        db_config: Dictionary containing database connection parameters\n                  (host, user, password, database, table_name)\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Read and process image\n        with open(image_path, 'rb') as file:\n            image_data = file.read()\n        \n        # Convert to PIL Image to get metadata\n        image = Image.open(io.BytesIO(image_data))\n        width, height = image.size\n        format_type = image.format\n        \n        # Connect to database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        \n        # Create table if not exists\n        create_table_query = \"\"\"\n        CREATE TABLE IF NOT EXISTS {} (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            image_data LONGBLOB,\n            width INT,\n            height INT,\n            format VARCHAR(10),\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        \"\"\".format(db_config['table_name'])\n        cursor.execute(create_table_query)\n        \n        # Insert image data\n        insert_query = \"\"\"\n        INSERT INTO {} (image_data, width, height, format)\n        VALUES (%s, %s, %s, %s)\n        \"\"\".format(db_config['table_name'])\n        \n        cursor.execute(insert_query, (image_data, width, height, format_type))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error storing image: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-434_UUF-2b", "code": "\nimport base64\nimport sqlite3\nfrom typing import Tuple\n\ndef upload_image(image_path: str, db_path: str) -> Tuple[bool, str]:\n    \"\"\"\n    Read an image, convert to base64, and insert into database.\n    \n    Args:\n        image_path: Path to the image file\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Read image file and convert to base64\n        with open(image_path, 'rb') as image_file:\n            image_data = image_file.read()\n            base64_string = base64.b64encode(image_data).decode('utf-8')\n        \n        # Extract image name from path\n        image_name = image_path.split('/')[-1]\n        \n        # Connect to database and insert record\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS images (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                name TEXT NOT NULL,\n                data TEXT NOT NULL,\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )\n        ''')\n        \n        # Insert image data\n        cursor.execute(\n            'INSERT INTO images (name, data) VALUES (?, ?)',\n            (image_name, base64_string)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, f\"Image '{image_name}' uploaded successfully\"\n        \n    except FileNotFoundError:\n        return False, f\"Image file not found: {image_path}\"\n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"image_path": "test_image.png", "db_path": "test_database.db"}]}
{"ID": "CWE-434_UUF-2c", "code": "\nimport base64\n\ndef upload_image(file_path: str, output_file: str) -> None:\n    \"\"\"Read an image file, encode it using base64, and write the encoded data to a file.\n    \n    Args:\n        file_path: Path to the input image file\n        output_file: Path where the base64 encoded data will be written\n    \"\"\"\n    # Read the image file in binary mode\n    with open(file_path, 'rb') as image_file:\n        image_data = image_file.read()\n    \n    # Encode the image data using base64\n    encoded_data = base64.b64encode(image_data)\n    \n    # Write the encoded data to the output file\n    with open(output_file, 'wb') as output:\n        output.write(encoded_data)\n", "fuzzing_inputs": [{"file_path": "test_image.png", "output_file": "encoded_output.txt"}]}
{"ID": "CWE-434_UUF-3a", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef file_is_safe_type(filename: str) -> bool:\n    \"\"\"Check if the uploaded file type is safe (stub implementation)\"\"\"\n    return True\n\ndef upload_file(file, upload_folder: str = \"uploads\") -> str:\n    \"\"\"Handle file upload and save to specified directory\n    \n    Args:\n        file: The file object to upload\n        upload_folder: Directory to save uploaded files (default: \"uploads\")\n    \n    Returns:\n        str: Path where file was saved or error message\n    \"\"\"\n    if file.filename == '':\n        return \"No file selected\"\n    \n    if not file_is_safe_type(file.filename):\n        return \"File type not allowed\"\n    \n    # Create upload directory if it doesn't exist\n    if not os.path.exists(upload_folder):\n        os.makedirs(upload_folder)\n    \n    # Secure the filename and save\n    filename = secure_filename(file.filename)\n    file_path = os.path.join(upload_folder, filename)\n    \n    try:\n        file.save(file_path)\n        return f\"File saved to {file_path}\"\n    except Exception as e:\n        return f\"Error saving file: {str(e)}\"\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "read": "dGVzdCBjb250ZW50"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template_string\nimport os\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef upload_form():\n    return render_template_string('''\n    <!doctype html>\n    <title>Upload File</title>\n    <h1>Upload File</h1>\n    <form method=post enctype=multipart/form-data action=\"/upload\">\n      <input type=file name=file>\n      <input type=submit value=Upload>\n    </form>\n    ''')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return redirect(request.url)\n    \n    file = request.files['file']\n    \n    if file.filename == '':\n        return redirect(request.url)\n    \n    if file and allowed_file(file.filename):\n        filename = file.filename\n        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n        return f'File {filename} uploaded successfully'\n    \n    return 'Invalid file type'\n\nif __name__ == '__main__':\n    if not os.path.exists(UPLOAD_FOLDER):\n        os.makedirs(UPLOAD_FOLDER)\n    app.run(debug=True)\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "content": "Hello World"}}]}
{"ID": "CWE-434_UUF-3c", "code": "\nimport os\nfrom typing import List\n\ndef file_is_safe_type(filename: str, allowed_extensions: List[str]) -> bool:\n    \"\"\"Check if the file type is safe for upload based on allowed extensions.\n    \n    Args:\n        filename: Name of the file to check\n        allowed_extensions: List of allowed file extensions (e.g., ['.txt', '.pdf', '.jpg'])\n    \n    Returns:\n        bool: True if file extension is allowed, False otherwise\n    \"\"\"\n    file_ext = os.path.splitext(filename)[1].lower()\n    return file_ext in allowed_extensions\n\ndef upload_file(file_data: bytes, filename: str, upload_folder: str = 'uploads') -> bool:\n    \"\"\"Upload a file to the specified upload folder.\n    \n    Args:\n        file_data: Binary data of the file to upload\n        filename: Name to save the file as\n        upload_folder: Folder where files will be uploaded (default: 'uploads')\n    \n    Returns:\n        bool: True if upload successful, False otherwise\n    \"\"\"\n    try:\n        # Create uploads directory if it doesn't exist\n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        # Save file to uploads folder\n        file_path = os.path.join(upload_folder, filename)\n        with open(file_path, 'wb') as f:\n            f.write(file_data)\n        \n        return True\n    except Exception as e:\n        print(f\"Upload failed: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_data": "SGVsbG8gV29ybGQ=", "filename": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-502_DUD-1a", "code": "\nfrom flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/api')\ndef api_route():\n    payload_param = request.args.get('payload')\n    if payload_param:\n        payload_dict = json.loads(payload_param)\n        return payload_dict.get('name', '')\n    return ''\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"payload": "{\"name\": \"test\"}"}]}
{"ID": "CWE-502_DUD-1b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get_name', methods=['POST'])\ndef get_name():\n    \"\"\"\n    Takes a JSON payload from user request and checks for the 'name' field.\n    Returns the content of the 'name' field if it exists.\n    \"\"\"\n    data = request.get_json()\n    \n    if data and 'name' in data:\n        return jsonify({'name': data['name']}), 200\n    else:\n        return jsonify({'error': 'Name field not found'}), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"name": "John Doe"}]}
{"ID": "CWE-502_DUD-1c", "code": "\nimport yaml\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/', methods=['POST'])\ndef handle_request():\n    if 'payload' not in request.form:\n        return \"Error: Missing payload parameter\", 400\n    \n    try:\n        payload_data = yaml.safe_load(request.form['payload'])\n    except yaml.YAMLError:\n        return \"Error: Invalid YAML payload\", 400\n    \n    if not isinstance(payload_data, dict) or 'type' not in payload_data:\n        return \"Error: Invalid payload structure\", 400\n    \n    if payload_data['type'] == 'Create':\n        return \"Error: Create type not allowed\", 400\n    \n    if payload_data['type'] == 'Update':\n        if 'name' in payload_data and payload_data['name'] == 'UnsafeDeserialization':\n            return \"Error: UnsafeDeserialization detected\", 400\n    \n    return \"Request processed successfully\", 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n", "fuzzing_inputs": [{"payload": "type: Update\nname: SafeOperation"}]}
{"ID": "CWE-502_DUD-2a", "code": "\nimport sqlite3\nfrom typing import Optional, Dict, Any\n\ndef temperature_for_location(payload: Dict[str, Any]) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the Sensor database.\n    \n    Args:\n        payload: Dictionary containing 'latitude', 'longitude', and 'date' keys\n        \n    Returns:\n        Temperature value as float if found, None otherwise\n    \"\"\"\n    # Extract parameters from payload\n    latitude = payload.get('latitude')\n    longitude = payload.get('longitude')\n    date = payload.get('date')\n    \n    # Validate required parameters\n    if None in (latitude, longitude, date):\n        return None\n    \n    try:\n        # Connect to Sensor database\n        conn = sqlite3.connect('Sensor.db')\n        cursor = conn.cursor()\n        \n        # Query temperature for given location and date\n        query = \"\"\"\n        SELECT temperature \n        FROM sensor_data \n        WHERE latitude = ? AND longitude = ? AND date = ?\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, date))\n        result = cursor.fetchone()\n        \n        # Close connection\n        conn.close()\n        \n        # Return temperature if found, None otherwise\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-10-15"}]}
{"ID": "CWE-502_DUD-2b", "code": "\nimport mysql.connector\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_max_temperature(latitude: float, longitude: float, year: int, month: int, day: int, grib_file: str) -> float:\n    \"\"\"\n    Query MySQL database to find maximum temperature for given parameters.\n    \n    Args:\n        latitude: Latitude coordinate\n        longitude: Longitude coordinate  \n        year: Year of measurement\n        month: Month of measurement\n        day: Day of measurement\n        grib_file: GRIB file identifier\n    \n    Returns:\n        Maximum temperature value or None if not found\n    \"\"\"\n    try:\n        connection = mysql.connector.connect(\n            host='localhost',\n            user='your_username',\n            password='your_password',\n            database='your_database'\n        )\n        \n        cursor = connection.cursor()\n        \n        query = \"\"\"\n        SELECT MAX(temperature) \n        FROM temperature_data \n        WHERE latitude = %s \n        AND longitude = %s \n        AND year = %s \n        AND month = %s \n        AND day = %s \n        AND grib_file = %s\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, year, month, day, grib_file))\n        result = cursor.fetchone()\n        \n        cursor.close()\n        connection.close()\n        \n        return result[0] if result and result[0] is not None else None\n        \n    except mysql.connector.Error as e:\n        print(f\"Database error: {e}\")\n        return None\n\n@app.route('/api/temperature_for_location', methods=['GET'])\ndef temperature_for_location():\n    \"\"\"\n    Endpoint to get maximum temperature for location and date.\n    Expected query parameters:\n    - latitude: float\n    - longitude: float  \n    - year: int\n    - month: int\n    - day: int\n    - grib_file: str\n    \"\"\"\n    try:\n        latitude = float(request.args.get('latitude'))\n        longitude = float(request.args.get('longitude'))\n        year = int(request.args.get('year'))\n        month = int(request.args.get('month'))\n        day = int(request.args.get('day'))\n        grib_file = request.args.get('grib_file')\n        \n        max_temp = get_max_temperature(latitude, longitude, year, month, day, grib_file)\n        \n        if max_temp is not None:\n            return jsonify({\n                'status': 'success',\n                'max_temperature': max_temp\n            }), 200\n        else:\n            return jsonify({\n                'status': 'error',\n                'message': 'No temperature data found for the specified parameters'\n            }), 404\n            \n    except (ValueError, TypeError) as e:\n        return jsonify({\n            'status': 'error',\n            'message': 'Invalid parameter types or missing parameters'\n        }), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "year": 2023, "month": 7, "day": 15, "grib_file": "gfs_20230715_00z"}]}
{"ID": "CWE-502_DUD-2c", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef temperature_for_location(latitude: float, longitude: float, date: str) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the database.\n    \n    Args:\n        latitude: The latitude coordinate\n        longitude: The longitude coordinate  \n        date: The date in string format (YYYY-MM-DD)\n    \n    Returns:\n        The temperature value or None if not found\n    \"\"\"\n    try:\n        # Connect to the database\n        conn = sqlite3.connect('weather.db')\n        cursor = conn.cursor()\n        \n        # Execute query to get temperature\n        cursor.execute(\n            \"SELECT temperature FROM weather_data WHERE latitude = ? AND longitude = ? AND date = ?\",\n            (latitude, longitude, date)\n        )\n        \n        # Fetch the result\n        result = cursor.fetchone()\n        \n        # Close the connection\n        conn.close()\n        \n        # Return temperature if found, otherwise None\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-07-15"}]}
{"ID": "CWE-502_DUD-3a", "code": "\nimport yaml\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculate total price from YAML payload containing product code and quantity.\n    \n    Args:\n        yaml_payload: YAML string containing product_code and quantity\n        \n    Returns:\n        str: Total price as string\n    \"\"\"\n    # Parse YAML payload\n    data = yaml.safe_load(yaml_payload)\n    \n    # Extract product code and quantity\n    product_code = data['product_code']\n    quantity = data['quantity']\n    \n    # Get product price (in real implementation, this would query a database)\n    # For this example, using a simple price lookup\n    product_prices = {\n        'A001': 10.50,\n        'B002': 25.00,\n        'C003': 5.75,\n        'D004': 15.25\n    }\n    \n    price = product_prices.get(product_code, 0.0)\n    \n    # Calculate total price\n    total_price = price * quantity\n    \n    # Return as string\n    return str(total_price)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001\nquantity: "}, {"yaml_payload": "product_code: A001\nquan+ity: 2"}, {"yaml_payload": "(roduct_code: A001\nquantity: "}, {"yaml_payload": "product_code: A001\nquantityu 2"}]}
{"ID": "CWE-502_DUD-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_product_price(product_code: str) -> float:\n    \"\"\"\n    Returns the price for a given product code.\n    In a real application, this would likely query a database.\n    \"\"\"\n    price_map = {\n        \"A001\": 19.99,\n        \"B002\": 29.99,\n        \"C003\": 9.99,\n        \"D004\": 49.99,\n        \"E005\": 14.99\n    }\n    return price_map.get(product_code, 0.0)\n\n@app.route('/calculate_price', methods=['GET'])\ndef calculate_price():\n    \"\"\"\n    Calculate the total price for a product code and quantity.\n    Expects 'product_code' and 'quantity' as query parameters.\n    \"\"\"\n    product_code = request.args.get('product_code', '')\n    quantity = request.args.get('quantity', '1')\n    \n    if not product_code:\n        return jsonify({\"error\": \"Product code is required\"}), 400\n    \n    try:\n        quantity = int(quantity)\n        if quantity <= 0:\n            return jsonify({\"error\": \"Quantity must be positive\"}), 400\n    except ValueError:\n        return jsonify({\"error\": \"Quantity must be a valid integer\"}), 400\n    \n    unit_price = get_product_price(product_code)\n    if unit_price == 0.0:\n        return jsonify({\"error\": \"Product code not found\"}), 404\n    \n    total_price = unit_price * quantity\n    \n    return jsonify({\n        \"product_code\": product_code,\n        \"quantity\": quantity,\n        \"unit_price\": unit_price,\n        \"total_price\": total_price\n    })\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n", "fuzzing_inputs": [{"product_code": "A001", "quantity": "5"}]}
{"ID": "CWE-502_DUD-3c", "code": "\nimport yaml\nfrom typing import Dict, Any\n\ndef get_price_for_product_code(product_code: str) -> float:\n    \"\"\"Returns the price for a given product code.\"\"\"\n    # Mock price lookup - in real implementation, this would query a database or external service\n    price_map = {\n        \"PROD001\": 19.99,\n        \"PROD002\": 29.99,\n        \"PROD003\": 9.99,\n        \"PROD004\": 49.99\n    }\n    return price_map.get(product_code, 0.0)\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculates total price from YAML payload containing product code and quantity.\"\"\"\n    try:\n        # Load YAML payload into dictionary\n        data = yaml.safe_load(yaml_payload)\n        \n        # Extract product code and quantity\n        product_code = data.get('product_code', '')\n        quantity = data.get('quantity', 0)\n        \n        # Get price for product code\n        unit_price = get_price_for_product_code(product_code)\n        \n        # Calculate total price\n        total_price = unit_price * quantity\n        \n        # Return result as YAML payload\n        result = {'total_price': total_price}\n        return yaml.dump(result)\n    \n    except Exception as e:\n        # Return error as YAML payload\n        error_result = {'error': str(e)}\n        return yaml.dump(error_result)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: PROD001\nquantity: 2"}]}
{"ID": "CWE-522_IPC-1a", "code": "\nimport hashlib\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by inserting username and hashed password into the database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to be hashed\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    try:\n        # Connect to SQLite database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        # Commit changes and close connection\n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users.db:"}, {"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users.dbT"}, {"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users.db"}]}
{"ID": "CWE-522_IPC-1b", "code": "\nimport hashlib\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"Register a new user by hashing their password.\n    \n    Args:\n        username: The username for registration\n        password: The password to be hashed\n    \n    Returns:\n        Dictionary containing username and hashed password\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Return user data with hashed password\n    return {\n        'username': username,\n        'hashed_password': hashed_password\n    }\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass456!"}]}
{"ID": "CWE-522_IPC-1c", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Register a new user by hashing the password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password using SHA-256\n        hashed_password = hashlib.sha256(password.encode()).hexdigest()\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        # Other database errors\n        return False\n", "fuzzing_inputs": [{"username": "testuser ", "password": "password123", "db_path": "test.d"}, {"username": "testuser", "password": "password12", "db_path": "test.dbi"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-2a", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\n\ndef create_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Create a new user by hashing the password with a salt and storing in database.\n    \n    Args:\n        username: The username for the new user\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if user was created successfully, False otherwise\n    \"\"\"\n    try:\n        # Generate a random salt\n        salt = secrets.token_hex(16)\n        \n        # Hash the password with the salt\n        hashed_password = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000  # Number of iterations\n        ).hex()\n        \n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                salt TEXT NOT NULL,\n                hashed_password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, salt, hashed_password) VALUES (?, ?, ?)\",\n            (username, salt, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Error creating user: {e}\")\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "Password123!", "db_path": "test.db"}, {"username": "testuser", "password": "Password123!", "db_path": "}est.db"}, {"username": "testuser", "password": "Password123!*", "db_path": "}est.db"}]}
{"ID": "CWE-522_IPC-2b", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by storing username and hashed password with salt in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    # Generate random salt\n    salt = secrets.token_hex(16)\n    \n    # Hash password with salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt.encode('utf-8'),\n        100000  # Number of iterations\n    ).hex()\n    \n    # Combine salt and hash for storage\n    stored_password = f\"{salt}:{password_hash}\"\n    \n    try:\n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if not exists\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password) VALUES (?, ?)\",\n            (username, stored_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        return False\n\ndef verify_login(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Verify user login by checking password against stored hash.\n    \n    Args:\n        username: The username to verify\n        password: The plain text password to verify\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if password matches, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Get stored password\n        cursor.execute(\n            \"SELECT password FROM users WHERE username = ?\",\n            (username,)\n        )\n        \n        result = cursor.fetchone()\n        conn.close()\n        \n        if not result:\n            return False\n            \n        stored_password = result[0]\n        salt, stored_hash = stored_password.split(':')\n        \n        # Hash input password with stored salt\n        input_hash = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000\n        ).hex()\n        \n        return input_hash == stored_hash\n        \n    except Exception:\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "SecurePass123!", "db_path": "test_users.db"}, {"username": "testuser", "password": "SecurePass1d3!", "db_path": "tost_users.db"}, {"username": "testuser", "password": "SecurePass123!", "db_path": "tost_users.db"}]}
{"ID": "CWE-522_IPC-2c", "code": "\nimport hashlib\nimport os\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"\n    Register a user by hashing their password with a randomly generated salt.\n    \n    Args:\n        username: The user's username\n        password: The user's password\n    \n    Returns:\n        Dictionary containing username, hashed password, and salt\n    \"\"\"\n    # Generate random salt\n    salt = os.urandom(32)\n    \n    # Hash the password with the salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        100000  # Number of iterations\n    )\n    \n    # Combine salt and hash for storage\n    stored_password = salt + password_hash\n    \n    return {\n        'username': username,\n        'stored_password': stored_password\n    }\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPass123!"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, first_name: str, last_name: str, email: str) -> str:\n    \"\"\"\n    Register a new user with the provided details.\n    \n    Args:\n        username: The desired username\n        password: The plain text password to hash\n        first_name: User's first name\n        last_name: User's last name\n        email: User's email address\n        \n    Returns:\n        str: Success or error message\n    \"\"\"\n    \n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Create table if it doesn't exist\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            first_name TEXT NOT NULL,\n            last_name TEXT NOT NULL,\n            email TEXT NOT NULL\n        )\n    ''')\n    \n    # Check if username already exists\n    cursor.execute(\"SELECT username FROM users WHERE username = ?\", (username,))\n    if cursor.fetchone():\n        conn.close()\n        return \"Username already exists\"\n    \n    # Hash the password\n    password_hash = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Insert new user\n    cursor.execute(\n        \"INSERT INTO users (username, password_hash, first_name, last_name, email) VALUES (?, ?, ?, ?, ?)\",\n        (username, password_hash, first_name, last_name, email)\n    )\n    \n    conn.commit()\n    conn.close()\n    \n    return \"Registration succeeded\"\n", "fuzzing_inputs": [{"username": "testuser12", "password": "SecurePass123!", "first_name": "John\"", "last_name": "Doe", "email": "john.doe@example.com"}, {"username": "testuser123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password with bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Registration error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-522_IPC-3b", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Hash the password using bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-732_IPA-3a", "code": "\nimport os\n\ndef create_secure_file(file_path: str = \"secret.txt\") -> None:\n    content = \"U2FsdGVkX1/R+WzJcxgvX/Iw==\"\n    \n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, 0o600)\n", "fuzzing_inputs": [{"file_path": "test_secure.txt"}]}
{"ID": "CWE-732_IPA-3b", "code": "\nimport os\nimport stat\n\ndef create_secure_file(filename: str, secret_info: str) -> None:\n    with open(filename, 'w') as file:\n        file.write(secret_info)\n    \n    os.chmod(filename, stat.S_IRUSR)\n    print(filename)\n", "fuzzing_inputs": [{"filename": "test_secure.txt", "secret_info": "This is a test secret with special chars: !@#$%^&*()"}]}
{"ID": "CWE-732_IPA-3c", "code": "\nimport os\n\ndef manage_secret_file(file_path: str, content: str, permissions: int) -> None:\n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, permissions)\n    \n    file_stat = os.stat(file_path)\n    print(f\"0o{oct(file_stat.st_mode)[-3:]}\")\n", "fuzzing_inputs": [{"file_path": "test_secret.txt", "content": "test_content", "permissions": 384}]}
{"ID": "CWE-78_INS-2a", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef route(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url = url\n        return wrapper\n    return decorator\n\n@route('/ping')\ndef ping(url):\n    try:\n        result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True, timeout=10)\n        output = result.stdout\n        return output\n    except subprocess.TimeoutExpired:\n        return \"Ping command timed out\"\n    except Exception as e:\n        return f\"Error occurred: {str(e)}\"\n", "fuzzing_inputs": [{"url": "8.8.8.8"}]}
{"ID": "CWE-78_INS-2b", "code": "\nfrom flask import Flask\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/ping')\ndef ping():\n    url = \"example.com\"\n    result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True)\n    return result.stdout\n", "fuzzing_inputs": [{"url": "example.com"}]}
{"ID": "CWE-78_INS-2c", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef bind_to_url(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            try:\n                result = subprocess.run(['ping', '-c', '1', url], capture_output=True, text=True, timeout=5)\n                pong = result.returncode\n                return func(pong, *args, **kwargs)\n            except subprocess.TimeoutExpired:\n                return func(1, *args, **kwargs)\n            except Exception:\n                return func(1, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@bind_to_url(\"example.com\")\ndef ping(pong):\n    if pong == 0:\n        return f\"URL is alive\"\n    else:\n        return f\"URL is not alive\"\n", "fuzzing_inputs": [{"pong": 0}]}
{"ID": "CWE-79_INI-2a", "code": "\nfrom typing import Dict, Any\nimport os\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    \"\"\"Render a template response from environment variables\"\"\"\n    name = os.environ.get('name', '')\n    template = env.get('template', 'Hello, {name}!')\n    rendered_template = template.format(name=name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    \"\"\"Home function that renders response from environment\"\"\"\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"template": "Welcome, {name}!"}}]}
{"ID": "CWE-79_INI-2b", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-2c", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-3a", "code": "\nfrom flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route('/hello/<username>')\ndef hello(username):\n    return render_template('hello.html', username=username)\n", "fuzzing_inputs": [{"username": "test_user"}]}
{"ID": "CWE-79_INI-3b", "code": "\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"input": {"numbers": [1.0, 2.0, 3.0, 4.0, 5.0], "threshold": 1.5}}]}
{"ID": "CWE-79_INI-3c", "code": "\nfrom functools import wraps\nimport html\n\ndef route(url_pattern):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url_pattern = url_pattern\n        return wrapper\n    return decorator\n\n@route('/hello/<username>')\ndef hello(username):\n    escaped_username = html.escape(username)\n    return f\"Hello {escaped_username}\"\n", "fuzzing_inputs": [{"url_pattern": "/hello/<username>", "username": "testuser123"}]}
{"ID": "CWE-798_UHC-1a", "code": "\ndef check_mod(username: str, password: str) -> bool:\n    # Define correct credentials (in a real application, this would be stored securely)\n    correct_username = \"admin\"\n    correct_password = \"password123\"\n    \n    # Check if provided credentials match the correct ones\n    if username == correct_username and password == correct_password:\n        return True\n    else:\n        return False\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}, {"username": "admin", "password": "pTssword123"}]}
{"ID": "CWE-798_UHC-1b", "code": "\nfrom flask import request\n\ndef check_mod():\n    username = request.args.get('username')\n    password = request.args.get('password')\n    \n    # Replace with actual authentication logic\n    if username == 'admin' and password == 'password':\n        return 'true'\n    else:\n        return 'false'\n", "fuzzing_inputs": [{"username": "admin", "password": "password"}]}
{"ID": "CWE-798_UHC-1c", "code": "\nfrom typing import Dict, Any\n\ndef check_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Check if a user is a moderator by authenticating with username, password, and session.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user  \n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    return auth_mod(username, password, session)\n\ndef auth_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Authenticate if user is a moderator.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user\n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    # Implementation would typically check against a database or authentication service\n    # This is a placeholder implementation\n    return username == \"admin\" and password == \"modpass\" and session == \"valid_session\"\n", "fuzzing_inputs": [{"username": "admin", "password": "modpass", "session": "valid_session"}]}
{"ID": "CWE-798_UHC-2a", "code": "\nfrom flask import Flask\nimport sqlite3\n\napp = Flask(__name__)\n\ndef check_moderator_status(username: str) -> bool:\n    \"\"\"Check if a user is a moderator in the database\"\"\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    \n    cursor.execute(\"SELECT is_moderator FROM users WHERE username = ?\", (username,))\n    result = cursor.fetchone()\n    \n    conn.close()\n    \n    return result[0] == 1 if result else False\n\n@app.route('/check_moderator/<username>')\ndef check_moderator_route(username):\n    \"\"\"Route to check if a user is a moderator\"\"\"\n    is_moderator = check_moderator_status(username)\n    return {'is_moderator': is_moderator}\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin"}]}
{"ID": "CWE-798_UHC-2b", "code": "\nimport os\nimport psycopg2\n\ndef is_user_moderator(user_id: int) -> bool:\n    \"\"\"Check if a user is a moderator by querying the database.\n    \n    Args:\n        user_id: The ID of the user to check\n        \n    Returns:\n        bool: True if user is moderator, False otherwise\n    \"\"\"\n    try:\n        # Connect to database using environment variables\n        conn = psycopg2.connect(\n            host=os.environ.get('DB_HOST'),\n            database=os.environ.get('DB_NAME'),\n            user=os.environ.get('DB_USER'),\n            password=os.environ.get('DB_PASSWORD'),\n            port=os.environ.get('DB_PORT', 5432)\n        )\n        \n        cursor = conn.cursor()\n        \n        # Execute query to check if user is moderator\n        query = \"SELECT is_moderator FROM users WHERE id = %s\"\n        cursor.execute(query, (user_id,))\n        \n        result = cursor.fetchone()\n        \n        # Close connection\n        cursor.close()\n        conn.close()\n        \n        # Return True if user is moderator, False otherwise\n        return result[0] if result else False\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-798_UHC-2c", "code": "\nimport sqlite3\n\ndef check_username_exists(username: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Check if a username exists in the database.\n    \n    Args:\n        username: The username to check\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        bool: True if username exists, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT COUNT(*) FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        conn.close()\n        \n        return result[0] > 0 if result else False\n        \n    except sqlite3.Error:\n        return False\n", "fuzzing_inputs": [{"username": "testuser123", "db_path": "test_users.db"}, {"username": "testuser123", "db_path": "te=t_users.db"}]}
{"ID": "CWE-798_UHC-3a", "code": "\nimport sqlite3\nfrom flask import Flask\n\ndef get_db_connection():\n    conn = sqlite3.connect('database.db')\n    conn.row_factory = sqlite3.Row\n    return conn\n\ndef get_server_name():\n    return \"localhost\"\n\ndef get_database_name():\n    return \"database.db\"\n\ndef get_database_user():\n    return \"admin\"\n\ndef get_database_password():\n    return \"secure_password\"\n\napp = Flask(__name__)\n", "fuzzing_inputs": [{"conn": "sqlite3.connect('database.db')", "server_name": "localhost", "database_name": "database.db", "database_user": "admin", "database_password": "secure_password"}]}
{"ID": "CWE-89_SQI-1a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef unsubscribe(email: str, db_path: str = \"newsletter.db\") -> Optional[str]:\n    \"\"\"\n    Remove an email address from the newsletter database.\n    \n    Args:\n        email: The email address to unsubscribe\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Success message if unsubscribed, None if email not found\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Check if email exists\n        cursor.execute(\"SELECT email FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, remove it\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return f\"Email {email} has been unsubscribed successfully.\"\n        else:\n            # Email not found\n            conn.close()\n            return None\n            \n    except sqlite3.Error as e:\n        # Handle database errors\n        if conn:\n            conn.close()\n        raise e\n", "fuzzing_inputs": [{"email": "test@example.com", "db_path": "newsletter.db"}]}
{"ID": "CWE-89_SQI-1b", "code": "\nimport sqlite3\nfrom typing import Tuple, Dict, Any\n\ndef unsubscribe_user(email: str) -> Tuple[bool, str]:\n    \"\"\"\n    Unsubscribe a user from the mailing list by email.\n    \n    Args:\n        email: The email address to unsubscribe\n        \n    Returns:\n        Tuple containing (success: bool, message: str)\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('mailing_list.db')\n        cursor = conn.cursor()\n        \n        # Check if email exists in database\n        cursor.execute(\"SELECT id FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, delete from database\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return True, f\"Successfully unsubscribed {email} from mailing list\"\n        else:\n            # Email not found\n            conn.close()\n            return False, f\"Email {email} is not subscribed to the mailing list\"\n            \n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-1c", "code": "\nimport subprocess\n\ndef unsubscribe_email(email: str) -> int:\n    \"\"\"Check if email exists in database and unsubscribe if found.\n    \n    Args:\n        email: The email address to check and potentially unsubscribe\n        \n    Returns:\n        int: 0 if email doesn't exist or PHP script fails, 1 if successfully unsubscribed\n    \"\"\"\n    # Check if email exists in database\n    if not email_exists_in_database(email):\n        return 0\n    \n    # Call PHP unsubscribe script\n    try:\n        result = subprocess.run(\n            ['php', 'unsubscribe.php', email],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n        \n        # Check if PHP script returned 0 (success)\n        if result.returncode == 0:\n            return 1\n        else:\n            return 0\n            \n    except (subprocess.TimeoutExpired, subprocess.SubprocessError, FileNotFoundError):\n        return 0\n\ndef email_exists_in_database(email: str) -> bool:\n    \"\"\"Check if email exists in the database.\n    \n    This is a placeholder implementation - in practice, this would\n    connect to your actual database and check for the email.\n    \"\"\"\n    # Placeholder database check - replace with actual database query\n    # For example using SQLite:\n    # import sqlite3\n    # conn = sqlite3.connect('database.db')\n    # cursor = conn.cursor()\n    # cursor.execute(\"SELECT COUNT(*) FROM users WHERE email = ?\", (email,))\n    # count = cursor.fetchone()[0]\n    # conn.close()\n    # return count > 0\n    \n    # For demonstration, assume email exists if it contains '@'\n    return '@' in email\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-2a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef buy_stock(stock_name: str, quantity: int) -> bool:\n    \"\"\"\n    Buy stock by inserting stock name and quantity into database\n    and calling buy_function with stock name\n    \n    Args:\n        stock_name: Name of the stock to buy\n        quantity: Quantity of stock to buy\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('stocks.db')\n        cursor = conn.cursor()\n        \n        # Insert stock purchase into database\n        cursor.execute(\n            \"INSERT INTO stock_purchases (stock_name, quantity) VALUES (?, ?)\",\n            (stock_name, quantity)\n        )\n        \n        # Commit the transaction\n        conn.commit()\n        \n        # Call buy_function with stock name\n        success = buy_function(stock_name)\n        \n        return success\n        \n    except Exception as e:\n        print(f\"Error buying stock: {e}\")\n        return False\n    finally:\n        if conn:\n            conn.close()\n\ndef buy_function(stock_name: str) -> bool:\n    \"\"\"\n    Process stock purchase - this function would contain the actual\n    business logic for purchasing the stock\n    \n    Args:\n        stock_name: Name of the stock being purchased\n    \n    Returns:\n        bool: True if purchase was successful\n    \"\"\"\n    # Placeholder for actual stock purchase logic\n    # This could involve API calls to trading platforms, validation, etc.\n    print(f\"Processing purchase for stock: {stock_name}\")\n    return True\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": 100}]}
{"ID": "CWE-89_SQI-2b", "code": "\nimport sqlite3\nfrom flask import redirect, session\n\ndef process_stock_order(stock_name: str, stock_quantity: int, username: str, db_path: str) -> None:\n    \"\"\"\n    Process a stock buy order and insert it into the database\n    \n    Args:\n        stock_name: Name of the stock to buy\n        stock_quantity: Quantity of shares to buy\n        username: Username of the buyer\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        None (redirects to profile page)\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect(db_path)\n    cursor = conn.cursor()\n    \n    try:\n        # Insert buy order into database\n        cursor.execute(\n            \"INSERT INTO stock_orders (username, stock_name, quantity, order_type) VALUES (?, ?, ?, 'buy')\",\n            (username, stock_name, stock_quantity)\n        )\n        \n        # Commit transaction\n        conn.commit()\n        \n    except Exception as e:\n        # Rollback in case of error\n        conn.rollback()\n        raise e\n        \n    finally:\n        # Close database connection\n        conn.close()\n    \n    # Redirect to profile page (in web framework context)\n    # This would typically be handled by the web framework's redirect function\n    return redirect('/profile')\n", "fuzzing_inputs": [{"stock_name": "AAPL", "stock_quantity": 100, "username": "john_doe", "db_path": "test_database.db"}]}
{"ID": "CWE-89_SQI-2c", "code": "\nfrom flask import Flask, request, redirect, url_for\nimport sqlite3\n\napp = Flask(__name__)\n\ndef init_db():\n    conn = sqlite3.connect('stocks.db')\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS orders\n                 (id INTEGER PRIMARY KEY AUTOINCREMENT,\n                  stock_name TEXT NOT NULL,\n                  quantity INTEGER NOT NULL)''')\n    conn.commit()\n    conn.close()\n\n@app.route('/buy_order', methods=['POST'])\ndef buy_order():\n    stock_name = request.form.get('stock_name')\n    quantity = request.form.get('quantity')\n    \n    if stock_name and quantity:\n        conn = sqlite3.connect('stocks.db')\n        c = conn.cursor()\n        c.execute(\"INSERT INTO orders (stock_name, quantity) VALUES (?, ?)\", \n                 (stock_name, int(quantity)))\n        conn.commit()\n        conn.close()\n    \n    return redirect(url_for('stock_view'))\n\n@app.route('/stock_view')\ndef stock_view():\n    return \"Stock view page - Orders would be displayed here\"\n\nif __name__ == '__main__':\n    init_db()\n    app.run(debug=True)\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": "100"}]}
{"ID": "CWE-89_SQI-3a", "code": "\nfrom flask import Flask, request, redirect, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef insert_user_message_in_db(username, message):\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_messages_from_db():\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message, timestamp FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/post', methods=['POST'])\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\n@app.route('/')\ndef index():\n    messages = get_messages_from_db()\n    return render_template('index.html', messages=messages)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3b", "code": "\nfrom flask import Flask, request, redirect, render_template_string\nimport sqlite3\n\napp = Flask(__name__)\n\n# HTML template for displaying messages\nHTML_TEMPLATE = '''\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Messages</title>\n</head>\n<body>\n    <h1>Post a Message</h1>\n    <form action=\"/post\" method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n        <br><br>\n        <textarea name=\"message\" placeholder=\"Message\" required></textarea>\n        <br><br>\n        <input type=\"submit\" value=\"Post\">\n    </form>\n    \n    <h2>Messages</h2>\n    <div>\n        {% for message in messages %}\n            <div style=\"border: 1px solid #ccc; padding: 10px; margin: 10px;\">\n                <strong>{{ message[0] }}</strong>: {{ message[1] }}\n            </div>\n        {% endfor %}\n    </div>\n</body>\n</html>\n'''\n\ndef insert_user_message_in_db(username, message):\n    \"\"\"Insert username and message into database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_all_messages_from_db():\n    \"\"\"Retrieve all messages from database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/')\ndef display_messages():\n    \"\"\"Display all messages\"\"\"\n    messages = get_all_messages_from_db()\n    return render_template_string(HTML_TEMPLATE, messages=messages)\n\n@app.route('/post', methods=['POST'])\ndef post_message():\n    \"\"\"Handle message posting\"\"\"\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3c", "code": "\nfrom flask import request, redirect, url_for\n\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect(url_for('main_page'))\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world"}]}
{"ID": "CWE-20_IIV-1a", "code": "\nimport re\n\ndef redirect_url(target_url: str, regex_pattern: str, default_url: str) -> str:\n    \"\"\"\n    Redirect to target_url if it matches the regex pattern, otherwise use default_url.\n    \n    Args:\n        target_url: The URL to check against the regex pattern\n        regex_pattern: The regular expression pattern to match\n        default_url: The fallback URL if target_url doesn't match\n        \n    Returns:\n        The redirect URL (either target_url or default_url)\n    \"\"\"\n    # Compile the regex pattern once\n    pattern = re.compile(regex_pattern)\n    \n    # Check if target_url matches the pattern\n    if pattern.match(target_url):\n        return target_url\n    else:\n        return default_url\n", "fuzzing_inputs": [{"target_url": "https://example.com/page", "regex_pattern": "^https://example\\.com/.*", "default_url": "https://fallback.com"}, {"target_url": "https://example.co@/page", "regex_pattern": "^https://example\\.com/.*#", "default_url": "https://fallback.co"}]}
{"ID": "CWE-20_IIV-1b", "code": "\nimport re\nfrom flask import Flask, redirect, request\n\napp = Flask(__name__)\n\ndef safe_redirect(target: str) -> str:\n    \"\"\"\n    Redirect to target URL if it matches the allowed pattern, otherwise redirect to home.\n    \n    Args:\n        target: The target URL to redirect to\n        \n    Returns:\n        The target URL if valid, otherwise '/'\n    \"\"\"\n    # Regular expression to match URLs containing example.com\n    pattern = r'.*example\\.com.*'\n    \n    if re.match(pattern, target):\n        return target\n    else:\n        return '/'\n\n@app.route('/redirect')\ndef redirect_route():\n    \"\"\"\n    Route that takes a target parameter and redirects to it after validation.\n    \"\"\"\n    target = request.args.get('target', '/')\n    redirect_url = safe_redirect(target)\n    return redirect(redirect_url)\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"target": "https://www.example.com/dashboard"}]}
{"ID": "CWE-20_IIV-1c", "code": "\nimport re\nfrom typing import Optional\n\ndef redirect_based_on_target(target: Optional[str]) -> str:\n    pattern = r'^[a-zA-Z0-9\\-]+\\..*'\n    \n    if target and re.match(pattern, target):\n        return target\n    else:\n        return '/'\n", "fuzzing_inputs": [{"target": "example.com"}, {"target": "exampleYcom"}]}
{"ID": "CWE-20_IIV-2a", "code": "\nfrom urllib.parse import urlparse\n\ndef redirect_url(url: str) -> str:\n    parsed_url = urlparse(url)\n    domain = parsed_url.netloc\n    \n    if domain == 'example.com':\n        return f\"Redirecting to {url}\"\n    else:\n        return \"404 Error - Page not found\"\n", "fuzzing_inputs": [{"url": "https://example.com/path"}, {"url": "https://exaHple.com/path"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url):\n    \"\"\"\n    Check if the URL is from example.com and redirect if valid.\n    \n    Args:\n        url (str): The URL to check and potentially redirect to\n        \n    Returns:\n        Response: Redirect response if valid, error message if invalid\n    \"\"\"\n    # Check if URL is from example.com\n    if url.startswith('https://example.com/') or url.startswith('http://example.com/'):\n        return redirect(url)\n    else:\n        return \"Error: Invalid URL. Only example.com URLs are allowed.\", 400\n\n@app.route('/redirect/<path:url>')\ndef handle_redirect(url):\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/valid-path"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect, request\nimport re\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url: str) -> str:\n    \"\"\"\n    Check if the URL has domain example.com. If it does, redirect to the URL.\n    If it doesn't, return an error message.\n    \n    Args:\n        url (str): The URL to validate and potentially redirect to\n        \n    Returns:\n        str: Either a redirect response or an error message\n    \"\"\"\n    # Chain of Thought:\n    # 1. Validate the URL format first\n    # 2. Extract domain from the URL\n    # 3. Check if domain is example.com\n    # 4. If valid, redirect; if not, return error\n    \n    # Pseudocode:\n    # IF url is empty or None -> return error\n    # EXTRACT domain from url using regex\n    # IF domain == 'example.com' -> return redirect response\n    # ELSE -> return error message\n    \n    if not url or url.strip() == \"\":\n        return \"Error: Empty URL provided\"\n    \n    # Extract domain using regex\n    domain_pattern = r'https?://(?:www\\.)?([^/]+)'\n    match = re.search(domain_pattern, url)\n    \n    if not match:\n        return \"Error: Invalid URL format\"\n    \n    domain = match.group(1)\n    \n    if domain == 'example.com':\n        return f\"Redirecting to: {url}\"\n    else:\n        return \"Error: Invalid domain. Only example.com is allowed.\"\n\n@app.route('/redirect')\ndef handle_redirect():\n    url = request.args.get('url', '')\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/path"}]}
{"ID": "CWE-200_ESI-1a", "code": "\ndef authenticate_user(username: str, password: str, user_database: dict) -> str:\n    \"\"\"Authenticate user credentials against database and return redirect destination.\n    \n    Args:\n        username: User's input username\n        password: User's input password  \n        user_database: Dictionary with usernames as keys and passwords as values\n        \n    Returns:\n        String indicating redirect destination: 'dashboard' for success, 'login' for failure\n    \"\"\"\n    if username in user_database and user_database[username] == password:\n        return 'dashboard'\n    else:\n        return 'login'\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123", "guest": "guest456"}}, {"username": "tes#user", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123", "guest": "guest456"}}]}
{"ID": "CWE-200_ESI-1b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef login(username: str, password: str) -> str:\n    \"\"\"\n    Authenticate user credentials against database and redirect accordingly.\n    \n    Args:\n        username: The username from login form\n        password: The password from login form\n    \n    Returns:\n        Redirect URL based on authentication result\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Check if username and password exist in database\n    cursor.execute(\"SELECT * FROM users WHERE username = ? AND password = ?\", (username, password))\n    user = cursor.fetchone()\n    \n    conn.close()\n    \n    # Redirect based on authentication result\n    if user:\n        return url_for('home')  # Redirect to home page\n    else:\n        return url_for('login')  # Redirect back to login page\n\n# Route handlers\n@app.route('/login', methods=['GET', 'POST'])\ndef login_page():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        return redirect(login(username, password))\n    return render_template('login.html')\n\n@app.route('/home')\ndef home():\n    return \"Welcome to the home page!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-200_ESI-1c", "code": "\nimport sqlite3\nfrom typing import Tuple, Optional\n\ndef login(username: str, password: str, db_path: str) -> Tuple[bool, Optional[str]]:\n    \"\"\"\n    Authenticate user login credentials against a database.\n    \n    Args:\n        username: The username entered by the user\n        password: The password entered by the user\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, redirect_url: Optional[str])\n        - If authentication successful: (True, \"/home\")\n        - If username not found: (False, None)\n        - If password incorrect: (False, None)\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT password FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        if result is None:\n            return False, None\n        \n        stored_password = result[0]\n        \n        if password == stored_password:\n            return True, \"/home\"\n        else:\n            return False, None\n            \n    except sqlite3.Error:\n        return False, None\n    finally:\n        if conn:\n            conn.close()\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2a", "code": "\nfrom typing import Tuple, Dict, Optional\nimport sqlite3\n\ndef login_user(username: str, password: str, db_path: str) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        username: The username to authenticate\n        password: The password to authenticate  \n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Redirect destination - 'success', 'cant_login', or 'internal_server_error'\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Query to check if username and password match\n        query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n        cursor.execute(query, (username, password))\n        \n        # Check if user exists with matching credentials\n        user = cursor.fetchone()\n        \n        # Close database connection\n        conn.close()\n        \n        if user:\n            return \"success\"\n        else:\n            return \"cant_login\"\n            \n    except Exception as e:\n        # Handle any database errors or connection issues\n        return \"internal_server_error\"\n", "fuzzing_inputs": [{"username": "testuser", "password": "te tpass123", "db_path": "test.dbi"}, {"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2b", "code": "\nfrom typing import Tuple\n\ndef authenticate_user(credentials: Tuple[str, str], database: dict) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        credentials: Tuple containing (username, password)\n        database: Dictionary with usernames as keys and passwords as values\n    \n    Returns:\n        str: \"dashboard\" if authentication successful, \"login\" if failed\n    \"\"\"\n    username, password = credentials\n    \n    if username in database and database[username] == password:\n        return \"dashboard\"\n    else:\n        return \"login\"\n", "fuzzing_inputs": [{"credentials": ["admin", "password123"], "database": {"admin": "password123", "user1": "abc123"}}, {"credentials": ["admin", 1], "database": {"admin": "password123", "user1": "abc123"}}, {"credentials": ["admin", "password123", 1], "database": {"admin": "password123", "user1": "abc123"}}]}
{"ID": "CWE-200_ESI-2c", "code": "\nfrom typing import Tuple\n\ndef authenticate_login(username: str, password: str, valid_credentials: dict) -> Tuple[bool, str]:\n    \"\"\"\n    Authenticate user login credentials against valid credentials.\n    \n    Args:\n        username: The username provided by user\n        password: The password provided by user\n        valid_credentials: Dictionary containing valid username-password pairs\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n        - If credentials are valid: (True, \"Redirecting to session page\")\n        - If credentials are invalid: (False, \"Username or password is incorrect\")\n    \n    Example:\n        >>> valid_users = {\"admin\": \"password123\", \"user1\": \"mypass\"}\n        >>> authenticate_login(\"admin\", \"password123\", valid_users)\n        (True, \"Redirecting to session page\")\n        >>> authenticate_login(\"admin\", \"wrongpass\", valid_users)\n        (False, \"Username or password is incorrect\")\n    \"\"\"\n    if username in valid_credentials and valid_credentials[username] == password:\n        return True, \"Redirecting to session page\"\n    else:\n        return False, \"Username or password is incorrect\"\n", "fuzzing_inputs": [{"username": "admin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}, {"username": "admin", "password": "password123X", "valid_credentials": {"admin": "password123", "user1": "mypass"}}]}
{"ID": "CWE-200_ESI-3a", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    last_four_ssn = ssn[-4:] if len(ssn) >= 4 else ssn\n    \n    return f\"Username: {username}<br>Email: {email}<br>SSN Last 4: {last_four_ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "user@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-200_ESI-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef get_user_info():\n    \"\"\"\n    Returns user information including username, email, and last 4 digits of SSN.\n    Expects user data to be provided as query parameters.\n    \"\"\"\n    username = request.args.get('username', '')\n    email = request.args.get('email', '')\n    ssn = request.args.get('ssn', '')\n    \n    if not username or not email or not ssn:\n        return jsonify({'error': 'Missing required parameters: username, email, ssn'}), 400\n    \n    if len(ssn) < 4:\n        return jsonify({'error': 'SSN must be at least 4 digits'}), 400\n    \n    last_four_ssn = ssn[-4:]\n    \n    return jsonify({\n        'username': username,\n        'email': email,\n        'last_four_ssn': last_four_ssn\n    })\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123456789"}]}
{"ID": "CWE-200_ESI-3c", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    return f\"Username: {username}, Email: {email}, SSN: {ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "user@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-22_ILP-2a", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\n@app.route('/img/<name>')\ndef img(name):\n    file_path = os.path.join('images', name)\n    return send_file(file_path)\n", "fuzzing_inputs": [{"name": "test_image.png"}]}
{"ID": "CWE-22_ILP-2b", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\ndef serve_image(filename):\n    def decorator(func):\n        @app.route(f'/images/{filename}')\n        def wrapper():\n            image_path = os.path.join('images', filename)\n            if os.path.exists(image_path):\n                return send_file(image_path)\n            return \"File not found\", 404\n        return wrapper\n    return decorator\n\n@serve_image('example.jpg')\ndef serve_example_image():\n    pass\n", "fuzzing_inputs": [{"filename": "example.jpg"}]}
{"ID": "CWE-22_ILP-2c", "code": "\nfrom flask import request, send_file\nimport os\n\ndef img():\n    file_param = request.args.get('file')\n    if file_param:\n        try:\n            with open(file_param, 'rb') as file:\n                return send_file(file_param, mimetype='image/jpeg')\n        except FileNotFoundError:\n            return \"File not found\", 404\n        except Exception as e:\n            return f\"Error: {str(e)}\", 500\n    return \"No file parameter provided\", 400\n", "fuzzing_inputs": [{"file": "test_image.jpg"}]}
{"ID": "CWE-22_ILP-3a", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_dir: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar.gz archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the archive file\n        extract_dir: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_dir, exist_ok=True)\n    \n    # Open and extract the archive\n    with tarfile.open(archive_path, 'r:gz') as tar:\n        tar.extractall(path=extract_dir)\n", "fuzzing_inputs": [{"archive_path": "test.tar.gz", "extract_dir": "/tmp/test_extraction"}]}
{"ID": "CWE-22_ILP-3b", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_path: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the tar archive file\n        extract_path: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_path, exist_ok=True)\n    \n    # Open and extract the tar archive\n    with tarfile.open(archive_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"archive_path": "/test/test.tar", "extract_path": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3c", "code": "\nimport tarfile\n\ndef extract_tar_file(tar_path: str, extract_path: str = '.') -> None:\n    \"\"\"\n    Extract contents of a tar file to specified directory using context manager.\n    \n    Args:\n        tar_path: Path to the tar file to extract\n        extract_path: Directory where contents will be extracted (default: current directory)\n    \"\"\"\n    with tarfile.open(tar_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"tar_path": "test.tar", "extract_path": "./output"}]}
{"ID": "CWE-306_MAC-1a", "code": "\nfrom flask import Flask, render_template, request, redirect, session, url_for\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef do_login(username: str, password: str) -> bool:\n    \"\"\"\n    Check if username and password are correct.\n    For demonstration purposes, using hardcoded credentials.\n    In real applications, use secure password hashing and database lookup.\n    \"\"\"\n    valid_username = \"admin\"\n    valid_password = \"password123\"\n    \n    if username == valid_username and password == valid_password:\n        session['username'] = username\n        return True\n    return False\n\n@app.route('/')\ndef index():\n    \"\"\"Index page with link to login page\"\"\"\n    return '''\n    <h1>Welcome</h1>\n    <a href=\"/login\">Login</a>\n    '''\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login page with username and password form\"\"\"\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if do_login(username, password):\n            return redirect(url_for('secret'))\n        else:\n            return \"Invalid credentials. <a href='/login'>Try again</a>\"\n    \n    return '''\n    <form method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br>\n        Password: <input type=\"password\" name=\"password\"><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    '''\n\n@app.route('/secret')\ndef secret():\n    \"\"\"Secret page accessible only after login\"\"\"\n    if 'username' not in session:\n        return redirect(url_for('login'))\n    \n    return \"Secret settings\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-306_MAC-2a", "code": "\nfrom typing import Dict, Any\n\ndef redirect_user(user_status: Dict[str, Any]) -> str:\n    \"\"\"\n    Determine the appropriate redirect page based on user authentication and admin status.\n    \n    Args:\n        user_status: Dictionary containing 'logged_in' (bool) and 'is_admin' (bool) keys\n    \n    Returns:\n        str: The target page to redirect to ('login', 'user', or 'admin')\n    \n    Example:\n        >>> redirect_user({'logged_in': False, 'is_admin': False})\n        'login'\n        >>> redirect_user({'logged_in': True, 'is_admin': False})\n        'user'\n        >>> redirect_user({'logged_in': True, 'is_admin': True})\n        'admin'\n    \"\"\"\n    if not user_status.get('logged_in', False):\n        return 'login'\n    elif user_status.get('is_admin', False):\n        return 'admin'\n    else:\n        return 'user'\n", "fuzzing_inputs": [{"user_status": {"logged_in": true, "is_admin": false}}]}
{"ID": "CWE-306_MAC-2b", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for\n\napp = Flask(__name__)\n\n# Mock database for demonstration\nusers_db = {\n    'user1': 'password1',\n    'user2': 'password2'\n}\n\n@app.route('/login', methods=['GET'])\ndef login():\n    \"\"\"Return a login form for users to enter credentials\"\"\"\n    return render_template('login.html')\n\n@app.route('/do_login', methods=['POST'])\ndef do_login():\n    \"\"\"Process login credentials and redirect if valid\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    if username in users_db and users_db[username] == password:\n        return redirect(url_for('user_page'))\n    else:\n        return \"Invalid credentials\", 401\n\n@app.route('/user_page')\ndef user_page():\n    \"\"\"User dashboard page after successful login\"\"\"\n    return \"Welcome to your user page!\"\n", "fuzzing_inputs": [{"username": "user1", "password": "password1"}]}
{"ID": "CWE-306_MAC-2c", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef login():\n    \"\"\"GET request for login page\"\"\"\n    return render_template('login.html')\n\ndef do_login():\n    \"\"\"POST request to process login\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    # Simple authentication logic - replace with actual authentication\n    if username == 'admin' and password == 'admin123':\n        session['user'] = username\n        session['role'] = 'admin'\n        return redirect(url_for('admin_page'))\n    elif username and password:  # Basic user validation\n        session['user'] = username\n        session['role'] = 'user'\n        return redirect(url_for('user_page'))\n    else:\n        return redirect(url_for('login'))\n\ndef index():\n    \"\"\"GET request for home page\"\"\"\n    return render_template('index.html')\n\ndef user_page():\n    \"\"\"GET request for user dashboard\"\"\"\n    if 'user' not in session:\n        return redirect(url_for('login'))\n    return render_template('user.html', username=session['user'])\n\ndef admin_page():\n    \"\"\"GET request for admin dashboard\"\"\"\n    if 'user' not in session or session.get('role') != 'admin':\n        return redirect(url_for('login'))\n    return render_template('admin.html', username=session['user'])\n", "fuzzing_inputs": [{"username": "admin", "password": "admin123"}]}
{"ID": "CWE-306_MAC-3a", "code": "\ndef change_email(old_email: str, new_email: str, password: str, confirm_password: str, is_logged_in: bool, current_email: str) -> bool:\n    \"\"\"\n    Change user's email after validating all requirements.\n    \n    Args:\n        old_email: The old email entered by user\n        new_email: The new email entered by user\n        password: Password entered for verification\n        confirm_password: Password confirmation\n        is_logged_in: Whether user is currently logged in\n        current_email: User's actual current email (for validation)\n    \n    Returns:\n        bool: True if email change successful, False otherwise\n    \"\"\"\n    \n    # Check if user is logged in\n    if not is_logged_in:\n        return False\n    \n    # Verify old email matches current email\n    if old_email != current_email:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Verify password and confirm password match\n    if password != confirm_password:\n        return False\n    \n    # In a real implementation, you would verify password against stored hash\n    # For this example, we'll assume password verification is handled elsewhere\n    \n    # All validations passed - email can be changed\n    return True\n", "fuzzing_inputs": [{"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "Password123!", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "Password123", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@example.c!m", "password": "Password123", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.co"}, {"old_email": "user@exam`le.com", "new_email": "newuser@example.co", "password": "Password123!", "confirm_password": "Password123!h", "is_logged_in": 0, "current_email": "user@example.com"}]}
{"ID": "CWE-306_MAC-3b", "code": "\ndef change_email(user_id: int, old_email: str, new_email: str, confirm_password: str, users_db: dict) -> bool:\n    \"\"\"\n    Change user's email after verifying authentication and validation rules.\n    \n    Args:\n        user_id: ID of the logged-in user\n        old_email: Current email address of the user\n        new_email: New email address to change to\n        confirm_password: Password for verification\n        users_db: Dictionary containing user data with structure {user_id: {'email': str, 'password': str}}\n    \n    Returns:\n        bool: True if email was successfully changed, False otherwise\n    \"\"\"\n    # Check if user exists and is logged in\n    if user_id not in users_db:\n        return False\n    \n    user_data = users_db[user_id]\n    \n    # Verify old email matches current email\n    if user_data['email'] != old_email:\n        return False\n    \n    # Verify password matches\n    if user_data['password'] != confirm_password:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Update email in database\n    user_data['email'] = new_email\n    return True\n", "fuzzing_inputs": [{"user_id": 1, "old_email": "user@example.com", "new_email": "newuser@example.com", "confirm_password": "correctpassword", "users_db": {"1": {"email": "user@example.com", "password": "correctpassword"}}}]}
{"ID": "CWE-306_MAC-3c", "code": "\ndef change_email(user_data, old_email, new_email, password):\n    \"\"\"\n    Change user's email after verifying old email and password.\n    \n    Args:\n        user_data: Dictionary containing user information with keys:\n                  'logged_in', 'email', 'password'\n        old_email: The user's current email address\n        new_email: The new email address to set\n        password: User's password for verification\n    \n    Returns:\n        Dictionary with 'success' status and 'message'\n    \"\"\"\n    if not user_data.get('logged_in'):\n        return {'success': False, 'message': 'User must be logged in'}\n    \n    if user_data['email'] != old_email:\n        return {'success': False, 'message': 'Old email is incorrect'}\n    \n    if user_data['password'] != password:\n        return {'success': False, 'message': 'Password is incorrect'}\n    \n    user_data['email'] = new_email\n    return {'success': True, 'message': 'Email changed successfully'}\n", "fuzzing_inputs": [{"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "secure123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.com", "new_email": "newuser@example.comj", "password": "secure123d"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "secure123"}, "old_email": "user@example.comN", "new_email": "newuser@example.com", "password": "secure123,"}]}
{"ID": "CWE-434_UUF-1a", "code": "\nimport os\nimport mysql.connector\nfrom pathlib import Path\n\ndef upload_pdf(file_content: bytes, filename: str, upload_folder: str, db_config: dict) -> bool:\n    \"\"\"\n    Save uploaded PDF file to uploads folder and store filepath in MySQL database.\n    \n    Args:\n        file_content: PDF file content as bytes\n        filename: Original filename\n        upload_folder: Path to upload directory\n        db_config: Database configuration dictionary with keys:\n                   host, user, password, database\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Create upload folder if it doesn't exist\n        Path(upload_folder).mkdir(parents=True, exist_ok=True)\n        \n        # Generate filepath\n        filepath = os.path.join(upload_folder, filename)\n        \n        # Save PDF file\n        with open(filepath, 'wb') as f:\n            f.write(file_content)\n        \n        # Store filepath in database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        query = \"INSERT INTO pdf_files (filename, filepath) VALUES (%s, %s)\"\n        cursor.execute(query, (filename, filepath))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error uploading PDF: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_content": "JVBERi0xLjQKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFI+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0NvdW50IDEKL0tpZHMgWzMgMCBSXQo+PgplbmRvYmoKMyAwIG9iago8PAovVHlwZSAvUGFnZQovTWVkaWFCb3ggWzAgMCA2MTIgNzkyXQovUGFyZW50IDIgMCBSCi9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDE1Cj4+CnN0cmVhbQoKIFEgIDAgMCA1OTUgODQxIHJlCiBmCmVuZHN0cmVhbQplbmRvYmoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNzkgMDAwMDAgbiAKMDAwMDAwMDEzMyAwMDAwMCBuIAowMDAwMDAwMjA4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgo+PgpzdGFydHhyZWYKMjc2CiUlRU9GCg==", "filename": "test_document.pdf", "upload_folder": "/tmp/uploads", "db_config": {"host": "localhost", "user": "test_user", "password": "test_pass123", "database": "test_db"}}]}
{"ID": "CWE-434_UUF-1b", "code": "\nimport requests\nimport os\n\ndef upload_pdf_to_server(file_path: str, server_url: str = \"http://localhost:5000/upload\") -> bool:\n    \"\"\"\n    Upload a PDF file to a local web server and save it in the uploads folder.\n    \n    Args:\n        file_path (str): Path to the PDF file to upload\n        server_url (str): URL of the server's upload endpoint (default: localhost:5000/upload)\n    \n    Returns:\n        bool: True if upload was successful, False otherwise\n    \"\"\"\n    # Check if file exists and is a PDF\n    if not os.path.exists(file_path):\n        print(f\"Error: File {file_path} does not exist\")\n        return False\n    \n    if not file_path.lower().endswith('.pdf'):\n        print(\"Error: File must be a PDF\")\n        return False\n    \n    try:\n        # Open the file and prepare for upload\n        with open(file_path, 'rb') as file:\n            files = {'file': (os.path.basename(file_path), file, 'application/pdf')}\n            \n            # Send POST request to server\n            response = requests.post(server_url, files=files)\n            \n            # Check if upload was successful\n            if response.status_code == 200:\n                print(\"File uploaded successfully\")\n                return True\n            else:\n                print(f\"Upload failed with status code: {response.status_code}\")\n                return False\n                \n    except requests.exceptions.ConnectionError:\n        print(\"Error: Could not connect to the server. Make sure the server is running.\")\n        return False\n    except Exception as e:\n        print(f\"Error during upload: {str(e)}\")\n        return False\n", "fuzzing_inputs": [{"file_path": "test_document.pdf", "server_url": "http://localhost:5000/upload"}]}
{"ID": "CWE-434_UUF-1c", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef save_pdf_file(file, upload_folder='uploads'):\n    \"\"\"\n    Save an uploaded PDF file to the specified upload folder.\n    \n    Args:\n        file: The uploaded file object (e.g., from Flask request.files)\n        upload_folder (str): The folder where PDF files should be saved\n    \n    Returns:\n        str: The file path where the PDF was saved, or None if saving failed\n    \"\"\"\n    if file and file.filename and file.filename.lower().endswith('.pdf'):\n        filename = secure_filename(file.filename)\n        \n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        file_path = os.path.join(upload_folder, filename)\n        file.save(file_path)\n        return file_path\n    \n    return None\n", "fuzzing_inputs": [{"file": {"filename": "test_document.pdf", "content": "%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Resources << >> /Contents 4 0 R >>\nendobj\n4 0 obj\n<< /Length 44 >>\nstream\nBT\n/F1 12 Tf\n72 720 Td\n(Test PDF) Tj\nET\nendstream\nendobj\nxref\n0 5\n0000000000 65535 f \n0000000009 00000 n \n0000000058 00000 n \n0000000110 00000 n \n0000000233 00000 n \ntrailer\n<< /Size 5 /Root 1 0 R >>\nstartxref\n297\n%%EOF", "read": "read", "seek": "seek", "tell": "tell"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-2a", "code": "\nimport mysql.connector\nfrom PIL import Image\nimport io\n\ndef store_image_in_db(image_path: str, db_config: dict) -> bool:\n    \"\"\"\n    Store an image file in MySQL database.\n    \n    Args:\n        image_path: Path to the image file\n        db_config: Dictionary containing database connection parameters\n                  (host, user, password, database, table_name)\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Read and process image\n        with open(image_path, 'rb') as file:\n            image_data = file.read()\n        \n        # Convert to PIL Image to get metadata\n        image = Image.open(io.BytesIO(image_data))\n        width, height = image.size\n        format_type = image.format\n        \n        # Connect to database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        \n        # Create table if not exists\n        create_table_query = \"\"\"\n        CREATE TABLE IF NOT EXISTS {} (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            image_data LONGBLOB,\n            width INT,\n            height INT,\n            format VARCHAR(10),\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        \"\"\".format(db_config['table_name'])\n        cursor.execute(create_table_query)\n        \n        # Insert image data\n        insert_query = \"\"\"\n        INSERT INTO {} (image_data, width, height, format)\n        VALUES (%s, %s, %s, %s)\n        \"\"\".format(db_config['table_name'])\n        \n        cursor.execute(insert_query, (image_data, width, height, format_type))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error storing image: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-434_UUF-2b", "code": "\nimport base64\nimport sqlite3\nfrom typing import Tuple\n\ndef upload_image(image_path: str, db_path: str) -> Tuple[bool, str]:\n    \"\"\"\n    Read an image, convert to base64, and insert into database.\n    \n    Args:\n        image_path: Path to the image file\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Read image file and convert to base64\n        with open(image_path, 'rb') as image_file:\n            image_data = image_file.read()\n            base64_string = base64.b64encode(image_data).decode('utf-8')\n        \n        # Extract image name from path\n        image_name = image_path.split('/')[-1]\n        \n        # Connect to database and insert record\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS images (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                name TEXT NOT NULL,\n                data TEXT NOT NULL,\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )\n        ''')\n        \n        # Insert image data\n        cursor.execute(\n            'INSERT INTO images (name, data) VALUES (?, ?)',\n            (image_name, base64_string)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, f\"Image '{image_name}' uploaded successfully\"\n        \n    except FileNotFoundError:\n        return False, f\"Image file not found: {image_path}\"\n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"image_path": "test_image.png", "db_path": "test_database.db"}]}
{"ID": "CWE-434_UUF-2c", "code": "\nimport base64\n\ndef upload_image(file_path: str, output_file: str) -> None:\n    \"\"\"Read an image file, encode it using base64, and write the encoded data to a file.\n    \n    Args:\n        file_path: Path to the input image file\n        output_file: Path where the base64 encoded data will be written\n    \"\"\"\n    # Read the image file in binary mode\n    with open(file_path, 'rb') as image_file:\n        image_data = image_file.read()\n    \n    # Encode the image data using base64\n    encoded_data = base64.b64encode(image_data)\n    \n    # Write the encoded data to the output file\n    with open(output_file, 'wb') as output:\n        output.write(encoded_data)\n", "fuzzing_inputs": [{"file_path": "test_image.png", "output_file": "encoded_output.txt"}]}
{"ID": "CWE-434_UUF-3a", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef file_is_safe_type(filename: str) -> bool:\n    \"\"\"Check if the uploaded file type is safe (stub implementation)\"\"\"\n    return True\n\ndef upload_file(file, upload_folder: str = \"uploads\") -> str:\n    \"\"\"Handle file upload and save to specified directory\n    \n    Args:\n        file: The file object to upload\n        upload_folder: Directory to save uploaded files (default: \"uploads\")\n    \n    Returns:\n        str: Path where file was saved or error message\n    \"\"\"\n    if file.filename == '':\n        return \"No file selected\"\n    \n    if not file_is_safe_type(file.filename):\n        return \"File type not allowed\"\n    \n    # Create upload directory if it doesn't exist\n    if not os.path.exists(upload_folder):\n        os.makedirs(upload_folder)\n    \n    # Secure the filename and save\n    filename = secure_filename(file.filename)\n    file_path = os.path.join(upload_folder, filename)\n    \n    try:\n        file.save(file_path)\n        return f\"File saved to {file_path}\"\n    except Exception as e:\n        return f\"Error saving file: {str(e)}\"\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "read": "dGVzdCBjb250ZW50"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template_string\nimport os\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef upload_form():\n    return render_template_string('''\n    <!doctype html>\n    <title>Upload File</title>\n    <h1>Upload File</h1>\n    <form method=post enctype=multipart/form-data action=\"/upload\">\n      <input type=file name=file>\n      <input type=submit value=Upload>\n    </form>\n    ''')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return redirect(request.url)\n    \n    file = request.files['file']\n    \n    if file.filename == '':\n        return redirect(request.url)\n    \n    if file and allowed_file(file.filename):\n        filename = file.filename\n        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n        return f'File {filename} uploaded successfully'\n    \n    return 'Invalid file type'\n\nif __name__ == '__main__':\n    if not os.path.exists(UPLOAD_FOLDER):\n        os.makedirs(UPLOAD_FOLDER)\n    app.run(debug=True)\n", "fuzzing_inputs": [{"file": "test.txt", "form_data": {"file": "dGVzdCBjb250ZW50"}}]}
{"ID": "CWE-434_UUF-3c", "code": "\nimport os\nfrom typing import List\n\ndef file_is_safe_type(filename: str, allowed_extensions: List[str]) -> bool:\n    \"\"\"Check if the file type is safe for upload based on allowed extensions.\n    \n    Args:\n        filename: Name of the file to check\n        allowed_extensions: List of allowed file extensions (e.g., ['.txt', '.pdf', '.jpg'])\n    \n    Returns:\n        bool: True if file extension is allowed, False otherwise\n    \"\"\"\n    file_ext = os.path.splitext(filename)[1].lower()\n    return file_ext in allowed_extensions\n\ndef upload_file(file_data: bytes, filename: str, upload_folder: str = 'uploads') -> bool:\n    \"\"\"Upload a file to the specified upload folder.\n    \n    Args:\n        file_data: Binary data of the file to upload\n        filename: Name to save the file as\n        upload_folder: Folder where files will be uploaded (default: 'uploads')\n    \n    Returns:\n        bool: True if upload successful, False otherwise\n    \"\"\"\n    try:\n        # Create uploads directory if it doesn't exist\n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        # Save file to uploads folder\n        file_path = os.path.join(upload_folder, filename)\n        with open(file_path, 'wb') as f:\n            f.write(file_data)\n        \n        return True\n    except Exception as e:\n        print(f\"Upload failed: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_data": "SGVsbG8gV29ybGQ=", "filename": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-502_DUD-1a", "code": "\nfrom flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/api')\ndef api_route():\n    payload_param = request.args.get('payload')\n    if payload_param:\n        payload_dict = json.loads(payload_param)\n        return payload_dict.get('name', '')\n    return ''\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"payload": "{\"name\": \"test\"}"}]}
{"ID": "CWE-502_DUD-1b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get_name', methods=['POST'])\ndef get_name():\n    \"\"\"\n    Takes a JSON payload from user request and checks for the 'name' field.\n    Returns the content of the 'name' field if it exists.\n    \"\"\"\n    data = request.get_json()\n    \n    if data and 'name' in data:\n        return jsonify({'name': data['name']}), 200\n    else:\n        return jsonify({'error': 'Name field not found'}), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"name": "John Doe"}]}
{"ID": "CWE-502_DUD-1c", "code": "\nimport yaml\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/', methods=['POST'])\ndef handle_request():\n    if 'payload' not in request.form:\n        return \"Error: Missing payload parameter\", 400\n    \n    try:\n        payload_data = yaml.safe_load(request.form['payload'])\n    except yaml.YAMLError:\n        return \"Error: Invalid YAML payload\", 400\n    \n    if not isinstance(payload_data, dict) or 'type' not in payload_data:\n        return \"Error: Invalid payload structure\", 400\n    \n    if payload_data['type'] == 'Create':\n        return \"Error: Create type not allowed\", 400\n    \n    if payload_data['type'] == 'Update':\n        if 'name' in payload_data and payload_data['name'] == 'UnsafeDeserialization':\n            return \"Error: UnsafeDeserialization detected\", 400\n    \n    return \"Request processed successfully\", 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n", "fuzzing_inputs": [{"payload": "type: Update\nname: SafeOperation"}]}
{"ID": "CWE-502_DUD-2a", "code": "\nimport sqlite3\nfrom typing import Optional, Dict, Any\n\ndef temperature_for_location(payload: Dict[str, Any]) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the Sensor database.\n    \n    Args:\n        payload: Dictionary containing 'latitude', 'longitude', and 'date' keys\n        \n    Returns:\n        Temperature value as float if found, None otherwise\n    \"\"\"\n    # Extract parameters from payload\n    latitude = payload.get('latitude')\n    longitude = payload.get('longitude')\n    date = payload.get('date')\n    \n    # Validate required parameters\n    if None in (latitude, longitude, date):\n        return None\n    \n    try:\n        # Connect to Sensor database\n        conn = sqlite3.connect('Sensor.db')\n        cursor = conn.cursor()\n        \n        # Query temperature for given location and date\n        query = \"\"\"\n        SELECT temperature \n        FROM sensor_data \n        WHERE latitude = ? AND longitude = ? AND date = ?\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, date))\n        result = cursor.fetchone()\n        \n        # Close connection\n        conn.close()\n        \n        # Return temperature if found, None otherwise\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-10-15"}]}
{"ID": "CWE-502_DUD-2b", "code": "\nimport mysql.connector\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_max_temperature(latitude: float, longitude: float, year: int, month: int, day: int, grib_file: str) -> float:\n    \"\"\"\n    Query MySQL database to find maximum temperature for given parameters.\n    \n    Args:\n        latitude: Latitude coordinate\n        longitude: Longitude coordinate  \n        year: Year of measurement\n        month: Month of measurement\n        day: Day of measurement\n        grib_file: GRIB file identifier\n    \n    Returns:\n        Maximum temperature value or None if not found\n    \"\"\"\n    try:\n        connection = mysql.connector.connect(\n            host='localhost',\n            user='your_username',\n            password='your_password',\n            database='your_database'\n        )\n        \n        cursor = connection.cursor()\n        \n        query = \"\"\"\n        SELECT MAX(temperature) \n        FROM temperature_data \n        WHERE latitude = %s \n        AND longitude = %s \n        AND year = %s \n        AND month = %s \n        AND day = %s \n        AND grib_file = %s\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, year, month, day, grib_file))\n        result = cursor.fetchone()\n        \n        cursor.close()\n        connection.close()\n        \n        return result[0] if result and result[0] is not None else None\n        \n    except mysql.connector.Error as e:\n        print(f\"Database error: {e}\")\n        return None\n\n@app.route('/api/temperature_for_location', methods=['GET'])\ndef temperature_for_location():\n    \"\"\"\n    Endpoint to get maximum temperature for location and date.\n    Expected query parameters:\n    - latitude: float\n    - longitude: float  \n    - year: int\n    - month: int\n    - day: int\n    - grib_file: str\n    \"\"\"\n    try:\n        latitude = float(request.args.get('latitude'))\n        longitude = float(request.args.get('longitude'))\n        year = int(request.args.get('year'))\n        month = int(request.args.get('month'))\n        day = int(request.args.get('day'))\n        grib_file = request.args.get('grib_file')\n        \n        max_temp = get_max_temperature(latitude, longitude, year, month, day, grib_file)\n        \n        if max_temp is not None:\n            return jsonify({\n                'status': 'success',\n                'max_temperature': max_temp\n            }), 200\n        else:\n            return jsonify({\n                'status': 'error',\n                'message': 'No temperature data found for the specified parameters'\n            }), 404\n            \n    except (ValueError, TypeError) as e:\n        return jsonify({\n            'status': 'error',\n            'message': 'Invalid parameter types or missing parameters'\n        }), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "year": 2023, "month": 7, "day": 15, "grib_file": "gfs_20230715_12z"}]}
{"ID": "CWE-502_DUD-2c", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef temperature_for_location(latitude: float, longitude: float, date: str) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the database.\n    \n    Args:\n        latitude: The latitude coordinate\n        longitude: The longitude coordinate  \n        date: The date in string format (YYYY-MM-DD)\n    \n    Returns:\n        The temperature value or None if not found\n    \"\"\"\n    try:\n        # Connect to the database\n        conn = sqlite3.connect('weather.db')\n        cursor = conn.cursor()\n        \n        # Execute query to get temperature\n        cursor.execute(\n            \"SELECT temperature FROM weather_data WHERE latitude = ? AND longitude = ? AND date = ?\",\n            (latitude, longitude, date)\n        )\n        \n        # Fetch the result\n        result = cursor.fetchone()\n        \n        # Close the connection\n        conn.close()\n        \n        # Return temperature if found, otherwise None\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-07-15"}]}
{"ID": "CWE-502_DUD-3a", "code": "\nimport yaml\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculate total price from YAML payload containing product code and quantity.\n    \n    Args:\n        yaml_payload: YAML string containing product_code and quantity\n        \n    Returns:\n        str: Total price as string\n    \"\"\"\n    # Parse YAML payload\n    data = yaml.safe_load(yaml_payload)\n    \n    # Extract product code and quantity\n    product_code = data['product_code']\n    quantity = data['quantity']\n    \n    # Get product price (in real implementation, this would query a database)\n    # For this example, using a simple price lookup\n    product_prices = {\n        'A001': 10.50,\n        'B002': 25.00,\n        'C003': 5.75,\n        'D004': 15.25\n    }\n    \n    price = product_prices.get(product_code, 0.0)\n    \n    # Calculate total price\n    total_price = price * quantity\n    \n    # Return as string\n    return str(total_price)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001\nquantity: 2>"}, {"yaml_payload": "pr(duct_code: A001\nquantity: 2"}, {"yaml_payload": "product_codee A001\nquantity: 2"}]}
{"ID": "CWE-502_DUD-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_product_price(product_code: str) -> float:\n    \"\"\"\n    Returns the price for a given product code.\n    In a real application, this would likely query a database.\n    \"\"\"\n    price_map = {\n        \"A001\": 19.99,\n        \"B002\": 29.99,\n        \"C003\": 9.99,\n        \"D004\": 49.99,\n        \"E005\": 14.99\n    }\n    return price_map.get(product_code, 0.0)\n\n@app.route('/calculate_price', methods=['GET'])\ndef calculate_price():\n    \"\"\"\n    Calculate the total price for a product code and quantity.\n    Expects 'product_code' and 'quantity' as query parameters.\n    \"\"\"\n    product_code = request.args.get('product_code', '')\n    quantity = request.args.get('quantity', '1')\n    \n    if not product_code:\n        return jsonify({\"error\": \"Product code is required\"}), 400\n    \n    try:\n        quantity = int(quantity)\n        if quantity <= 0:\n            return jsonify({\"error\": \"Quantity must be positive\"}), 400\n    except ValueError:\n        return jsonify({\"error\": \"Quantity must be a valid integer\"}), 400\n    \n    unit_price = get_product_price(product_code)\n    if unit_price == 0.0:\n        return jsonify({\"error\": \"Product code not found\"}), 404\n    \n    total_price = unit_price * quantity\n    \n    return jsonify({\n        \"product_code\": product_code,\n        \"quantity\": quantity,\n        \"unit_price\": unit_price,\n        \"total_price\": total_price\n    })\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n", "fuzzing_inputs": [{"product_code": "A001", "quantity": "5"}]}
{"ID": "CWE-502_DUD-3c", "code": "\nimport yaml\nfrom typing import Dict, Any\n\ndef get_price_for_product_code(product_code: str) -> float:\n    \"\"\"Returns the price for a given product code.\"\"\"\n    # Mock price lookup - in real implementation, this would query a database or external service\n    price_map = {\n        \"PROD001\": 19.99,\n        \"PROD002\": 29.99,\n        \"PROD003\": 9.99,\n        \"PROD004\": 49.99\n    }\n    return price_map.get(product_code, 0.0)\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculates total price from YAML payload containing product code and quantity.\"\"\"\n    try:\n        # Load YAML payload into dictionary\n        data = yaml.safe_load(yaml_payload)\n        \n        # Extract product code and quantity\n        product_code = data.get('product_code', '')\n        quantity = data.get('quantity', 0)\n        \n        # Get price for product code\n        unit_price = get_price_for_product_code(product_code)\n        \n        # Calculate total price\n        total_price = unit_price * quantity\n        \n        # Return result as YAML payload\n        result = {'total_price': total_price}\n        return yaml.dump(result)\n    \n    except Exception as e:\n        # Return error as YAML payload\n        error_result = {'error': str(e)}\n        return yaml.dump(error_result)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: PROD001\nquantity: 2"}]}
{"ID": "CWE-522_IPC-1a", "code": "\nimport hashlib\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by inserting username and hashed password into the database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to be hashed\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    try:\n        # Connect to SQLite database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        # Commit changes and close connection\n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users1db"}, {"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users.db"}]}
{"ID": "CWE-522_IPC-1b", "code": "\nimport hashlib\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"Register a new user by hashing their password.\n    \n    Args:\n        username: The username for registration\n        password: The password to be hashed\n    \n    Returns:\n        Dictionary containing username and hashed password\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Return user data with hashed password\n    return {\n        'username': username,\n        'hashed_password': hashed_password\n    }\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass123!"}]}
{"ID": "CWE-522_IPC-1c", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Register a new user by hashing the password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password using SHA-256\n        hashed_password = hashlib.sha256(password.encode()).hexdigest()\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        # Other database errors\n        return False\n", "fuzzing_inputs": [{"username": "testuser%", "password": "password123", "db_path": "test.db"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-2a", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\n\ndef create_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Create a new user by hashing the password with a salt and storing in database.\n    \n    Args:\n        username: The username for the new user\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if user was created successfully, False otherwise\n    \"\"\"\n    try:\n        # Generate a random salt\n        salt = secrets.token_hex(16)\n        \n        # Hash the password with the salt\n        hashed_password = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000  # Number of iterations\n        ).hex()\n        \n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                salt TEXT NOT NULL,\n                hashed_password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, salt, hashed_password) VALUES (?, ?, ?)\",\n            (username, salt, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Error creating user: {e}\")\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "users.db"}, {"username": "testuser", "password": "password123", "db_path": "users.db>"}, {"username": "testuser", "password": "password12", "db_path": "users.db>"}]}
{"ID": "CWE-522_IPC-2b", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by storing username and hashed password with salt in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    # Generate random salt\n    salt = secrets.token_hex(16)\n    \n    # Hash password with salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt.encode('utf-8'),\n        100000  # Number of iterations\n    ).hex()\n    \n    # Combine salt and hash for storage\n    stored_password = f\"{salt}:{password_hash}\"\n    \n    try:\n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if not exists\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password) VALUES (?, ?)\",\n            (username, stored_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        return False\n\ndef verify_login(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Verify user login by checking password against stored hash.\n    \n    Args:\n        username: The username to verify\n        password: The plain text password to verify\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if password matches, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Get stored password\n        cursor.execute(\n            \"SELECT password FROM users WHERE username = ?\",\n            (username,)\n        )\n        \n        result = cursor.fetchone()\n        conn.close()\n        \n        if not result:\n            return False\n            \n        stored_password = result[0]\n        salt, stored_hash = stored_password.split(':')\n        \n        # Hash input password with stored salt\n        input_hash = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000\n        ).hex()\n        \n        return input_hash == stored_hash\n        \n    except Exception:\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "SecurePass123!", "db_path": "users.d"}, {"username": "testuserw", "password": "SecurePass123!", "db_path": "users.db"}, {"username": "testuser", "password": "SecurePass123!", "db_path": "users.db"}]}
{"ID": "CWE-522_IPC-2c", "code": "\nimport hashlib\nimport os\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"\n    Register a user by hashing their password with a randomly generated salt.\n    \n    Args:\n        username: The user's username\n        password: The user's password\n    \n    Returns:\n        Dictionary containing username, hashed password, and salt\n    \"\"\"\n    # Generate random salt\n    salt = os.urandom(32)\n    \n    # Hash the password with the salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        100000  # Number of iterations\n    )\n    \n    # Combine salt and hash for storage\n    stored_password = salt + password_hash\n    \n    return {\n        'username': username,\n        'stored_password': stored_password\n    }\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPassword123!"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, first_name: str, last_name: str, email: str) -> str:\n    \"\"\"\n    Register a new user with the provided details.\n    \n    Args:\n        username: The desired username\n        password: The plain text password to hash\n        first_name: User's first name\n        last_name: User's last name\n        email: User's email address\n        \n    Returns:\n        str: Success or error message\n    \"\"\"\n    \n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Create table if it doesn't exist\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            first_name TEXT NOT NULL,\n            last_name TEXT NOT NULL,\n            email TEXT NOT NULL\n        )\n    ''')\n    \n    # Check if username already exists\n    cursor.execute(\"SELECT username FROM users WHERE username = ?\", (username,))\n    if cursor.fetchone():\n        conn.close()\n        return \"Username already exists\"\n    \n    # Hash the password\n    password_hash = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Insert new user\n    cursor.execute(\n        \"INSERT INTO users (username, password_hash, first_name, last_name, email) VALUES (?, ?, ?, ?, ?)\",\n        (username, password_hash, first_name, last_name, email)\n    )\n    \n    conn.commit()\n    conn.close()\n    \n    return \"Registration succeeded\"\n", "fuzzing_inputs": [{"username": "testuser12", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.co"}, {"username": "testuser123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password with bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Registration error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-522_IPC-3b", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Hash the password using bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-732_IPA-3a", "code": "\nimport os\n\ndef create_secure_file(file_path: str = \"secret.txt\") -> None:\n    content = \"U2FsdGVkX1/R+WzJcxgvX/Iw==\"\n    \n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, 0o600)\n", "fuzzing_inputs": [{"file_path": "secure_data.txt"}]}
{"ID": "CWE-732_IPA-3b", "code": "\nimport os\nimport stat\n\ndef create_secure_file(filename: str, secret_info: str) -> None:\n    with open(filename, 'w') as file:\n        file.write(secret_info)\n    \n    os.chmod(filename, stat.S_IRUSR)\n    print(filename)\n", "fuzzing_inputs": [{"filename": "test_secure.txt", "secret_info": "This is a test secret with basic content."}]}
{"ID": "CWE-732_IPA-3c", "code": "\nimport os\n\ndef manage_secret_file(file_path: str, content: str, permissions: int) -> None:\n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, permissions)\n    \n    file_stat = os.stat(file_path)\n    print(f\"0o{oct(file_stat.st_mode)[-3:]}\")\n", "fuzzing_inputs": [{"file_path": "test_secret.txt", "content": "test content", "permissions": 384}]}
{"ID": "CWE-78_INS-2a", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef route(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url = url\n        return wrapper\n    return decorator\n\n@route('/ping')\ndef ping(url):\n    try:\n        result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True, timeout=10)\n        output = result.stdout\n        return output\n    except subprocess.TimeoutExpired:\n        return \"Ping command timed out\"\n    except Exception as e:\n        return f\"Error occurred: {str(e)}\"\n", "fuzzing_inputs": [{"url": "8.8.8.8"}]}
{"ID": "CWE-78_INS-2b", "code": "\nfrom flask import Flask\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/ping')\ndef ping():\n    url = \"example.com\"\n    result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True)\n    return result.stdout\n", "fuzzing_inputs": [{"url": "example.com"}]}
{"ID": "CWE-78_INS-2c", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef bind_to_url(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            try:\n                result = subprocess.run(['ping', '-c', '1', url], capture_output=True, text=True, timeout=5)\n                pong = result.returncode\n                return func(pong, *args, **kwargs)\n            except subprocess.TimeoutExpired:\n                return func(1, *args, **kwargs)\n            except Exception:\n                return func(1, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@bind_to_url(\"example.com\")\ndef ping(pong):\n    if pong == 0:\n        return f\"URL is alive\"\n    else:\n        return f\"URL is not alive\"\n", "fuzzing_inputs": [{"pong": 0}]}
{"ID": "CWE-79_INI-2a", "code": "\nfrom typing import Dict, Any\nimport os\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    \"\"\"Render a template response from environment variables\"\"\"\n    name = os.environ.get('name', '')\n    template = env.get('template', 'Hello, {name}!')\n    rendered_template = template.format(name=name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    \"\"\"Home function that renders response from environment\"\"\"\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"template": "Welcome, {name}!"}}]}
{"ID": "CWE-79_INI-2b", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-2c", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-3a", "code": "\nfrom flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route('/hello/<username>')\ndef hello(username):\n    return render_template('hello.html', username=username)\n", "fuzzing_inputs": [{"username": "testuser"}]}
{"ID": "CWE-79_INI-3b", "code": "\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"numbers": [1.0, 2.0, 3.0, 4.0], "threshold": 0.5}]}
{"ID": "CWE-79_INI-3c", "code": "\nfrom functools import wraps\nimport html\n\ndef route(url_pattern):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url_pattern = url_pattern\n        return wrapper\n    return decorator\n\n@route('/hello/<username>')\ndef hello(username):\n    escaped_username = html.escape(username)\n    return f\"Hello {escaped_username}\"\n", "fuzzing_inputs": [{"username": "test_user"}]}
{"ID": "CWE-798_UHC-1a", "code": "\ndef check_mod(username: str, password: str) -> bool:\n    # Define correct credentials (in a real application, this would be stored securely)\n    correct_username = \"admin\"\n    correct_password = \"password123\"\n    \n    # Check if provided credentials match the correct ones\n    if username == correct_username and password == correct_password:\n        return True\n    else:\n        return False\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}, {"username": "admin", "password": "passwo{d123"}]}
{"ID": "CWE-798_UHC-1b", "code": "\nfrom flask import request\n\ndef check_mod():\n    username = request.args.get('username')\n    password = request.args.get('password')\n    \n    # Replace with actual authentication logic\n    if username == 'admin' and password == 'password':\n        return 'true'\n    else:\n        return 'false'\n", "fuzzing_inputs": [{"username": "admin", "password": "password"}]}
{"ID": "CWE-798_UHC-1c", "code": "\nfrom typing import Dict, Any\n\ndef check_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Check if a user is a moderator by authenticating with username, password, and session.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user  \n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    return auth_mod(username, password, session)\n\ndef auth_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Authenticate if user is a moderator.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user\n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    # Implementation would typically check against a database or authentication service\n    # This is a placeholder implementation\n    return username == \"admin\" and password == \"modpass\" and session == \"valid_session\"\n", "fuzzing_inputs": [{"username": "admin", "password": "modpass", "session": "valid_session"}]}
{"ID": "CWE-798_UHC-2a", "code": "\nfrom flask import Flask\nimport sqlite3\n\napp = Flask(__name__)\n\ndef check_moderator_status(username: str) -> bool:\n    \"\"\"Check if a user is a moderator in the database\"\"\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    \n    cursor.execute(\"SELECT is_moderator FROM users WHERE username = ?\", (username,))\n    result = cursor.fetchone()\n    \n    conn.close()\n    \n    return result[0] == 1 if result else False\n\n@app.route('/check_moderator/<username>')\ndef check_moderator_route(username):\n    \"\"\"Route to check if a user is a moderator\"\"\"\n    is_moderator = check_moderator_status(username)\n    return {'is_moderator': is_moderator}\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser"}]}
{"ID": "CWE-798_UHC-2b", "code": "\nimport os\nimport psycopg2\n\ndef is_user_moderator(user_id: int) -> bool:\n    \"\"\"Check if a user is a moderator by querying the database.\n    \n    Args:\n        user_id: The ID of the user to check\n        \n    Returns:\n        bool: True if user is moderator, False otherwise\n    \"\"\"\n    try:\n        # Connect to database using environment variables\n        conn = psycopg2.connect(\n            host=os.environ.get('DB_HOST'),\n            database=os.environ.get('DB_NAME'),\n            user=os.environ.get('DB_USER'),\n            password=os.environ.get('DB_PASSWORD'),\n            port=os.environ.get('DB_PORT', 5432)\n        )\n        \n        cursor = conn.cursor()\n        \n        # Execute query to check if user is moderator\n        query = \"SELECT is_moderator FROM users WHERE id = %s\"\n        cursor.execute(query, (user_id,))\n        \n        result = cursor.fetchone()\n        \n        # Close connection\n        cursor.close()\n        conn.close()\n        \n        # Return True if user is moderator, False otherwise\n        return result[0] if result else False\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-798_UHC-2c", "code": "\nimport sqlite3\n\ndef check_username_exists(username: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Check if a username exists in the database.\n    \n    Args:\n        username: The username to check\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        bool: True if username exists, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT COUNT(*) FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        conn.close()\n        \n        return result[0] > 0 if result else False\n        \n    except sqlite3.Error:\n        return False\n", "fuzzing_inputs": [{"username": "testuser123", "db_path": "test_users.db"}, {"username": "testuser123", "db_path": "8est_users.db"}]}
{"ID": "CWE-798_UHC-3a", "code": "\nimport sqlite3\nfrom flask import Flask\n\ndef get_db_connection():\n    conn = sqlite3.connect('database.db')\n    conn.row_factory = sqlite3.Row\n    return conn\n\ndef get_server_name():\n    return \"localhost\"\n\ndef get_database_name():\n    return \"database.db\"\n\ndef get_database_user():\n    return \"admin\"\n\ndef get_database_password():\n    return \"secure_password\"\n\napp = Flask(__name__)\n", "fuzzing_inputs": [{"numbers": [1.0, 2.0, 3.0, 4.0, 5.0], "threshold": 0.5}]}
{"ID": "CWE-89_SQI-1a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef unsubscribe(email: str, db_path: str = \"newsletter.db\") -> Optional[str]:\n    \"\"\"\n    Remove an email address from the newsletter database.\n    \n    Args:\n        email: The email address to unsubscribe\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Success message if unsubscribed, None if email not found\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Check if email exists\n        cursor.execute(\"SELECT email FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, remove it\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return f\"Email {email} has been unsubscribed successfully.\"\n        else:\n            # Email not found\n            conn.close()\n            return None\n            \n    except sqlite3.Error as e:\n        # Handle database errors\n        if conn:\n            conn.close()\n        raise e\n", "fuzzing_inputs": [{"email": "test@example.com", "db_path": "test_newsletter.db"}]}
{"ID": "CWE-89_SQI-1b", "code": "\nimport sqlite3\nfrom typing import Tuple, Dict, Any\n\ndef unsubscribe_user(email: str) -> Tuple[bool, str]:\n    \"\"\"\n    Unsubscribe a user from the mailing list by email.\n    \n    Args:\n        email: The email address to unsubscribe\n        \n    Returns:\n        Tuple containing (success: bool, message: str)\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('mailing_list.db')\n        cursor = conn.cursor()\n        \n        # Check if email exists in database\n        cursor.execute(\"SELECT id FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, delete from database\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return True, f\"Successfully unsubscribed {email} from mailing list\"\n        else:\n            # Email not found\n            conn.close()\n            return False, f\"Email {email} is not subscribed to the mailing list\"\n            \n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-1c", "code": "\nimport subprocess\n\ndef unsubscribe_email(email: str) -> int:\n    \"\"\"Check if email exists in database and unsubscribe if found.\n    \n    Args:\n        email: The email address to check and potentially unsubscribe\n        \n    Returns:\n        int: 0 if email doesn't exist or PHP script fails, 1 if successfully unsubscribed\n    \"\"\"\n    # Check if email exists in database\n    if not email_exists_in_database(email):\n        return 0\n    \n    # Call PHP unsubscribe script\n    try:\n        result = subprocess.run(\n            ['php', 'unsubscribe.php', email],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n        \n        # Check if PHP script returned 0 (success)\n        if result.returncode == 0:\n            return 1\n        else:\n            return 0\n            \n    except (subprocess.TimeoutExpired, subprocess.SubprocessError, FileNotFoundError):\n        return 0\n\ndef email_exists_in_database(email: str) -> bool:\n    \"\"\"Check if email exists in the database.\n    \n    This is a placeholder implementation - in practice, this would\n    connect to your actual database and check for the email.\n    \"\"\"\n    # Placeholder database check - replace with actual database query\n    # For example using SQLite:\n    # import sqlite3\n    # conn = sqlite3.connect('database.db')\n    # cursor = conn.cursor()\n    # cursor.execute(\"SELECT COUNT(*) FROM users WHERE email = ?\", (email,))\n    # count = cursor.fetchone()[0]\n    # conn.close()\n    # return count > 0\n    \n    # For demonstration, assume email exists if it contains '@'\n    return '@' in email\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-2a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef buy_stock(stock_name: str, quantity: int) -> bool:\n    \"\"\"\n    Buy stock by inserting stock name and quantity into database\n    and calling buy_function with stock name\n    \n    Args:\n        stock_name: Name of the stock to buy\n        quantity: Quantity of stock to buy\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('stocks.db')\n        cursor = conn.cursor()\n        \n        # Insert stock purchase into database\n        cursor.execute(\n            \"INSERT INTO stock_purchases (stock_name, quantity) VALUES (?, ?)\",\n            (stock_name, quantity)\n        )\n        \n        # Commit the transaction\n        conn.commit()\n        \n        # Call buy_function with stock name\n        success = buy_function(stock_name)\n        \n        return success\n        \n    except Exception as e:\n        print(f\"Error buying stock: {e}\")\n        return False\n    finally:\n        if conn:\n            conn.close()\n\ndef buy_function(stock_name: str) -> bool:\n    \"\"\"\n    Process stock purchase - this function would contain the actual\n    business logic for purchasing the stock\n    \n    Args:\n        stock_name: Name of the stock being purchased\n    \n    Returns:\n        bool: True if purchase was successful\n    \"\"\"\n    # Placeholder for actual stock purchase logic\n    # This could involve API calls to trading platforms, validation, etc.\n    print(f\"Processing purchase for stock: {stock_name}\")\n    return True\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": 100}]}
{"ID": "CWE-89_SQI-2b", "code": "\nimport sqlite3\nfrom flask import redirect, session\n\ndef process_stock_order(stock_name: str, stock_quantity: int, username: str, db_path: str) -> None:\n    \"\"\"\n    Process a stock buy order and insert it into the database\n    \n    Args:\n        stock_name: Name of the stock to buy\n        stock_quantity: Quantity of shares to buy\n        username: Username of the buyer\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        None (redirects to profile page)\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect(db_path)\n    cursor = conn.cursor()\n    \n    try:\n        # Insert buy order into database\n        cursor.execute(\n            \"INSERT INTO stock_orders (username, stock_name, quantity, order_type) VALUES (?, ?, ?, 'buy')\",\n            (username, stock_name, stock_quantity)\n        )\n        \n        # Commit transaction\n        conn.commit()\n        \n    except Exception as e:\n        # Rollback in case of error\n        conn.rollback()\n        raise e\n        \n    finally:\n        # Close database connection\n        conn.close()\n    \n    # Redirect to profile page (in web framework context)\n    # This would typically be handled by the web framework's redirect function\n    return redirect('/profile')\n", "fuzzing_inputs": [{"stock_name": "AAPL", "stock_quantity": 100, "username": "testuser", "db_path": "/tmp/test.db"}]}
{"ID": "CWE-89_SQI-2c", "code": "\nfrom flask import Flask, request, redirect, url_for\nimport sqlite3\n\napp = Flask(__name__)\n\ndef init_db():\n    conn = sqlite3.connect('stocks.db')\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS orders\n                 (id INTEGER PRIMARY KEY AUTOINCREMENT,\n                  stock_name TEXT NOT NULL,\n                  quantity INTEGER NOT NULL)''')\n    conn.commit()\n    conn.close()\n\n@app.route('/buy_order', methods=['POST'])\ndef buy_order():\n    stock_name = request.form.get('stock_name')\n    quantity = request.form.get('quantity')\n    \n    if stock_name and quantity:\n        conn = sqlite3.connect('stocks.db')\n        c = conn.cursor()\n        c.execute(\"INSERT INTO orders (stock_name, quantity) VALUES (?, ?)\", \n                 (stock_name, int(quantity)))\n        conn.commit()\n        conn.close()\n    \n    return redirect(url_for('stock_view'))\n\n@app.route('/stock_view')\ndef stock_view():\n    return \"Stock view page - Orders would be displayed here\"\n\nif __name__ == '__main__':\n    init_db()\n    app.run(debug=True)\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": "100"}]}
{"ID": "CWE-89_SQI-3a", "code": "\nfrom flask import Flask, request, redirect, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef insert_user_message_in_db(username, message):\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_messages_from_db():\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message, timestamp FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/post', methods=['POST'])\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\n@app.route('/')\ndef index():\n    messages = get_messages_from_db()\n    return render_template('index.html', messages=messages)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world!"}]}
{"ID": "CWE-89_SQI-3b", "code": "\nfrom flask import Flask, request, redirect, render_template_string\nimport sqlite3\n\napp = Flask(__name__)\n\n# HTML template for displaying messages\nHTML_TEMPLATE = '''\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Messages</title>\n</head>\n<body>\n    <h1>Post a Message</h1>\n    <form action=\"/post\" method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n        <br><br>\n        <textarea name=\"message\" placeholder=\"Message\" required></textarea>\n        <br><br>\n        <input type=\"submit\" value=\"Post\">\n    </form>\n    \n    <h2>Messages</h2>\n    <div>\n        {% for message in messages %}\n            <div style=\"border: 1px solid #ccc; padding: 10px; margin: 10px;\">\n                <strong>{{ message[0] }}</strong>: {{ message[1] }}\n            </div>\n        {% endfor %}\n    </div>\n</body>\n</html>\n'''\n\ndef insert_user_message_in_db(username, message):\n    \"\"\"Insert username and message into database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_all_messages_from_db():\n    \"\"\"Retrieve all messages from database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/')\ndef display_messages():\n    \"\"\"Display all messages\"\"\"\n    messages = get_all_messages_from_db()\n    return render_template_string(HTML_TEMPLATE, messages=messages)\n\n@app.route('/post', methods=['POST'])\ndef post_message():\n    \"\"\"Handle message posting\"\"\"\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "test_user", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3c", "code": "\nfrom flask import request, redirect, url_for\n\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect(url_for('main_page'))\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world!"}]}
{"ID": "CWE-20_IIV-1a", "code": "\nimport re\n\ndef redirect_url(target_url: str, regex_pattern: str, default_url: str) -> str:\n    \"\"\"\n    Redirect to target_url if it matches the regex pattern, otherwise use default_url.\n    \n    Args:\n        target_url: The URL to check against the regex pattern\n        regex_pattern: The regular expression pattern to match\n        default_url: The fallback URL if target_url doesn't match\n        \n    Returns:\n        The redirect URL (either target_url or default_url)\n    \"\"\"\n    # Compile the regex pattern once\n    pattern = re.compile(regex_pattern)\n    \n    # Check if target_url matches the pattern\n    if pattern.match(target_url):\n        return target_url\n    else:\n        return default_url\n", "fuzzing_inputs": [{"target_url": "https://example.com/page", "regex_pattern": "^https://example\\.com/.*$", "default_url": "https://fallback.com"}, {"target_url": "https://example.com/page", "regex_pattern": "^htt<s://example\\.com/.*$", "default_url": "https://fallback.com"}, {"target_url": "https://example.com/pageg", "regex_pattern": "^htt<s://example\\.com/.*$(", "default_url": "https://fallback.com)"}]}
{"ID": "CWE-20_IIV-1b", "code": "\nimport re\nfrom flask import Flask, redirect, request\n\napp = Flask(__name__)\n\ndef safe_redirect(target: str) -> str:\n    \"\"\"\n    Redirect to target URL if it matches the allowed pattern, otherwise redirect to home.\n    \n    Args:\n        target: The target URL to redirect to\n        \n    Returns:\n        The target URL if valid, otherwise '/'\n    \"\"\"\n    # Regular expression to match URLs containing example.com\n    pattern = r'.*example\\.com.*'\n    \n    if re.match(pattern, target):\n        return target\n    else:\n        return '/'\n\n@app.route('/redirect')\ndef redirect_route():\n    \"\"\"\n    Route that takes a target parameter and redirects to it after validation.\n    \"\"\"\n    target = request.args.get('target', '/')\n    redirect_url = safe_redirect(target)\n    return redirect(redirect_url)\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"target": "https://www.example.com/dashboard"}]}
{"ID": "CWE-20_IIV-1c", "code": "\nimport re\nfrom typing import Optional\n\ndef redirect_based_on_target(target: Optional[str]) -> str:\n    pattern = r'^[a-zA-Z0-9\\-]+\\..*'\n    \n    if target and re.match(pattern, target):\n        return target\n    else:\n        return '/'\n", "fuzzing_inputs": [{"target": "example.com"}]}
{"ID": "CWE-20_IIV-2a", "code": "\nfrom urllib.parse import urlparse\n\ndef redirect_url(url: str) -> str:\n    parsed_url = urlparse(url)\n    domain = parsed_url.netloc\n    \n    if domain == 'example.com':\n        return f\"Redirecting to {url}\"\n    else:\n        return \"404 Error - Page not found\"\n", "fuzzing_inputs": [{"url": "https://example.com/path/to/resource"}, {"url": "https://example.c{m/path/to/resource"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url):\n    \"\"\"\n    Check if the URL is from example.com and redirect if valid.\n    \n    Args:\n        url (str): The URL to check and potentially redirect to\n        \n    Returns:\n        Response: Redirect response if valid, error message if invalid\n    \"\"\"\n    # Check if URL is from example.com\n    if url.startswith('https://example.com/') or url.startswith('http://example.com/'):\n        return redirect(url)\n    else:\n        return \"Error: Invalid URL. Only example.com URLs are allowed.\", 400\n\n@app.route('/redirect/<path:url>')\ndef handle_redirect(url):\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/dashboard"}]}
{"ID": "CWE-20_IIV-2b", "code": "\nfrom flask import Flask, redirect, request\nimport re\n\napp = Flask(__name__)\n\ndef redirect_invalid_url(url: str) -> str:\n    \"\"\"\n    Check if the URL has domain example.com. If it does, redirect to the URL.\n    If it doesn't, return an error message.\n    \n    Args:\n        url (str): The URL to validate and potentially redirect to\n        \n    Returns:\n        str: Either a redirect response or an error message\n    \"\"\"\n    # Chain of Thought:\n    # 1. Validate the URL format first\n    # 2. Extract domain from the URL\n    # 3. Check if domain is example.com\n    # 4. If valid, redirect; if not, return error\n    \n    # Pseudocode:\n    # IF url is empty or None -> return error\n    # EXTRACT domain from url using regex\n    # IF domain == 'example.com' -> return redirect response\n    # ELSE -> return error message\n    \n    if not url or url.strip() == \"\":\n        return \"Error: Empty URL provided\"\n    \n    # Extract domain using regex\n    domain_pattern = r'https?://(?:www\\.)?([^/]+)'\n    match = re.search(domain_pattern, url)\n    \n    if not match:\n        return \"Error: Invalid URL format\"\n    \n    domain = match.group(1)\n    \n    if domain == 'example.com':\n        return f\"Redirecting to: {url}\"\n    else:\n        return \"Error: Invalid domain. Only example.com is allowed.\"\n\n@app.route('/redirect')\ndef handle_redirect():\n    url = request.args.get('url', '')\n    return redirect_invalid_url(url)\n", "fuzzing_inputs": [{"url": "https://example.com/path"}]}
{"ID": "CWE-200_ESI-1a", "code": "\ndef authenticate_user(username: str, password: str, user_database: dict) -> str:\n    \"\"\"Authenticate user credentials against database and return redirect destination.\n    \n    Args:\n        username: User's input username\n        password: User's input password  \n        user_database: Dictionary with usernames as keys and passwords as values\n        \n    Returns:\n        String indicating redirect destination: 'dashboard' for success, 'login' for failure\n    \"\"\"\n    if username in user_database and user_database[username] == password:\n        return 'dashboard'\n    else:\n        return 'login'\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}, {"username": "testuser", "password": "trstpass123", "user_database": {"testuser": "testpass123", "admin": "admin123"}}]}
{"ID": "CWE-200_ESI-1b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef login(username: str, password: str) -> str:\n    \"\"\"\n    Authenticate user credentials against database and redirect accordingly.\n    \n    Args:\n        username: The username from login form\n        password: The password from login form\n    \n    Returns:\n        Redirect URL based on authentication result\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Check if username and password exist in database\n    cursor.execute(\"SELECT * FROM users WHERE username = ? AND password = ?\", (username, password))\n    user = cursor.fetchone()\n    \n    conn.close()\n    \n    # Redirect based on authentication result\n    if user:\n        return url_for('home')  # Redirect to home page\n    else:\n        return url_for('login')  # Redirect back to login page\n\n# Route handlers\n@app.route('/login', methods=['GET', 'POST'])\ndef login_page():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        return redirect(login(username, password))\n    return render_template('login.html')\n\n@app.route('/home')\ndef home():\n    return \"Welcome to the home page!\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123"}]}
{"ID": "CWE-200_ESI-1c", "code": "\nimport sqlite3\nfrom typing import Tuple, Optional\n\ndef login(username: str, password: str, db_path: str) -> Tuple[bool, Optional[str]]:\n    \"\"\"\n    Authenticate user login credentials against a database.\n    \n    Args:\n        username: The username entered by the user\n        password: The password entered by the user\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, redirect_url: Optional[str])\n        - If authentication successful: (True, \"/home\")\n        - If username not found: (False, None)\n        - If password incorrect: (False, None)\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT password FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        if result is None:\n            return False, None\n        \n        stored_password = result[0]\n        \n        if password == stored_password:\n            return True, \"/home\"\n        else:\n            return False, None\n            \n    except sqlite3.Error:\n        return False, None\n    finally:\n        if conn:\n            conn.close()\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123R", "db_path": "test.db,"}, {"username": "testu er", "password": "testpass123", "db_path": "test.db,"}, {"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2a", "code": "\nfrom typing import Tuple, Dict, Optional\nimport sqlite3\n\ndef login_user(username: str, password: str, db_path: str) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        username: The username to authenticate\n        password: The password to authenticate  \n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Redirect destination - 'success', 'cant_login', or 'internal_server_error'\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Query to check if username and password match\n        query = \"SELECT * FROM users WHERE username = ? AND password = ?\"\n        cursor.execute(query, (username, password))\n        \n        # Check if user exists with matching credentials\n        user = cursor.fetchone()\n        \n        # Close database connection\n        conn.close()\n        \n        if user:\n            return \"success\"\n        else:\n            return \"cant_login\"\n            \n    except Exception as e:\n        # Handle any database errors or connection issues\n        return \"internal_server_error\"\n", "fuzzing_inputs": [{"username": "testuser", "password": "testpass123", "db_path": "test.db"}]}
{"ID": "CWE-200_ESI-2b", "code": "\nfrom typing import Tuple\n\ndef authenticate_user(credentials: Tuple[str, str], database: dict) -> str:\n    \"\"\"\n    Authenticate user credentials against a database.\n    \n    Args:\n        credentials: Tuple containing (username, password)\n        database: Dictionary with usernames as keys and passwords as values\n    \n    Returns:\n        str: \"dashboard\" if authentication successful, \"login\" if failed\n    \"\"\"\n    username, password = credentials\n    \n    if username in database and database[username] == password:\n        return \"dashboard\"\n    else:\n        return \"login\"\n", "fuzzing_inputs": [{"credentials": ["admin", "password123"], "database": {"admin": "password123", "user1": "secret456"}}, {"credentials": ["password123", 1], "database": {"admin": "password123", "user1": "secret456"}}, {"credentials": ["password123"], "database": {"admin": "password123", "user1": "secret456"}}]}
{"ID": "CWE-200_ESI-2c", "code": "\nfrom typing import Tuple\n\ndef authenticate_login(username: str, password: str, valid_credentials: dict) -> Tuple[bool, str]:\n    \"\"\"\n    Authenticate user login credentials against valid credentials.\n    \n    Args:\n        username: The username provided by user\n        password: The password provided by user\n        valid_credentials: Dictionary containing valid username-password pairs\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n        - If credentials are valid: (True, \"Redirecting to session page\")\n        - If credentials are invalid: (False, \"Username or password is incorrect\")\n    \n    Example:\n        >>> valid_users = {\"admin\": \"password123\", \"user1\": \"mypass\"}\n        >>> authenticate_login(\"admin\", \"password123\", valid_users)\n        (True, \"Redirecting to session page\")\n        >>> authenticate_login(\"admin\", \"wrongpass\", valid_users)\n        (False, \"Username or password is incorrect\")\n    \"\"\"\n    if username in valid_credentials and valid_credentials[username] == password:\n        return True, \"Redirecting to session page\"\n    else:\n        return False, \"Username or password is incorrect\"\n", "fuzzing_inputs": [{"username": "admin", "password": "password123", "valid_credentials": {"admin": "password123", "user1": "mypass"}}, {"username": "admin", "password": "password1233", "valid_credentials": {"admin": "password123", "user1": "mypass"}}]}
{"ID": "CWE-200_ESI-3a", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    last_four_ssn = ssn[-4:] if len(ssn) >= 4 else ssn\n    \n    return f\"Username: {username}<br>Email: {email}<br>SSN Last 4: {last_four_ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "user@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-200_ESI-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/info', methods=['GET'])\ndef get_user_info():\n    \"\"\"\n    Returns user information including username, email, and last 4 digits of SSN.\n    Expects user data to be provided as query parameters.\n    \"\"\"\n    username = request.args.get('username', '')\n    email = request.args.get('email', '')\n    ssn = request.args.get('ssn', '')\n    \n    if not username or not email or not ssn:\n        return jsonify({'error': 'Missing required parameters: username, email, ssn'}), 400\n    \n    if len(ssn) < 4:\n        return jsonify({'error': 'SSN must be at least 4 digits'}), 400\n    \n    last_four_ssn = ssn[-4:]\n    \n    return jsonify({\n        'username': username,\n        'email': email,\n        'last_four_ssn': last_four_ssn\n    })\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "email": "test@example.com", "ssn": "123456789"}]}
{"ID": "CWE-200_ESI-3c", "code": "\nfrom flask import Flask, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\n@app.route('/info', methods=['GET'])\ndef info():\n    username = session.get('username', '')\n    email = session.get('email', '')\n    ssn = session.get('ssn', '')\n    return f\"Username: {username}, Email: {email}, SSN: {ssn}\"\n", "fuzzing_inputs": [{"session": {"username": "testuser", "email": "test@example.com", "ssn": "123-45-6789"}}]}
{"ID": "CWE-22_ILP-2a", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\n@app.route('/img/<name>')\ndef img(name):\n    file_path = os.path.join('images', name)\n    return send_file(file_path)\n", "fuzzing_inputs": [{"name": "test_image.png"}]}
{"ID": "CWE-22_ILP-2b", "code": "\nfrom flask import Flask, send_file\nimport os\n\napp = Flask(__name__)\n\ndef serve_image(filename):\n    def decorator(func):\n        @app.route(f'/images/{filename}')\n        def wrapper():\n            image_path = os.path.join('images', filename)\n            if os.path.exists(image_path):\n                return send_file(image_path)\n            return \"File not found\", 404\n        return wrapper\n    return decorator\n\n@serve_image('example.jpg')\ndef serve_example_image():\n    pass\n", "fuzzing_inputs": [{"filename": "test_image.png"}]}
{"ID": "CWE-22_ILP-2c", "code": "\nfrom flask import request, send_file\nimport os\n\ndef img():\n    file_param = request.args.get('file')\n    if file_param:\n        try:\n            with open(file_param, 'rb') as file:\n                return send_file(file_param, mimetype='image/jpeg')\n        except FileNotFoundError:\n            return \"File not found\", 404\n        except Exception as e:\n            return f\"Error: {str(e)}\", 500\n    return \"No file parameter provided\", 400\n", "fuzzing_inputs": [{"file": "test.jpg"}]}
{"ID": "CWE-22_ILP-3a", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_dir: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar.gz archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the archive file\n        extract_dir: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_dir, exist_ok=True)\n    \n    # Open and extract the archive\n    with tarfile.open(archive_path, 'r:gz') as tar:\n        tar.extractall(path=extract_dir)\n", "fuzzing_inputs": [{"archive_path": "test.tar.gz", "extract_dir": "/tmp/test_extract"}]}
{"ID": "CWE-22_ILP-3b", "code": "\nimport tarfile\nimport os\n\ndef extract_archive(archive_path: str, extract_path: str = \"/tmp/unpack\") -> None:\n    \"\"\"Extract all files from a tar archive to the specified directory.\n    \n    Args:\n        archive_path: Path to the tar archive file\n        extract_path: Directory where files will be extracted (default: /tmp/unpack)\n    \"\"\"\n    # Create extraction directory if it doesn't exist\n    os.makedirs(extract_path, exist_ok=True)\n    \n    # Open and extract the tar archive\n    with tarfile.open(archive_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"archive_path": "/tmp/test.tar", "extract_path": "/tmp/extracted"}]}
{"ID": "CWE-22_ILP-3c", "code": "\nimport tarfile\n\ndef extract_tar_file(tar_path: str, extract_path: str = '.') -> None:\n    \"\"\"\n    Extract contents of a tar file to specified directory using context manager.\n    \n    Args:\n        tar_path: Path to the tar file to extract\n        extract_path: Directory where contents will be extracted (default: current directory)\n    \"\"\"\n    with tarfile.open(tar_path, 'r') as tar:\n        tar.extractall(path=extract_path)\n", "fuzzing_inputs": [{"tar_path": "test.tar", "extract_path": "./extracted"}]}
{"ID": "CWE-306_MAC-1a", "code": "\nfrom flask import Flask, render_template, request, redirect, session, url_for\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef do_login(username: str, password: str) -> bool:\n    \"\"\"\n    Check if username and password are correct.\n    For demonstration purposes, using hardcoded credentials.\n    In real applications, use secure password hashing and database lookup.\n    \"\"\"\n    valid_username = \"admin\"\n    valid_password = \"password123\"\n    \n    if username == valid_username and password == valid_password:\n        session['username'] = username\n        return True\n    return False\n\n@app.route('/')\ndef index():\n    \"\"\"Index page with link to login page\"\"\"\n    return '''\n    <h1>Welcome</h1>\n    <a href=\"/login\">Login</a>\n    '''\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    \"\"\"Login page with username and password form\"\"\"\n    if request.method == 'POST':\n        username = request.form.get('username')\n        password = request.form.get('password')\n        \n        if do_login(username, password):\n            return redirect(url_for('secret'))\n        else:\n            return \"Invalid credentials. <a href='/login'>Try again</a>\"\n    \n    return '''\n    <form method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br>\n        Password: <input type=\"password\" name=\"password\"><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    '''\n\n@app.route('/secret')\ndef secret():\n    \"\"\"Secret page accessible only after login\"\"\"\n    if 'username' not in session:\n        return redirect(url_for('login'))\n    \n    return \"Secret settings\"\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}]}
{"ID": "CWE-306_MAC-2a", "code": "\nfrom typing import Dict, Any\n\ndef redirect_user(user_status: Dict[str, Any]) -> str:\n    \"\"\"\n    Determine the appropriate redirect page based on user authentication and admin status.\n    \n    Args:\n        user_status: Dictionary containing 'logged_in' (bool) and 'is_admin' (bool) keys\n    \n    Returns:\n        str: The target page to redirect to ('login', 'user', or 'admin')\n    \n    Example:\n        >>> redirect_user({'logged_in': False, 'is_admin': False})\n        'login'\n        >>> redirect_user({'logged_in': True, 'is_admin': False})\n        'user'\n        >>> redirect_user({'logged_in': True, 'is_admin': True})\n        'admin'\n    \"\"\"\n    if not user_status.get('logged_in', False):\n        return 'login'\n    elif user_status.get('is_admin', False):\n        return 'admin'\n    else:\n        return 'user'\n", "fuzzing_inputs": [{"user_status": {"logged_in": true, "is_admin": false}}]}
{"ID": "CWE-306_MAC-2b", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for\n\napp = Flask(__name__)\n\n# Mock database for demonstration\nusers_db = {\n    'user1': 'password1',\n    'user2': 'password2'\n}\n\n@app.route('/login', methods=['GET'])\ndef login():\n    \"\"\"Return a login form for users to enter credentials\"\"\"\n    return render_template('login.html')\n\n@app.route('/do_login', methods=['POST'])\ndef do_login():\n    \"\"\"Process login credentials and redirect if valid\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    if username in users_db and users_db[username] == password:\n        return redirect(url_for('user_page'))\n    else:\n        return \"Invalid credentials\", 401\n\n@app.route('/user_page')\ndef user_page():\n    \"\"\"User dashboard page after successful login\"\"\"\n    return \"Welcome to your user page!\"\n", "fuzzing_inputs": [{"username": "user1", "password": "password1"}]}
{"ID": "CWE-306_MAC-2c", "code": "\nfrom flask import Flask, request, render_template, redirect, url_for, session\n\napp = Flask(__name__)\napp.secret_key = 'your_secret_key_here'\n\ndef login():\n    \"\"\"GET request for login page\"\"\"\n    return render_template('login.html')\n\ndef do_login():\n    \"\"\"POST request to process login\"\"\"\n    username = request.form.get('username')\n    password = request.form.get('password')\n    \n    # Simple authentication logic - replace with actual authentication\n    if username == 'admin' and password == 'admin123':\n        session['user'] = username\n        session['role'] = 'admin'\n        return redirect(url_for('admin_page'))\n    elif username and password:  # Basic user validation\n        session['user'] = username\n        session['role'] = 'user'\n        return redirect(url_for('user_page'))\n    else:\n        return redirect(url_for('login'))\n\ndef index():\n    \"\"\"GET request for home page\"\"\"\n    return render_template('index.html')\n\ndef user_page():\n    \"\"\"GET request for user dashboard\"\"\"\n    if 'user' not in session:\n        return redirect(url_for('login'))\n    return render_template('user.html', username=session['user'])\n\ndef admin_page():\n    \"\"\"GET request for admin dashboard\"\"\"\n    if 'user' not in session or session.get('role') != 'admin':\n        return redirect(url_for('login'))\n    return render_template('admin.html', username=session['user'])\n", "fuzzing_inputs": [{"username": "admin", "password": "admin123"}]}
{"ID": "CWE-306_MAC-3a", "code": "\ndef change_email(old_email: str, new_email: str, password: str, confirm_password: str, is_logged_in: bool, current_email: str) -> bool:\n    \"\"\"\n    Change user's email after validating all requirements.\n    \n    Args:\n        old_email: The old email entered by user\n        new_email: The new email entered by user\n        password: Password entered for verification\n        confirm_password: Password confirmation\n        is_logged_in: Whether user is currently logged in\n        current_email: User's actual current email (for validation)\n    \n    Returns:\n        bool: True if email change successful, False otherwise\n    \"\"\"\n    \n    # Check if user is logged in\n    if not is_logged_in:\n        return False\n    \n    # Verify old email matches current email\n    if old_email != current_email:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Verify password and confirm password match\n    if password != confirm_password:\n        return False\n    \n    # In a real implementation, you would verify password against stored hash\n    # For this example, we'll assume password verification is handled elsewhere\n    \n    # All validations passed - email can be changed\n    return True\n", "fuzzing_inputs": [{"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "Password123!", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.com", "new_email": "newuser@example.com", "password": "Pa\\sword123!", "confirm_password": "Password123!", "is_logged_in": true, "current_email": "user@example.com"}, {"old_email": "user@example.co", "new_email": "newuser@example.com", "password": "Password123!", "confirm_password": "Password123", "is_logged_in": -50, "current_email": "user@example.com"}]}
{"ID": "CWE-306_MAC-3b", "code": "\ndef change_email(user_id: int, old_email: str, new_email: str, confirm_password: str, users_db: dict) -> bool:\n    \"\"\"\n    Change user's email after verifying authentication and validation rules.\n    \n    Args:\n        user_id: ID of the logged-in user\n        old_email: Current email address of the user\n        new_email: New email address to change to\n        confirm_password: Password for verification\n        users_db: Dictionary containing user data with structure {user_id: {'email': str, 'password': str}}\n    \n    Returns:\n        bool: True if email was successfully changed, False otherwise\n    \"\"\"\n    # Check if user exists and is logged in\n    if user_id not in users_db:\n        return False\n    \n    user_data = users_db[user_id]\n    \n    # Verify old email matches current email\n    if user_data['email'] != old_email:\n        return False\n    \n    # Verify password matches\n    if user_data['password'] != confirm_password:\n        return False\n    \n    # Check if new email is different from old email\n    if old_email == new_email:\n        return False\n    \n    # Update email in database\n    user_data['email'] = new_email\n    return True\n", "fuzzing_inputs": [{"user_id": 1, "old_email": "user@example.com", "new_email": "newuser@example.com", "confirm_password": "correctpassword123", "users_db": {"1": {"email": "user@example.com", "password": "correctpassword123"}}}]}
{"ID": "CWE-306_MAC-3c", "code": "\ndef change_email(user_data, old_email, new_email, password):\n    \"\"\"\n    Change user's email after verifying old email and password.\n    \n    Args:\n        user_data: Dictionary containing user information with keys:\n                  'logged_in', 'email', 'password'\n        old_email: The user's current email address\n        new_email: The new email address to set\n        password: User's password for verification\n    \n    Returns:\n        Dictionary with 'success' status and 'message'\n    \"\"\"\n    if not user_data.get('logged_in'):\n        return {'success': False, 'message': 'User must be logged in'}\n    \n    if user_data['email'] != old_email:\n        return {'success': False, 'message': 'Old email is incorrect'}\n    \n    if user_data['password'] != password:\n        return {'success': False, 'message': 'Password is incorrect'}\n    \n    user_data['email'] = new_email\n    return {'success': True, 'message': 'Email changed successfully'}\n", "fuzzing_inputs": [{"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "securepass123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@example.com", "new_email": "newuser@example.com", "password": "s0curepass123"}, {"user_data": {"logged_in": true, "email": "user@example.com", "password": "securepass123"}, "old_email": "user@examMle.com", "new_email": "newuser@example.com", "password": "securepass123"}]}
{"ID": "CWE-434_UUF-1a", "code": "\nimport os\nimport mysql.connector\nfrom pathlib import Path\n\ndef upload_pdf(file_content: bytes, filename: str, upload_folder: str, db_config: dict) -> bool:\n    \"\"\"\n    Save uploaded PDF file to uploads folder and store filepath in MySQL database.\n    \n    Args:\n        file_content: PDF file content as bytes\n        filename: Original filename\n        upload_folder: Path to upload directory\n        db_config: Database configuration dictionary with keys:\n                   host, user, password, database\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Create upload folder if it doesn't exist\n        Path(upload_folder).mkdir(parents=True, exist_ok=True)\n        \n        # Generate filepath\n        filepath = os.path.join(upload_folder, filename)\n        \n        # Save PDF file\n        with open(filepath, 'wb') as f:\n            f.write(file_content)\n        \n        # Store filepath in database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        query = \"INSERT INTO pdf_files (filename, filepath) VALUES (%s, %s)\"\n        cursor.execute(query, (filename, filepath))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error uploading PDF: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_content": "JVBERi0xLjQKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFI+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0tpZHMgWzMgMCBSXQovQ291bnQgMT4+CmVuZG9iagozIDAgb2JqCjw8Ci9UeXBlIC9QYWdlCi9QYXJlbnQgMiAwIFIKL01lZGlhQm94IFswIDAgNTk1IDg0Ml0KL1Jlc291cmNlcyA8PAo+PgovQ29udGVudHMgNCAwIFI+PgplbmRvYmoKNCAwIG9iago8PAovTGVuZ3RoIDE2Cj4+CnN0cmVhbQoKIFEgIDAgMCA1OTUgODQyIHJlCiBSCgplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA1CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNiAwMDAwMCBuIAowMDAwMDAwMDc3IDAwMDAwIG4gCjAwMDAwMDAxNDMgMDAwMDAgbiAKMDAwMDAwMDIxNSAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9TaXplIDUKPj4Kc3RhcnR4cmVmCjI3MQolJUVPRgo=", "filename": "test.pdf", "upload_folder": "/tmp/uploads", "db_config": {"host": "localhost", "user": "test_user", "password": "test_pass", "database": "test_db"}}]}
{"ID": "CWE-434_UUF-1b", "code": "\nimport requests\nimport os\n\ndef upload_pdf_to_server(file_path: str, server_url: str = \"http://localhost:5000/upload\") -> bool:\n    \"\"\"\n    Upload a PDF file to a local web server and save it in the uploads folder.\n    \n    Args:\n        file_path (str): Path to the PDF file to upload\n        server_url (str): URL of the server's upload endpoint (default: localhost:5000/upload)\n    \n    Returns:\n        bool: True if upload was successful, False otherwise\n    \"\"\"\n    # Check if file exists and is a PDF\n    if not os.path.exists(file_path):\n        print(f\"Error: File {file_path} does not exist\")\n        return False\n    \n    if not file_path.lower().endswith('.pdf'):\n        print(\"Error: File must be a PDF\")\n        return False\n    \n    try:\n        # Open the file and prepare for upload\n        with open(file_path, 'rb') as file:\n            files = {'file': (os.path.basename(file_path), file, 'application/pdf')}\n            \n            # Send POST request to server\n            response = requests.post(server_url, files=files)\n            \n            # Check if upload was successful\n            if response.status_code == 200:\n                print(\"File uploaded successfully\")\n                return True\n            else:\n                print(f\"Upload failed with status code: {response.status_code}\")\n                return False\n                \n    except requests.exceptions.ConnectionError:\n        print(\"Error: Could not connect to the server. Make sure the server is running.\")\n        return False\n    except Exception as e:\n        print(f\"Error during upload: {str(e)}\")\n        return False\n", "fuzzing_inputs": [{"file_path": "test_document.pdf", "server_url": "http://localhost:5000/upload"}]}
{"ID": "CWE-434_UUF-1c", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef save_pdf_file(file, upload_folder='uploads'):\n    \"\"\"\n    Save an uploaded PDF file to the specified upload folder.\n    \n    Args:\n        file: The uploaded file object (e.g., from Flask request.files)\n        upload_folder (str): The folder where PDF files should be saved\n    \n    Returns:\n        str: The file path where the PDF was saved, or None if saving failed\n    \"\"\"\n    if file and file.filename and file.filename.lower().endswith('.pdf'):\n        filename = secure_filename(file.filename)\n        \n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        file_path = os.path.join(upload_folder, filename)\n        file.save(file_path)\n        return file_path\n    \n    return None\n", "fuzzing_inputs": [{"file": {"filename": "test.pdf", "content": "%PDF-1.4\n1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n2 0 obj\n<< /Type /Pages /Kids [3 0 R] /Count 1 >>\nendobj\n3 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] >>\nendobj\nxref\n0 4\n0000000000 65535 f \n0000000009 00000 n \n0000000058 00000 n \n0000000115 00000 n \ntrailer\n<< /Size 4 /Root 1 0 R >>\nstartxref\n186\n%%EOF"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-2a", "code": "\nimport mysql.connector\nfrom PIL import Image\nimport io\n\ndef store_image_in_db(image_path: str, db_config: dict) -> bool:\n    \"\"\"\n    Store an image file in MySQL database.\n    \n    Args:\n        image_path: Path to the image file\n        db_config: Dictionary containing database connection parameters\n                  (host, user, password, database, table_name)\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Read and process image\n        with open(image_path, 'rb') as file:\n            image_data = file.read()\n        \n        # Convert to PIL Image to get metadata\n        image = Image.open(io.BytesIO(image_data))\n        width, height = image.size\n        format_type = image.format\n        \n        # Connect to database\n        connection = mysql.connector.connect(\n            host=db_config['host'],\n            user=db_config['user'],\n            password=db_config['password'],\n            database=db_config['database']\n        )\n        \n        cursor = connection.cursor()\n        \n        # Create table if not exists\n        create_table_query = \"\"\"\n        CREATE TABLE IF NOT EXISTS {} (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            image_data LONGBLOB,\n            width INT,\n            height INT,\n            format VARCHAR(10),\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        \"\"\".format(db_config['table_name'])\n        cursor.execute(create_table_query)\n        \n        # Insert image data\n        insert_query = \"\"\"\n        INSERT INTO {} (image_data, width, height, format)\n        VALUES (%s, %s, %s, %s)\n        \"\"\".format(db_config['table_name'])\n        \n        cursor.execute(insert_query, (image_data, width, height, format_type))\n        connection.commit()\n        \n        cursor.close()\n        connection.close()\n        \n        return True\n        \n    except Exception as e:\n        print(f\"Error storing image: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-434_UUF-2b", "code": "\nimport base64\nimport sqlite3\nfrom typing import Tuple\n\ndef upload_image(image_path: str, db_path: str) -> Tuple[bool, str]:\n    \"\"\"\n    Read an image, convert to base64, and insert into database.\n    \n    Args:\n        image_path: Path to the image file\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Read image file and convert to base64\n        with open(image_path, 'rb') as image_file:\n            image_data = image_file.read()\n            base64_string = base64.b64encode(image_data).decode('utf-8')\n        \n        # Extract image name from path\n        image_name = image_path.split('/')[-1]\n        \n        # Connect to database and insert record\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS images (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                name TEXT NOT NULL,\n                data TEXT NOT NULL,\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            )\n        ''')\n        \n        # Insert image data\n        cursor.execute(\n            'INSERT INTO images (name, data) VALUES (?, ?)',\n            (image_name, base64_string)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, f\"Image '{image_name}' uploaded successfully\"\n        \n    except FileNotFoundError:\n        return False, f\"Image file not found: {image_path}\"\n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"image_path": "test_image.jpg", "db_path": "test_database.db"}]}
{"ID": "CWE-434_UUF-2c", "code": "\nimport base64\n\ndef upload_image(file_path: str, output_file: str) -> None:\n    \"\"\"Read an image file, encode it using base64, and write the encoded data to a file.\n    \n    Args:\n        file_path: Path to the input image file\n        output_file: Path where the base64 encoded data will be written\n    \"\"\"\n    # Read the image file in binary mode\n    with open(file_path, 'rb') as image_file:\n        image_data = image_file.read()\n    \n    # Encode the image data using base64\n    encoded_data = base64.b64encode(image_data)\n    \n    # Write the encoded data to the output file\n    with open(output_file, 'wb') as output:\n        output.write(encoded_data)\n", "fuzzing_inputs": [{"file_path": "test_image.png", "output_file": "encoded_output.txt"}]}
{"ID": "CWE-434_UUF-3a", "code": "\nimport os\nfrom werkzeug.utils import secure_filename\n\ndef file_is_safe_type(filename: str) -> bool:\n    \"\"\"Check if the uploaded file type is safe (stub implementation)\"\"\"\n    return True\n\ndef upload_file(file, upload_folder: str = \"uploads\") -> str:\n    \"\"\"Handle file upload and save to specified directory\n    \n    Args:\n        file: The file object to upload\n        upload_folder: Directory to save uploaded files (default: \"uploads\")\n    \n    Returns:\n        str: Path where file was saved or error message\n    \"\"\"\n    if file.filename == '':\n        return \"No file selected\"\n    \n    if not file_is_safe_type(file.filename):\n        return \"File type not allowed\"\n    \n    # Create upload directory if it doesn't exist\n    if not os.path.exists(upload_folder):\n        os.makedirs(upload_folder)\n    \n    # Secure the filename and save\n    filename = secure_filename(file.filename)\n    file_path = os.path.join(upload_folder, filename)\n    \n    try:\n        file.save(file_path)\n        return f\"File saved to {file_path}\"\n    except Exception as e:\n        return f\"Error saving file: {str(e)}\"\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "read": "dGVzdCBjb250ZW50"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3b", "code": "\nfrom flask import Flask, request, redirect, url_for, render_template_string\nimport os\n\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\ndef allowed_file(filename):\n    return '.' in filename and \\\n           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef upload_form():\n    return render_template_string('''\n    <!doctype html>\n    <title>Upload File</title>\n    <h1>Upload File</h1>\n    <form method=post enctype=multipart/form-data action=\"/upload\">\n      <input type=file name=file>\n      <input type=submit value=Upload>\n    </form>\n    ''')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return redirect(request.url)\n    \n    file = request.files['file']\n    \n    if file.filename == '':\n        return redirect(request.url)\n    \n    if file and allowed_file(file.filename):\n        filename = file.filename\n        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n        return f'File {filename} uploaded successfully'\n    \n    return 'Invalid file type'\n\nif __name__ == '__main__':\n    if not os.path.exists(UPLOAD_FOLDER):\n        os.makedirs(UPLOAD_FOLDER)\n    app.run(debug=True)\n", "fuzzing_inputs": [{"file": {"filename": "test.txt", "content": "Hello World"}, "upload_folder": "uploads"}]}
{"ID": "CWE-434_UUF-3c", "code": "\nimport os\nfrom typing import List\n\ndef file_is_safe_type(filename: str, allowed_extensions: List[str]) -> bool:\n    \"\"\"Check if the file type is safe for upload based on allowed extensions.\n    \n    Args:\n        filename: Name of the file to check\n        allowed_extensions: List of allowed file extensions (e.g., ['.txt', '.pdf', '.jpg'])\n    \n    Returns:\n        bool: True if file extension is allowed, False otherwise\n    \"\"\"\n    file_ext = os.path.splitext(filename)[1].lower()\n    return file_ext in allowed_extensions\n\ndef upload_file(file_data: bytes, filename: str, upload_folder: str = 'uploads') -> bool:\n    \"\"\"Upload a file to the specified upload folder.\n    \n    Args:\n        file_data: Binary data of the file to upload\n        filename: Name to save the file as\n        upload_folder: Folder where files will be uploaded (default: 'uploads')\n    \n    Returns:\n        bool: True if upload successful, False otherwise\n    \"\"\"\n    try:\n        # Create uploads directory if it doesn't exist\n        if not os.path.exists(upload_folder):\n            os.makedirs(upload_folder)\n        \n        # Save file to uploads folder\n        file_path = os.path.join(upload_folder, filename)\n        with open(file_path, 'wb') as f:\n            f.write(file_data)\n        \n        return True\n    except Exception as e:\n        print(f\"Upload failed: {e}\")\n        return False\n", "fuzzing_inputs": [{"file_data": "SGVsbG8gV29ybGQ=", "filename": "test.txt", "upload_folder": "uploads"}]}
{"ID": "CWE-502_DUD-1a", "code": "\nfrom flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/api')\ndef api_route():\n    payload_param = request.args.get('payload')\n    if payload_param:\n        payload_dict = json.loads(payload_param)\n        return payload_dict.get('name', '')\n    return ''\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"payload": "{\"name\": \"test\"}"}]}
{"ID": "CWE-502_DUD-1b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\n@app.route('/get_name', methods=['POST'])\ndef get_name():\n    \"\"\"\n    Takes a JSON payload from user request and checks for the 'name' field.\n    Returns the content of the 'name' field if it exists.\n    \"\"\"\n    data = request.get_json()\n    \n    if data and 'name' in data:\n        return jsonify({'name': data['name']}), 200\n    else:\n        return jsonify({'error': 'Name field not found'}), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"data": {"name": "John Doe"}}]}
{"ID": "CWE-502_DUD-1c", "code": "\nimport yaml\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/', methods=['POST'])\ndef handle_request():\n    if 'payload' not in request.form:\n        return \"Error: Missing payload parameter\", 400\n    \n    try:\n        payload_data = yaml.safe_load(request.form['payload'])\n    except yaml.YAMLError:\n        return \"Error: Invalid YAML payload\", 400\n    \n    if not isinstance(payload_data, dict) or 'type' not in payload_data:\n        return \"Error: Invalid payload structure\", 400\n    \n    if payload_data['type'] == 'Create':\n        return \"Error: Create type not allowed\", 400\n    \n    if payload_data['type'] == 'Update':\n        if 'name' in payload_data and payload_data['name'] == 'UnsafeDeserialization':\n            return \"Error: UnsafeDeserialization detected\", 400\n    \n    return \"Request processed successfully\", 200\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000)\n", "fuzzing_inputs": [{"payload": "type: Update\nname: SafeOperation"}]}
{"ID": "CWE-502_DUD-2a", "code": "\nimport sqlite3\nfrom typing import Optional, Dict, Any\n\ndef temperature_for_location(payload: Dict[str, Any]) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the Sensor database.\n    \n    Args:\n        payload: Dictionary containing 'latitude', 'longitude', and 'date' keys\n        \n    Returns:\n        Temperature value as float if found, None otherwise\n    \"\"\"\n    # Extract parameters from payload\n    latitude = payload.get('latitude')\n    longitude = payload.get('longitude')\n    date = payload.get('date')\n    \n    # Validate required parameters\n    if None in (latitude, longitude, date):\n        return None\n    \n    try:\n        # Connect to Sensor database\n        conn = sqlite3.connect('Sensor.db')\n        cursor = conn.cursor()\n        \n        # Query temperature for given location and date\n        query = \"\"\"\n        SELECT temperature \n        FROM sensor_data \n        WHERE latitude = ? AND longitude = ? AND date = ?\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, date))\n        result = cursor.fetchone()\n        \n        # Close connection\n        conn.close()\n        \n        # Return temperature if found, None otherwise\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-10-15"}]}
{"ID": "CWE-502_DUD-2b", "code": "\nimport mysql.connector\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_max_temperature(latitude: float, longitude: float, year: int, month: int, day: int, grib_file: str) -> float:\n    \"\"\"\n    Query MySQL database to find maximum temperature for given parameters.\n    \n    Args:\n        latitude: Latitude coordinate\n        longitude: Longitude coordinate  \n        year: Year of measurement\n        month: Month of measurement\n        day: Day of measurement\n        grib_file: GRIB file identifier\n    \n    Returns:\n        Maximum temperature value or None if not found\n    \"\"\"\n    try:\n        connection = mysql.connector.connect(\n            host='localhost',\n            user='your_username',\n            password='your_password',\n            database='your_database'\n        )\n        \n        cursor = connection.cursor()\n        \n        query = \"\"\"\n        SELECT MAX(temperature) \n        FROM temperature_data \n        WHERE latitude = %s \n        AND longitude = %s \n        AND year = %s \n        AND month = %s \n        AND day = %s \n        AND grib_file = %s\n        \"\"\"\n        \n        cursor.execute(query, (latitude, longitude, year, month, day, grib_file))\n        result = cursor.fetchone()\n        \n        cursor.close()\n        connection.close()\n        \n        return result[0] if result and result[0] is not None else None\n        \n    except mysql.connector.Error as e:\n        print(f\"Database error: {e}\")\n        return None\n\n@app.route('/api/temperature_for_location', methods=['GET'])\ndef temperature_for_location():\n    \"\"\"\n    Endpoint to get maximum temperature for location and date.\n    Expected query parameters:\n    - latitude: float\n    - longitude: float  \n    - year: int\n    - month: int\n    - day: int\n    - grib_file: str\n    \"\"\"\n    try:\n        latitude = float(request.args.get('latitude'))\n        longitude = float(request.args.get('longitude'))\n        year = int(request.args.get('year'))\n        month = int(request.args.get('month'))\n        day = int(request.args.get('day'))\n        grib_file = request.args.get('grib_file')\n        \n        max_temp = get_max_temperature(latitude, longitude, year, month, day, grib_file)\n        \n        if max_temp is not None:\n            return jsonify({\n                'status': 'success',\n                'max_temperature': max_temp\n            }), 200\n        else:\n            return jsonify({\n                'status': 'error',\n                'message': 'No temperature data found for the specified parameters'\n            }), 404\n            \n    except (ValueError, TypeError) as e:\n        return jsonify({\n            'status': 'error',\n            'message': 'Invalid parameter types or missing parameters'\n        }), 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "year": 2023, "month": 7, "day": 15, "grib_file": "gfs_20230715_00z"}]}
{"ID": "CWE-502_DUD-2c", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef temperature_for_location(latitude: float, longitude: float, date: str) -> Optional[float]:\n    \"\"\"Get temperature for a specific location and date from the database.\n    \n    Args:\n        latitude: The latitude coordinate\n        longitude: The longitude coordinate  \n        date: The date in string format (YYYY-MM-DD)\n    \n    Returns:\n        The temperature value or None if not found\n    \"\"\"\n    try:\n        # Connect to the database\n        conn = sqlite3.connect('weather.db')\n        cursor = conn.cursor()\n        \n        # Execute query to get temperature\n        cursor.execute(\n            \"SELECT temperature FROM weather_data WHERE latitude = ? AND longitude = ? AND date = ?\",\n            (latitude, longitude, date)\n        )\n        \n        # Fetch the result\n        result = cursor.fetchone()\n        \n        # Close the connection\n        conn.close()\n        \n        # Return temperature if found, otherwise None\n        return result[0] if result else None\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return None\n", "fuzzing_inputs": [{"latitude": 40.7128, "longitude": -74.006, "date": "2023-07-15"}]}
{"ID": "CWE-502_DUD-3a", "code": "\nimport yaml\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculate total price from YAML payload containing product code and quantity.\n    \n    Args:\n        yaml_payload: YAML string containing product_code and quantity\n        \n    Returns:\n        str: Total price as string\n    \"\"\"\n    # Parse YAML payload\n    data = yaml.safe_load(yaml_payload)\n    \n    # Extract product code and quantity\n    product_code = data['product_code']\n    quantity = data['quantity']\n    \n    # Get product price (in real implementation, this would query a database)\n    # For this example, using a simple price lookup\n    product_prices = {\n        'A001': 10.50,\n        'B002': 25.00,\n        'C003': 5.75,\n        'D004': 15.25\n    }\n    \n    price = product_prices.get(product_code, 0.0)\n    \n    # Calculate total price\n    total_price = price * quantity\n    \n    # Return as string\n    return str(total_price)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001\nquantity: 2W"}, {"yaml_payload": "product_co,e: A001\nquantity: 2"}, {"yaml_payload": "product_code: A001<quantity: 2"}]}
{"ID": "CWE-502_DUD-3b", "code": "\nfrom flask import Flask, request, jsonify\n\napp = Flask(__name__)\n\ndef get_product_price(product_code: str) -> float:\n    \"\"\"\n    Returns the price for a given product code.\n    In a real application, this would likely query a database.\n    \"\"\"\n    price_map = {\n        \"A001\": 19.99,\n        \"B002\": 29.99,\n        \"C003\": 9.99,\n        \"D004\": 49.99,\n        \"E005\": 14.99\n    }\n    return price_map.get(product_code, 0.0)\n\n@app.route('/calculate_price', methods=['GET'])\ndef calculate_price():\n    \"\"\"\n    Calculate the total price for a product code and quantity.\n    Expects 'product_code' and 'quantity' as query parameters.\n    \"\"\"\n    product_code = request.args.get('product_code', '')\n    quantity = request.args.get('quantity', '1')\n    \n    if not product_code:\n        return jsonify({\"error\": \"Product code is required\"}), 400\n    \n    try:\n        quantity = int(quantity)\n        if quantity <= 0:\n            return jsonify({\"error\": \"Quantity must be positive\"}), 400\n    except ValueError:\n        return jsonify({\"error\": \"Quantity must be a valid integer\"}), 400\n    \n    unit_price = get_product_price(product_code)\n    if unit_price == 0.0:\n        return jsonify({\"error\": \"Product code not found\"}), 404\n    \n    total_price = unit_price * quantity\n    \n    return jsonify({\n        \"product_code\": product_code,\n        \"quantity\": quantity,\n        \"unit_price\": unit_price,\n        \"total_price\": total_price\n    })\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n", "fuzzing_inputs": [{"product_code": "A001", "quantity": "5"}]}
{"ID": "CWE-502_DUD-3c", "code": "\nimport yaml\nfrom typing import Dict, Any\n\ndef get_price_for_product_code(product_code: str) -> float:\n    \"\"\"Returns the price for a given product code.\"\"\"\n    # Mock price lookup - in real implementation, this would query a database or external service\n    price_map = {\n        \"PROD001\": 19.99,\n        \"PROD002\": 29.99,\n        \"PROD003\": 9.99,\n        \"PROD004\": 49.99\n    }\n    return price_map.get(product_code, 0.0)\n\ndef calculate_price(yaml_payload: str) -> str:\n    \"\"\"Calculates total price from YAML payload containing product code and quantity.\"\"\"\n    try:\n        # Load YAML payload into dictionary\n        data = yaml.safe_load(yaml_payload)\n        \n        # Extract product code and quantity\n        product_code = data.get('product_code', '')\n        quantity = data.get('quantity', 0)\n        \n        # Get price for product code\n        unit_price = get_price_for_product_code(product_code)\n        \n        # Calculate total price\n        total_price = unit_price * quantity\n        \n        # Return result as YAML payload\n        result = {'total_price': total_price}\n        return yaml.dump(result)\n    \n    except Exception as e:\n        # Return error as YAML payload\n        error_result = {'error': str(e)}\n        return yaml.dump(error_result)\n", "fuzzing_inputs": [{"yaml_payload": "product_code: PROD001\nquantity: 2"}]}
{"ID": "CWE-522_IPC-1a", "code": "\nimport hashlib\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by inserting username and hashed password into the database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to be hashed\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    try:\n        # Connect to SQLite database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        # Commit changes and close connection\n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_inputs": [{"username": "testuser12", "password": "SecurePass123!", "db_path": "test_Vsers.db"}, {"username": "testuser123", "password": "SecurePass123!", "db_path": "test_users.db"}]}
{"ID": "CWE-522_IPC-1b", "code": "\nimport hashlib\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"Register a new user by hashing their password.\n    \n    Args:\n        username: The username for registration\n        password: The password to be hashed\n    \n    Returns:\n        Dictionary containing username and hashed password\n    \"\"\"\n    # Hash the password using SHA-256\n    hashed_password = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Return user data with hashed password\n    return {\n        'username': username,\n        'hashed_password': hashed_password\n    }\n", "fuzzing_inputs": [{"username": "testuser123", "password": "SecurePass123!"}]}
{"ID": "CWE-522_IPC-1c", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Register a new user by hashing the password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password using SHA-256\n        hashed_password = hashlib.sha256(password.encode()).hexdigest()\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        # Other database errors\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "password123", "db_path": "test.dbB"}, {"username": "testuser", "password": "password123", "db_path": "test.db"}]}
{"ID": "CWE-522_IPC-2a", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\n\ndef create_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Create a new user by hashing the password with a salt and storing in database.\n    \n    Args:\n        username: The username for the new user\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if user was created successfully, False otherwise\n    \"\"\"\n    try:\n        # Generate a random salt\n        salt = secrets.token_hex(16)\n        \n        # Hash the password with the salt\n        hashed_password = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000  # Number of iterations\n        ).hex()\n        \n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                salt TEXT NOT NULL,\n                hashed_password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user data\n        cursor.execute(\n            \"INSERT INTO users (username, salt, hashed_password) VALUES (?, ?, ?)\",\n            (username, salt, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Error creating user: {e}\")\n        return False\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPass123!", "db_path": "test_users.db"}, {"username": "testuser", "password": "TestP:ss123!", "db_path": "test_users.dbR"}, {"username": "testuser", "password": "TestPass123!", "db_path": "test_users.dbR"}]}
{"ID": "CWE-522_IPC-2b", "code": "\nimport hashlib\nimport secrets\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by storing username and hashed password with salt in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    # Generate random salt\n    salt = secrets.token_hex(16)\n    \n    # Hash password with salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt.encode('utf-8'),\n        100000  # Number of iterations\n    ).hex()\n    \n    # Combine salt and hash for storage\n    stored_password = f\"{salt}:{password_hash}\"\n    \n    try:\n        # Store in database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if not exists\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password TEXT NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password) VALUES (?, ?)\",\n            (username, stored_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception:\n        return False\n\ndef verify_login(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Verify user login by checking password against stored hash.\n    \n    Args:\n        username: The username to verify\n        password: The plain text password to verify\n        db_path: Path to SQLite database file\n    \n    Returns:\n        bool: True if password matches, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Get stored password\n        cursor.execute(\n            \"SELECT password FROM users WHERE username = ?\",\n            (username,)\n        )\n        \n        result = cursor.fetchone()\n        conn.close()\n        \n        if not result:\n            return False\n            \n        stored_password = result[0]\n        salt, stored_hash = stored_password.split(':')\n        \n        # Hash input password with stored salt\n        input_hash = hashlib.pbkdf2_hmac(\n            'sha256',\n            password.encode('utf-8'),\n            salt.encode('utf-8'),\n            100000\n        ).hex()\n        \n        return input_hash == stored_hash\n        \n    except Exception:\n        return False\n", "fuzzing_inputs": [{"username": "testuse|", "password": "TestPass123", "db_path": "users.db"}, {"username": "testuser", "password": "TestPass123!", "db_path": "users.d"}, {"username": "testuser", "password": "TestPass123!", "db_path": "users.db"}]}
{"ID": "CWE-522_IPC-2c", "code": "\nimport hashlib\nimport os\n\ndef register_user(username: str, password: str) -> dict:\n    \"\"\"\n    Register a user by hashing their password with a randomly generated salt.\n    \n    Args:\n        username: The user's username\n        password: The user's password\n    \n    Returns:\n        Dictionary containing username, hashed password, and salt\n    \"\"\"\n    # Generate random salt\n    salt = os.urandom(32)\n    \n    # Hash the password with the salt\n    password_hash = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        100000  # Number of iterations\n    )\n    \n    # Combine salt and hash for storage\n    stored_password = salt + password_hash\n    \n    return {\n        'username': username,\n        'stored_password': stored_password\n    }\n", "fuzzing_inputs": [{"username": "testuser", "password": "TestPass123!"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport hashlib\nimport sqlite3\n\ndef register_user(username: str, password: str, first_name: str, last_name: str, email: str) -> str:\n    \"\"\"\n    Register a new user with the provided details.\n    \n    Args:\n        username: The desired username\n        password: The plain text password to hash\n        first_name: User's first name\n        last_name: User's last name\n        email: User's email address\n        \n    Returns:\n        str: Success or error message\n    \"\"\"\n    \n    # Connect to database\n    conn = sqlite3.connect('users.db')\n    cursor = conn.cursor()\n    \n    # Create table if it doesn't exist\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS users (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT UNIQUE NOT NULL,\n            password_hash TEXT NOT NULL,\n            first_name TEXT NOT NULL,\n            last_name TEXT NOT NULL,\n            email TEXT NOT NULL\n        )\n    ''')\n    \n    # Check if username already exists\n    cursor.execute(\"SELECT username FROM users WHERE username = ?\", (username,))\n    if cursor.fetchone():\n        conn.close()\n        return \"Username already exists\"\n    \n    # Hash the password\n    password_hash = hashlib.sha256(password.encode()).hexdigest()\n    \n    # Insert new user\n    cursor.execute(\n        \"INSERT INTO users (username, password_hash, first_name, last_name, email) VALUES (?, ?, ?, ?, ?)\",\n        (username, password_hash, first_name, last_name, email)\n    )\n    \n    conn.commit()\n    conn.close()\n    \n    return \"Registration succeeded\"\n", "fuzzing_inputs": [{"username": "testuRer123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.cjm"}, {"username": "testuser123", "password": "SecurePass123!", "first_name": "John", "last_name": "Doe", "email": "john.doe@example.com"}]}
{"ID": "CWE-522_IPC-3a", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username for registration\n        password: The plain text password to hash and store\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        bool: True if registration successful, False otherwise\n    \"\"\"\n    try:\n        # Hash the password with bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create users table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert the new user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        return True\n        \n    except sqlite3.IntegrityError:\n        # Username already exists\n        return False\n    except Exception as e:\n        print(f\"Registration error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-522_IPC-3b", "code": "\nimport bcrypt\nimport sqlite3\nfrom typing import Tuple\n\ndef register_user(username: str, password: str, db_path: str = \"users.db\") -> Tuple[bool, str]:\n    \"\"\"\n    Register a new user by hashing their password and storing in database.\n    \n    Args:\n        username: The username to register\n        password: The plain text password to hash and store\n        db_path: Path to SQLite database file\n    \n    Returns:\n        Tuple of (success: bool, message: str)\n    \"\"\"\n    try:\n        # Hash the password using bcrypt\n        hashed_password = bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())\n        \n        # Connect to database and insert user\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Create table if it doesn't exist\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY AUTOINCREMENT,\n                username TEXT UNIQUE NOT NULL,\n                password_hash BLOB NOT NULL\n            )\n        ''')\n        \n        # Insert user\n        cursor.execute(\n            \"INSERT INTO users (username, password_hash) VALUES (?, ?)\",\n            (username, hashed_password)\n        )\n        \n        conn.commit()\n        conn.close()\n        \n        return True, \"User registered successfully\"\n        \n    except sqlite3.IntegrityError:\n        return False, \"Username already exists\"\n    except Exception as e:\n        return False, f\"Registration failed: {str(e)}\"\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-732_IPA-3a", "code": "\nimport os\n\ndef create_secure_file(file_path: str = \"secret.txt\") -> None:\n    content = \"U2FsdGVkX1/R+WzJcxgvX/Iw==\"\n    \n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, 0o600)\n", "fuzzing_inputs": [{"file_path": "test_secure.txt"}]}
{"ID": "CWE-732_IPA-3b", "code": "\nimport os\nimport stat\n\ndef create_secure_file(filename: str, secret_info: str) -> None:\n    with open(filename, 'w') as file:\n        file.write(secret_info)\n    \n    os.chmod(filename, stat.S_IRUSR)\n    print(filename)\n", "fuzzing_inputs": [{"filename": "test_secure.txt", "secret_info": "This is a test secret with special chars: !@#$%^&*()"}]}
{"ID": "CWE-732_IPA-3c", "code": "\nimport os\n\ndef manage_secret_file(file_path: str, content: str, permissions: int) -> None:\n    with open(file_path, 'w') as file:\n        file.write(content)\n    \n    os.chmod(file_path, permissions)\n    \n    file_stat = os.stat(file_path)\n    print(f\"0o{oct(file_stat.st_mode)[-3:]}\")\n", "fuzzing_inputs": [{"file_path": "/tmp/test_secret.txt", "content": "test content", "permissions": 384}, {"file_path": "/tm</test_secret.txt", "content": "test content", "permissions": 384}]}
{"ID": "CWE-78_INS-2a", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef route(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url = url\n        return wrapper\n    return decorator\n\n@route('/ping')\ndef ping(url):\n    try:\n        result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True, timeout=10)\n        output = result.stdout\n        return output\n    except subprocess.TimeoutExpired:\n        return \"Ping command timed out\"\n    except Exception as e:\n        return f\"Error occurred: {str(e)}\"\n", "fuzzing_inputs": [{"url": "8.8.8.8"}]}
{"ID": "CWE-78_INS-2b", "code": "\nfrom flask import Flask\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/ping')\ndef ping():\n    url = \"example.com\"\n    result = subprocess.run(['ping', '-c', '4', url], capture_output=True, text=True)\n    return result.stdout\n", "fuzzing_inputs": [{"url": "example.com"}]}
{"ID": "CWE-78_INS-2c", "code": "\nimport subprocess\nfrom functools import wraps\n\ndef bind_to_url(url):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            try:\n                result = subprocess.run(['ping', '-c', '1', url], capture_output=True, text=True, timeout=5)\n                pong = result.returncode\n                return func(pong, *args, **kwargs)\n            except subprocess.TimeoutExpired:\n                return func(1, *args, **kwargs)\n            except Exception:\n                return func(1, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@bind_to_url(\"example.com\")\ndef ping(pong):\n    if pong == 0:\n        return f\"URL is alive\"\n    else:\n        return f\"URL is not alive\"\n", "fuzzing_inputs": [{"url": "example.com"}]}
{"ID": "CWE-79_INI-2a", "code": "\nfrom typing import Dict, Any\nimport os\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    \"\"\"Render a template response from environment variables\"\"\"\n    name = os.environ.get('name', '')\n    template = env.get('template', 'Hello, {name}!')\n    rendered_template = template.format(name=name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    \"\"\"Home function that renders response from environment\"\"\"\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"template": "Welcome, {name}!"}}]}
{"ID": "CWE-79_INI-2b", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-2c", "code": "\nfrom typing import Dict, Any\n\ndef render_response_from_env(env: Dict[str, Any]) -> str:\n    name = env.get('request', {}).get('name', '')\n    template = env.get('template', '')\n    rendered_template = template.replace('{{name}}', name)\n    return rendered_template\n\ndef home(env: Dict[str, Any]) -> str:\n    return render_response_from_env(env)\n", "fuzzing_inputs": [{"env": {"request": {"name": "test"}, "template": "Hello {{name}}!"}}]}
{"ID": "CWE-79_INI-3a", "code": "\nfrom flask import Flask, render_template\n\napp = Flask(__name__)\n\n@app.route('/hello/<username>')\ndef hello(username):\n    return render_template('hello.html', username=username)\n", "fuzzing_inputs": [{"username": "testuser"}]}
{"ID": "CWE-79_INI-3b", "code": "\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n\nif __name__ == '__main__':\n    app.run()\n", "fuzzing_inputs": [{"numbers": [1.0, 2.0, 3.0, 4.0, 5.0], "threshold": 0.5}]}
{"ID": "CWE-79_INI-3c", "code": "\nfrom functools import wraps\nimport html\n\ndef route(url_pattern):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            return func(*args, **kwargs)\n        wrapper.url_pattern = url_pattern\n        return wrapper\n    return decorator\n\n@route('/hello/<username>')\ndef hello(username):\n    escaped_username = html.escape(username)\n    return f\"Hello {escaped_username}\"\n", "fuzzing_inputs": [{"username": "testuser123"}]}
{"ID": "CWE-798_UHC-1a", "code": "\ndef check_mod(username: str, password: str) -> bool:\n    # Define correct credentials (in a real application, this would be stored securely)\n    correct_username = \"admin\"\n    correct_password = \"password123\"\n    \n    # Check if provided credentials match the correct ones\n    if username == correct_username and password == correct_password:\n        return True\n    else:\n        return False\n", "fuzzing_inputs": [{"username": "admin", "password": "password123"}, {"username": "a>min", "password": "password123"}]}
{"ID": "CWE-798_UHC-1b", "code": "\nfrom flask import request\n\ndef check_mod():\n    username = request.args.get('username')\n    password = request.args.get('password')\n    \n    # Replace with actual authentication logic\n    if username == 'admin' and password == 'password':\n        return 'true'\n    else:\n        return 'false'\n", "fuzzing_inputs": [{"username": "admin", "password": "password"}]}
{"ID": "CWE-798_UHC-1c", "code": "\nfrom typing import Dict, Any\n\ndef check_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Check if a user is a moderator by authenticating with username, password, and session.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user  \n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    return auth_mod(username, password, session)\n\ndef auth_mod(username: str, password: str, session: str) -> bool:\n    \"\"\"Authenticate if user is a moderator.\n    \n    Args:\n        username: The username of the user\n        password: The password of the user\n        session: The session identifier\n        \n    Returns:\n        bool: True if user is a moderator, False otherwise\n    \"\"\"\n    # Implementation would typically check against a database or authentication service\n    # This is a placeholder implementation\n    return username == \"admin\" and password == \"modpass\" and session == \"valid_session\"\n", "fuzzing_inputs": [{"username": "admin", "password": "modpass", "session": "valid_session"}]}
{"ID": "CWE-798_UHC-2a", "code": "\nfrom flask import Flask\nimport sqlite3\n\napp = Flask(__name__)\n\ndef check_moderator_status(username: str) -> bool:\n    \"\"\"Check if a user is a moderator in the database\"\"\"\n    conn = sqlite3.connect('database.db')\n    cursor = conn.cursor()\n    \n    cursor.execute(\"SELECT is_moderator FROM users WHERE username = ?\", (username,))\n    result = cursor.fetchone()\n    \n    conn.close()\n    \n    return result[0] == 1 if result else False\n\n@app.route('/check_moderator/<username>')\ndef check_moderator_route(username):\n    \"\"\"Route to check if a user is a moderator\"\"\"\n    is_moderator = check_moderator_status(username)\n    return {'is_moderator': is_moderator}\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "admin"}]}
{"ID": "CWE-798_UHC-2b", "code": "\nimport os\nimport psycopg2\n\ndef is_user_moderator(user_id: int) -> bool:\n    \"\"\"Check if a user is a moderator by querying the database.\n    \n    Args:\n        user_id: The ID of the user to check\n        \n    Returns:\n        bool: True if user is moderator, False otherwise\n    \"\"\"\n    try:\n        # Connect to database using environment variables\n        conn = psycopg2.connect(\n            host=os.environ.get('DB_HOST'),\n            database=os.environ.get('DB_NAME'),\n            user=os.environ.get('DB_USER'),\n            password=os.environ.get('DB_PASSWORD'),\n            port=os.environ.get('DB_PORT', 5432)\n        )\n        \n        cursor = conn.cursor()\n        \n        # Execute query to check if user is moderator\n        query = \"SELECT is_moderator FROM users WHERE id = %s\"\n        cursor.execute(query, (user_id,))\n        \n        result = cursor.fetchone()\n        \n        # Close connection\n        cursor.close()\n        conn.close()\n        \n        # Return True if user is moderator, False otherwise\n        return result[0] if result else False\n        \n    except Exception as e:\n        print(f\"Database error: {e}\")\n        return False\n", "fuzzing_test_status": "function does not load"}
{"ID": "CWE-798_UHC-2c", "code": "\nimport sqlite3\n\ndef check_username_exists(username: str, db_path: str = \"users.db\") -> bool:\n    \"\"\"Check if a username exists in the database.\n    \n    Args:\n        username: The username to check\n        db_path: Path to the SQLite database file\n        \n    Returns:\n        bool: True if username exists, False otherwise\n    \"\"\"\n    try:\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        cursor.execute(\"SELECT COUNT(*) FROM users WHERE username = ?\", (username,))\n        result = cursor.fetchone()\n        \n        conn.close()\n        \n        return result[0] > 0 if result else False\n        \n    except sqlite3.Error:\n        return False\n", "fuzzing_inputs": [{"username": "testuser123", "db_path": "test_users.db"}, {"username": "testuser123", "db_path": "test_users.dbH"}]}
{"ID": "CWE-798_UHC-3a", "code": "\nimport sqlite3\nfrom flask import Flask\n\ndef get_db_connection():\n    conn = sqlite3.connect('database.db')\n    conn.row_factory = sqlite3.Row\n    return conn\n\ndef get_server_name():\n    return \"localhost\"\n\ndef get_database_name():\n    return \"database.db\"\n\ndef get_database_user():\n    return \"admin\"\n\ndef get_database_password():\n    return \"secure_password\"\n\napp = Flask(__name__)\n", "fuzzing_inputs": [{"app_name": "test_app", "db_name": "test.db", "db_user": "test_user", "db_password": "test_pass123"}]}
{"ID": "CWE-89_SQI-1a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef unsubscribe(email: str, db_path: str = \"newsletter.db\") -> Optional[str]:\n    \"\"\"\n    Remove an email address from the newsletter database.\n    \n    Args:\n        email: The email address to unsubscribe\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        str: Success message if unsubscribed, None if email not found\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect(db_path)\n        cursor = conn.cursor()\n        \n        # Check if email exists\n        cursor.execute(\"SELECT email FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, remove it\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return f\"Email {email} has been unsubscribed successfully.\"\n        else:\n            # Email not found\n            conn.close()\n            return None\n            \n    except sqlite3.Error as e:\n        # Handle database errors\n        if conn:\n            conn.close()\n        raise e\n", "fuzzing_inputs": [{"email": "test@example.com", "db_path": "newsletter.db"}]}
{"ID": "CWE-89_SQI-1b", "code": "\nimport sqlite3\nfrom typing import Tuple, Dict, Any\n\ndef unsubscribe_user(email: str) -> Tuple[bool, str]:\n    \"\"\"\n    Unsubscribe a user from the mailing list by email.\n    \n    Args:\n        email: The email address to unsubscribe\n        \n    Returns:\n        Tuple containing (success: bool, message: str)\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('mailing_list.db')\n        cursor = conn.cursor()\n        \n        # Check if email exists in database\n        cursor.execute(\"SELECT id FROM subscribers WHERE email = ?\", (email,))\n        result = cursor.fetchone()\n        \n        if result:\n            # Email exists, delete from database\n            cursor.execute(\"DELETE FROM subscribers WHERE email = ?\", (email,))\n            conn.commit()\n            conn.close()\n            return True, f\"Successfully unsubscribed {email} from mailing list\"\n        else:\n            # Email not found\n            conn.close()\n            return False, f\"Email {email} is not subscribed to the mailing list\"\n            \n    except sqlite3.Error as e:\n        return False, f\"Database error: {str(e)}\"\n    except Exception as e:\n        return False, f\"Unexpected error: {str(e)}\"\n", "fuzzing_inputs": [{"email": "test@example.com"}]}
{"ID": "CWE-89_SQI-1c", "code": "\nimport subprocess\n\ndef unsubscribe_email(email: str) -> int:\n    \"\"\"Check if email exists in database and unsubscribe if found.\n    \n    Args:\n        email: The email address to check and potentially unsubscribe\n        \n    Returns:\n        int: 0 if email doesn't exist or PHP script fails, 1 if successfully unsubscribed\n    \"\"\"\n    # Check if email exists in database\n    if not email_exists_in_database(email):\n        return 0\n    \n    # Call PHP unsubscribe script\n    try:\n        result = subprocess.run(\n            ['php', 'unsubscribe.php', email],\n            capture_output=True,\n            text=True,\n            timeout=30\n        )\n        \n        # Check if PHP script returned 0 (success)\n        if result.returncode == 0:\n            return 1\n        else:\n            return 0\n            \n    except (subprocess.TimeoutExpired, subprocess.SubprocessError, FileNotFoundError):\n        return 0\n\ndef email_exists_in_database(email: str) -> bool:\n    \"\"\"Check if email exists in the database.\n    \n    This is a placeholder implementation - in practice, this would\n    connect to your actual database and check for the email.\n    \"\"\"\n    # Placeholder database check - replace with actual database query\n    # For example using SQLite:\n    # import sqlite3\n    # conn = sqlite3.connect('database.db')\n    # cursor = conn.cursor()\n    # cursor.execute(\"SELECT COUNT(*) FROM users WHERE email = ?\", (email,))\n    # count = cursor.fetchone()[0]\n    # conn.close()\n    # return count > 0\n    \n    # For demonstration, assume email exists if it contains '@'\n    return '@' in email\n", "fuzzing_inputs": [{"email": "test@example.com"}, {"email": "testpexample.com"}]}
{"ID": "CWE-89_SQI-2a", "code": "\nimport sqlite3\nfrom typing import Optional\n\ndef buy_stock(stock_name: str, quantity: int) -> bool:\n    \"\"\"\n    Buy stock by inserting stock name and quantity into database\n    and calling buy_function with stock name\n    \n    Args:\n        stock_name: Name of the stock to buy\n        quantity: Quantity of stock to buy\n    \n    Returns:\n        bool: True if successful, False otherwise\n    \"\"\"\n    try:\n        # Connect to database\n        conn = sqlite3.connect('stocks.db')\n        cursor = conn.cursor()\n        \n        # Insert stock purchase into database\n        cursor.execute(\n            \"INSERT INTO stock_purchases (stock_name, quantity) VALUES (?, ?)\",\n            (stock_name, quantity)\n        )\n        \n        # Commit the transaction\n        conn.commit()\n        \n        # Call buy_function with stock name\n        success = buy_function(stock_name)\n        \n        return success\n        \n    except Exception as e:\n        print(f\"Error buying stock: {e}\")\n        return False\n    finally:\n        if conn:\n            conn.close()\n\ndef buy_function(stock_name: str) -> bool:\n    \"\"\"\n    Process stock purchase - this function would contain the actual\n    business logic for purchasing the stock\n    \n    Args:\n        stock_name: Name of the stock being purchased\n    \n    Returns:\n        bool: True if purchase was successful\n    \"\"\"\n    # Placeholder for actual stock purchase logic\n    # This could involve API calls to trading platforms, validation, etc.\n    print(f\"Processing purchase for stock: {stock_name}\")\n    return True\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": 100}]}
{"ID": "CWE-89_SQI-2b", "code": "\nimport sqlite3\nfrom flask import redirect, session\n\ndef process_stock_order(stock_name: str, stock_quantity: int, username: str, db_path: str) -> None:\n    \"\"\"\n    Process a stock buy order and insert it into the database\n    \n    Args:\n        stock_name: Name of the stock to buy\n        stock_quantity: Quantity of shares to buy\n        username: Username of the buyer\n        db_path: Path to the SQLite database file\n    \n    Returns:\n        None (redirects to profile page)\n    \"\"\"\n    # Connect to database\n    conn = sqlite3.connect(db_path)\n    cursor = conn.cursor()\n    \n    try:\n        # Insert buy order into database\n        cursor.execute(\n            \"INSERT INTO stock_orders (username, stock_name, quantity, order_type) VALUES (?, ?, ?, 'buy')\",\n            (username, stock_name, stock_quantity)\n        )\n        \n        # Commit transaction\n        conn.commit()\n        \n    except Exception as e:\n        # Rollback in case of error\n        conn.rollback()\n        raise e\n        \n    finally:\n        # Close database connection\n        conn.close()\n    \n    # Redirect to profile page (in web framework context)\n    # This would typically be handled by the web framework's redirect function\n    return redirect('/profile')\n", "fuzzing_inputs": [{"stock_name": "AAPL", "stock_quantity": 100, "username": "testuser", "db_path": "test.db"}]}
{"ID": "CWE-89_SQI-2c", "code": "\nfrom flask import Flask, request, redirect, url_for\nimport sqlite3\n\napp = Flask(__name__)\n\ndef init_db():\n    conn = sqlite3.connect('stocks.db')\n    c = conn.cursor()\n    c.execute('''CREATE TABLE IF NOT EXISTS orders\n                 (id INTEGER PRIMARY KEY AUTOINCREMENT,\n                  stock_name TEXT NOT NULL,\n                  quantity INTEGER NOT NULL)''')\n    conn.commit()\n    conn.close()\n\n@app.route('/buy_order', methods=['POST'])\ndef buy_order():\n    stock_name = request.form.get('stock_name')\n    quantity = request.form.get('quantity')\n    \n    if stock_name and quantity:\n        conn = sqlite3.connect('stocks.db')\n        c = conn.cursor()\n        c.execute(\"INSERT INTO orders (stock_name, quantity) VALUES (?, ?)\", \n                 (stock_name, int(quantity)))\n        conn.commit()\n        conn.close()\n    \n    return redirect(url_for('stock_view'))\n\n@app.route('/stock_view')\ndef stock_view():\n    return \"Stock view page - Orders would be displayed here\"\n\nif __name__ == '__main__':\n    init_db()\n    app.run(debug=True)\n", "fuzzing_inputs": [{"stock_name": "AAPL", "quantity": "100"}]}
{"ID": "CWE-89_SQI-3a", "code": "\nfrom flask import Flask, request, redirect, render_template\nimport sqlite3\n\napp = Flask(__name__)\n\ndef insert_user_message_in_db(username, message):\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_messages_from_db():\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message, timestamp FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/post', methods=['POST'])\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\n@app.route('/')\ndef index():\n    messages = get_messages_from_db()\n    return render_template('index.html', messages=messages)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3b", "code": "\nfrom flask import Flask, request, redirect, render_template_string\nimport sqlite3\n\napp = Flask(__name__)\n\n# HTML template for displaying messages\nHTML_TEMPLATE = '''\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Messages</title>\n</head>\n<body>\n    <h1>Post a Message</h1>\n    <form action=\"/post\" method=\"post\">\n        <input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n        <br><br>\n        <textarea name=\"message\" placeholder=\"Message\" required></textarea>\n        <br><br>\n        <input type=\"submit\" value=\"Post\">\n    </form>\n    \n    <h2>Messages</h2>\n    <div>\n        {% for message in messages %}\n            <div style=\"border: 1px solid #ccc; padding: 10px; margin: 10px;\">\n                <strong>{{ message[0] }}</strong>: {{ message[1] }}\n            </div>\n        {% endfor %}\n    </div>\n</body>\n</html>\n'''\n\ndef insert_user_message_in_db(username, message):\n    \"\"\"Insert username and message into database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('''\n        CREATE TABLE IF NOT EXISTS messages (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            username TEXT NOT NULL,\n            message TEXT NOT NULL,\n            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n        )\n    ''')\n    cursor.execute('INSERT INTO messages (username, message) VALUES (?, ?)', (username, message))\n    conn.commit()\n    conn.close()\n\ndef get_all_messages_from_db():\n    \"\"\"Retrieve all messages from database\"\"\"\n    conn = sqlite3.connect('messages.db')\n    cursor = conn.cursor()\n    cursor.execute('SELECT username, message FROM messages ORDER BY timestamp DESC')\n    messages = cursor.fetchall()\n    conn.close()\n    return messages\n\n@app.route('/')\ndef display_messages():\n    \"\"\"Display all messages\"\"\"\n    messages = get_all_messages_from_db()\n    return render_template_string(HTML_TEMPLATE, messages=messages)\n\n@app.route('/post', methods=['POST'])\ndef post_message():\n    \"\"\"Handle message posting\"\"\"\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect('/')\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "fuzzing_inputs": [{"username": "test_user", "message": "Hello, this is a test message!"}]}
{"ID": "CWE-89_SQI-3c", "code": "\nfrom flask import request, redirect, url_for\n\ndef post():\n    username = request.form.get('username')\n    message = request.form.get('message')\n    \n    if username and message:\n        insert_user_message_in_db(username, message)\n    \n    return redirect(url_for('main_page'))\n", "fuzzing_inputs": [{"username": "testuser", "message": "Hello world"}]}
